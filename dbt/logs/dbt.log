

============================== 12:23:30.578441 | d83c368d-2a84-493e-bad5-f185e2f52bcb ==============================
[0m12:23:30.578441 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:23:30.580856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'log_path': '/home/user/dwh/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m12:23:30.581051 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:23:30.582593 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtvault'
[0m12:23:30.583473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.036771055, "process_in_blocks": "42560", "process_kernel_time": 0.081831, "process_mem_max_rss": "87836", "process_out_blocks": "8", "process_user_time": 0.627377}
[0m12:23:30.583735 [debug] [MainThread]: Command `dbt run` failed at 12:23:30.583681 after 0.04 seconds
[0m12:23:30.583899 [debug] [MainThread]: Flushing usage events


============================== 12:24:28.449579 | 3475a361-39f7-4fbc-936c-26917130e1e9 ==============================
[0m12:24:28.449579 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:24:28.451570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/user/dwh/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:24:28.451755 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:24:28.617949 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:24:28.654389 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m12:24:28.655026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.23505929, "process_in_blocks": "12312", "process_kernel_time": 0.084872, "process_mem_max_rss": "96432", "process_out_blocks": "8", "process_user_time": 0.707269}
[0m12:24:28.655287 [debug] [MainThread]: Command `dbt run` failed at 12:24:28.655231 after 0.24 seconds
[0m12:24:28.655468 [debug] [MainThread]: Flushing usage events


============================== 12:24:41.186236 | b0b5eb7b-4414-4943-87b6-4b91b7c33241 ==============================
[0m12:24:41.186236 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:24:41.187756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/user/dwh/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m12:24:41.187944 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:24:41.265526 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xg6timsm'
[0m12:24:41.265938 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m12:24:42.163808 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:42.164295 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m12:24:42.164680 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m12:24:42.165004 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:42.167140 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:42.167439 [debug] [MainThread]: STDERR: "b''"
[0m12:24:42.167671 [debug] [MainThread]: Checking out revision master.
[0m12:24:42.167917 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m12:24:42.169852 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:42.170158 [debug] [MainThread]: STDERR: "b''"
[0m12:24:42.170396 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m12:24:43.273117 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:43.273427 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m12:24:43.273597 [debug] [MainThread]: Executing "git tag --list"
[0m12:24:43.274641 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m12:24:43.274866 [debug] [MainThread]: STDERR: "b''"
[0m12:24:43.275001 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m12:24:43.277738 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m12:24:43.277926 [debug] [MainThread]: STDERR: "b''"
[0m12:24:43.278058 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:43.278882 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:43.279111 [debug] [MainThread]: STDERR: "b''"
[0m12:24:43.279243 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m12:24:43.279377 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:43.280148 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:43.280317 [debug] [MainThread]: STDERR: "b''"
[0m12:24:43.283033 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:24:43.508183 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:24:43.509362 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:24:43.600081 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:24:43.614528 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m12:24:43.616328 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:43.616745 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m12:24:43.617004 [debug] [MainThread]: command return code=128
[0m12:24:43.617652 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m12:24:43.617895 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:43.619257 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:43.619557 [debug] [MainThread]: STDERR: "b''"
[0m12:24:43.619784 [debug] [MainThread]: Checking out revision master.
[0m12:24:43.620015 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m12:24:43.621848 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:43.622079 [debug] [MainThread]: STDERR: "b''"
[0m12:24:43.622335 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m12:24:44.234765 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:44.235578 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m12:24:44.236094 [debug] [MainThread]: Executing "git tag --list"
[0m12:24:44.239618 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m12:24:44.240246 [debug] [MainThread]: STDERR: "b''"
[0m12:24:44.240924 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m12:24:44.245354 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m12:24:44.245896 [debug] [MainThread]: STDERR: "b''"
[0m12:24:44.246349 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:44.248596 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:44.249011 [debug] [MainThread]: STDERR: "b''"
[0m12:24:44.249361 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m12:24:44.249695 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:44.251540 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:44.251847 [debug] [MainThread]: STDERR: "b''"
[0m12:24:44.258673 [info ] [MainThread]: Updating lock file in file path: /home/user/dwh/dbt/package-lock.yml
[0m12:24:44.261392 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d66x939e'
[0m12:24:44.265174 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m12:24:44.265562 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m12:24:44.994372 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:44.994849 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m12:24:44.995136 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m12:24:44.995403 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:44.996960 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:44.997323 [debug] [MainThread]: STDERR: "b''"
[0m12:24:44.997572 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m12:24:44.997935 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:24:45.758413 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:45.759636 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m12:24:45.760436 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:24:45.769961 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m12:24:45.770380 [debug] [MainThread]: STDERR: "b''"
[0m12:24:45.770646 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:45.772114 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:45.772529 [debug] [MainThread]: STDERR: "b''"
[0m12:24:45.772784 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m12:24:45.773035 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:45.774541 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:45.774856 [debug] [MainThread]: STDERR: "b''"
[0m12:24:45.776111 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m12:24:45.777471 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:45.777749 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m12:24:45.777976 [debug] [MainThread]: command return code=128
[0m12:24:45.778456 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m12:24:45.778779 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:45.780128 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:45.780385 [debug] [MainThread]: STDERR: "b''"
[0m12:24:45.780730 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m12:24:45.781006 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:24:46.425285 [debug] [MainThread]: STDOUT: "b''"
[0m12:24:46.425611 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m12:24:46.425796 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:24:46.427370 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m12:24:46.427593 [debug] [MainThread]: STDERR: "b''"
[0m12:24:46.427726 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:24:46.428537 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:24:46.428704 [debug] [MainThread]: STDERR: "b''"
[0m12:24:46.428832 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m12:24:46.429007 [info ] [MainThread]: Installed from revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06
[0m12:24:46.429239 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:24:46.839651 [info ] [MainThread]: Installed from version 1.3.0
[0m12:24:46.840151 [info ] [MainThread]: Up to date!
[0m12:24:46.841324 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.6852264, "process_in_blocks": "920", "process_kernel_time": 0.058503, "process_mem_max_rss": "91832", "process_out_blocks": "2328", "process_user_time": 0.799547}
[0m12:24:46.841610 [debug] [MainThread]: Command `dbt deps` succeeded at 12:24:46.841543 after 5.69 seconds
[0m12:24:46.841781 [debug] [MainThread]: Flushing usage events


============================== 12:24:49.736779 | d9819e69-061c-44a1-8ea7-f05bed1b67fd ==============================
[0m12:24:49.736779 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:24:49.738290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/user/dwh/dbt/logs', 'profiles_dir': '/home/user/dwh/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m12:24:49.738492 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:24:49.861906 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:24:49.901285 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:24:49.901684 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:24:51.323389 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtvault.seats' (models/raw_stage/seats.sql) depends on a source named 'postgres_master_data.seats' which was not found
[0m12:24:51.324099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.617413, "process_in_blocks": "2136", "process_kernel_time": 0.038053, "process_mem_max_rss": "112156", "process_out_blocks": "8", "process_user_time": 2.083412}
[0m12:24:51.324492 [debug] [MainThread]: Command `dbt run` failed at 12:24:51.324431 after 1.62 seconds
[0m12:24:51.324681 [debug] [MainThread]: Flushing usage events


============================== 12:25:31.730447 | dbdb04ca-c4e5-46b7-a692-e3518364885f ==============================
[0m12:25:31.730447 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:25:31.732010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/user/dwh/dbt', 'log_path': '/home/user/dwh/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:25:31.732194 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:25:31.854516 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:31.899121 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:25:31.899489 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:25:33.255873 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtvault.seats' (models/raw_stage/seats.sql) depends on a source named 'postgres_master_data.seats' which was not found
[0m12:25:33.256570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5562658, "process_in_blocks": "0", "process_kernel_time": 0.047697, "process_mem_max_rss": "110148", "process_out_blocks": "8", "process_user_time": 2.041445}
[0m12:25:33.256947 [debug] [MainThread]: Command `dbt run` failed at 12:25:33.256881 after 1.56 seconds
[0m12:25:33.257151 [debug] [MainThread]: Flushing usage events


============================== 12:28:40.870343 | 69603686-1911-4d23-a376-3365130aa454 ==============================
[0m12:28:40.870343 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:28:40.871839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/user/dwh/dbt', 'log_path': '/home/user/dwh/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m12:28:40.872043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:28:40.995650 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:28:41.032958 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:28:41.033330 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:28:42.455935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m12:28:42.560749 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:28:42.562399 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:28:42.572288 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m12:28:42.573969 [info ] [MainThread]: 
[0m12:28:42.574209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:42.574370 [info ] [MainThread]: 
[0m12:28:42.574644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:42.578017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:28:42.593292 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:28:42.593568 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:28:42.593726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:42.600878 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m12:28:42.601705 [debug] [ThreadPool]: On list_postgres: Close
[0m12:28:42.602337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_dwh_detailed)
[0m12:28:42.602614 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "dwh_detailed"
"
[0m12:28:42.606032 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m12:28:42.606231 [debug] [ThreadPool]: On create_postgres_dwh_detailed: BEGIN
[0m12:28:42.606384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:42.609708 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m12:28:42.609932 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m12:28:42.610073 [debug] [ThreadPool]: On create_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "create_postgres_dwh_detailed"} */
create schema if not exists "dwh_detailed"
[0m12:28:42.620348 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.010 seconds
[0m12:28:42.621009 [debug] [ThreadPool]: On create_postgres_dwh_detailed: COMMIT
[0m12:28:42.621218 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m12:28:42.621355 [debug] [ThreadPool]: On create_postgres_dwh_detailed: COMMIT
[0m12:28:42.623816 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m12:28:42.624050 [debug] [ThreadPool]: On create_postgres_dwh_detailed: Close
[0m12:28:42.626063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_dwh_detailed, now list_postgres_dwh_detailed)
[0m12:28:42.629742 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:28:42.629942 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m12:28:42.630098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:42.633892 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.634114 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:28:42.634272 [debug] [ThreadPool]: On list_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed'
  
[0m12:28:42.645998 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m12:28:42.646777 [debug] [ThreadPool]: On list_postgres_dwh_detailed: ROLLBACK
[0m12:28:42.647292 [debug] [ThreadPool]: On list_postgres_dwh_detailed: Close
[0m12:28:42.651300 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:42.651493 [debug] [MainThread]: On master: BEGIN
[0m12:28:42.651632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:42.655091 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:28:42.655296 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:42.655478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:42.665544 [debug] [MainThread]: SQL status: SELECT 53 in 0.010 seconds
[0m12:28:42.667026 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:42.667646 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:42.667876 [debug] [MainThread]: On master: BEGIN
[0m12:28:42.668542 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:42.668722 [debug] [MainThread]: On master: COMMIT
[0m12:28:42.668867 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:42.668994 [debug] [MainThread]: On master: COMMIT
[0m12:28:42.669377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:42.669550 [debug] [MainThread]: On master: Close
[0m12:28:42.670722 [debug] [Thread-1 (]: Began running node model.dbtvault.aircrafts
[0m12:28:42.671048 [info ] [Thread-1 (]: 1 of 36 START sql table model dwh_detailed.aircrafts ........................... [RUN]
[0m12:28:42.671323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed, now model.dbtvault.aircrafts)
[0m12:28:42.671531 [debug] [Thread-1 (]: Began compiling node model.dbtvault.aircrafts
[0m12:28:42.676710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.aircrafts"
[0m12:28:42.677216 [debug] [Thread-1 (]: Began executing node model.dbtvault.aircrafts
[0m12:28:42.697170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.aircrafts"
[0m12:28:42.697741 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:28:42.697928 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: BEGIN
[0m12:28:42.698098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:42.701975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.702199 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:28:42.702387 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */

  
    

  create  table "postgres"."dwh_detailed"."aircrafts__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_aircrafts"
  );
  
[0m12:28:42.721275 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m12:28:42.725677 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:28:42.725923 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts__dbt_tmp" rename to "aircrafts"
[0m12:28:42.727311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:42.737062 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:28:42.737310 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:28:42.737474 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:28:42.740230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:42.744555 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."aircrafts__dbt_backup"
[0m12:28:42.746872 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:28:42.747079 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
drop table if exists "postgres"."dwh_detailed"."aircrafts__dbt_backup" cascade
[0m12:28:42.748383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:42.749895 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: Close
[0m12:28:42.752287 [info ] [Thread-1 (]: 1 of 36 OK created sql table model dwh_detailed.aircrafts ...................... [[32mSELECT 1[0m in 0.08s]
[0m12:28:42.752659 [debug] [Thread-1 (]: Finished running node model.dbtvault.aircrafts
[0m12:28:42.752889 [debug] [Thread-1 (]: Began running node model.dbtvault.airports
[0m12:28:42.753369 [info ] [Thread-1 (]: 2 of 36 START sql table model dwh_detailed.airports ............................ [RUN]
[0m12:28:42.753718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.aircrafts, now model.dbtvault.airports)
[0m12:28:42.753962 [debug] [Thread-1 (]: Began compiling node model.dbtvault.airports
[0m12:28:42.755926 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.airports"
[0m12:28:42.756217 [debug] [Thread-1 (]: Began executing node model.dbtvault.airports
[0m12:28:42.758401 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.airports"
[0m12:28:42.758709 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:28:42.758881 [debug] [Thread-1 (]: On model.dbtvault.airports: BEGIN
[0m12:28:42.759026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:42.762768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.763069 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:28:42.763258 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */

  
    

  create  table "postgres"."dwh_detailed"."airports__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_airports"
  );
  
[0m12:28:42.779815 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.016 seconds
[0m12:28:42.782374 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:28:42.782631 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports__dbt_tmp" rename to "airports"
[0m12:28:42.783858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:42.785186 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:28:42.785434 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:28:42.785607 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:28:42.788563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:42.790829 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."airports__dbt_backup"
[0m12:28:42.791274 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:28:42.791459 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
drop table if exists "postgres"."dwh_detailed"."airports__dbt_backup" cascade
[0m12:28:42.792663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:42.793408 [debug] [Thread-1 (]: On model.dbtvault.airports: Close
[0m12:28:42.793939 [info ] [Thread-1 (]: 2 of 36 OK created sql table model dwh_detailed.airports ....................... [[32mSELECT 2[0m in 0.04s]
[0m12:28:42.794274 [debug] [Thread-1 (]: Finished running node model.dbtvault.airports
[0m12:28:42.794485 [debug] [Thread-1 (]: Began running node model.dbtvault.boarding_passes
[0m12:28:42.795053 [info ] [Thread-1 (]: 3 of 36 START sql table model dwh_detailed.boarding_passes ..................... [RUN]
[0m12:28:42.795726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.airports, now model.dbtvault.boarding_passes)
[0m12:28:42.795962 [debug] [Thread-1 (]: Began compiling node model.dbtvault.boarding_passes
[0m12:28:42.797893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.boarding_passes"
[0m12:28:42.798194 [debug] [Thread-1 (]: Began executing node model.dbtvault.boarding_passes
[0m12:28:42.800393 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.boarding_passes"
[0m12:28:42.800683 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:28:42.800852 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: BEGIN
[0m12:28:42.800998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:42.804651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.804881 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:28:42.805049 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */

  
    

  create  table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_boarding_passes"
  );
  
[0m12:28:42.822060 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:28:42.824672 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:28:42.824910 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp" rename to "boarding_passes"
[0m12:28:42.825951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:42.826939 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:28:42.827160 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:28:42.827323 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:28:42.829823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:42.832099 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."boarding_passes__dbt_backup"
[0m12:28:42.832505 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:28:42.832688 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
drop table if exists "postgres"."dwh_detailed"."boarding_passes__dbt_backup" cascade
[0m12:28:42.833895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:42.834740 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: Close
[0m12:28:42.835244 [info ] [Thread-1 (]: 3 of 36 OK created sql table model dwh_detailed.boarding_passes ................ [[32mSELECT 1[0m in 0.04s]
[0m12:28:42.835578 [debug] [Thread-1 (]: Finished running node model.dbtvault.boarding_passes
[0m12:28:42.835788 [debug] [Thread-1 (]: Began running node model.dbtvault.bookings
[0m12:28:42.836359 [info ] [Thread-1 (]: 4 of 36 START sql table model dwh_detailed.bookings ............................ [RUN]
[0m12:28:42.836942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.boarding_passes, now model.dbtvault.bookings)
[0m12:28:42.837160 [debug] [Thread-1 (]: Began compiling node model.dbtvault.bookings
[0m12:28:42.839055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.bookings"
[0m12:28:42.839368 [debug] [Thread-1 (]: Began executing node model.dbtvault.bookings
[0m12:28:42.841517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.bookings"
[0m12:28:42.841794 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:28:42.841985 [debug] [Thread-1 (]: On model.dbtvault.bookings: BEGIN
[0m12:28:42.842136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:42.846527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.846965 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:28:42.847170 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */

  
    

  create  table "postgres"."dwh_detailed"."bookings__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_bookings"
  );
  
[0m12:28:42.864022 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:28:42.866446 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:28:42.866692 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings__dbt_tmp" rename to "bookings"
[0m12:28:42.867804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:42.868750 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:28:42.868958 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:28:42.869115 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:28:42.871713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:42.873484 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."bookings__dbt_backup"
[0m12:28:42.873920 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:28:42.874106 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
drop table if exists "postgres"."dwh_detailed"."bookings__dbt_backup" cascade
[0m12:28:42.875295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:42.876028 [debug] [Thread-1 (]: On model.dbtvault.bookings: Close
[0m12:28:42.876561 [info ] [Thread-1 (]: 4 of 36 OK created sql table model dwh_detailed.bookings ....................... [[32mSELECT 1[0m in 0.04s]
[0m12:28:42.876913 [debug] [Thread-1 (]: Finished running node model.dbtvault.bookings
[0m12:28:42.877126 [debug] [Thread-1 (]: Began running node model.dbtvault.flights
[0m12:28:42.877679 [info ] [Thread-1 (]: 5 of 36 START sql table model dwh_detailed.flights ............................. [RUN]
[0m12:28:42.878290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.bookings, now model.dbtvault.flights)
[0m12:28:42.878515 [debug] [Thread-1 (]: Began compiling node model.dbtvault.flights
[0m12:28:42.880983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.flights"
[0m12:28:42.881268 [debug] [Thread-1 (]: Began executing node model.dbtvault.flights
[0m12:28:42.883395 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.flights"
[0m12:28:42.883726 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:28:42.883940 [debug] [Thread-1 (]: On model.dbtvault.flights: BEGIN
[0m12:28:42.884091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:42.887766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.888002 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:28:42.888182 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */

  
    

  create  table "postgres"."dwh_detailed"."flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_flights"
  );
  
[0m12:28:42.905622 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:28:42.908053 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:28:42.908279 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights__dbt_tmp" rename to "flights"
[0m12:28:42.909459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:42.910725 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:28:42.910946 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:28:42.911106 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:28:42.913662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:42.915339 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."flights__dbt_backup"
[0m12:28:42.915700 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:28:42.915884 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
drop table if exists "postgres"."dwh_detailed"."flights__dbt_backup" cascade
[0m12:28:42.917052 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:42.917768 [debug] [Thread-1 (]: On model.dbtvault.flights: Close
[0m12:28:42.918316 [info ] [Thread-1 (]: 5 of 36 OK created sql table model dwh_detailed.flights ........................ [[32mSELECT 1[0m in 0.04s]
[0m12:28:42.918662 [debug] [Thread-1 (]: Finished running node model.dbtvault.flights
[0m12:28:42.918877 [debug] [Thread-1 (]: Began running node model.dbtvault.seats
[0m12:28:42.919147 [info ] [Thread-1 (]: 6 of 36 START sql table model dwh_detailed.seats ............................... [RUN]
[0m12:28:42.919484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.flights, now model.dbtvault.seats)
[0m12:28:42.919906 [debug] [Thread-1 (]: Began compiling node model.dbtvault.seats
[0m12:28:42.922404 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.seats"
[0m12:28:42.922905 [debug] [Thread-1 (]: Began executing node model.dbtvault.seats
[0m12:28:42.925162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.seats"
[0m12:28:42.925466 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:28:42.925642 [debug] [Thread-1 (]: On model.dbtvault.seats: BEGIN
[0m12:28:42.925793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:42.929595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.929847 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:28:42.930012 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */

  
    

  create  table "postgres"."dwh_detailed"."seats__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_seats"
  );
  
[0m12:28:42.946702 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m12:28:42.949075 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:28:42.949297 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats__dbt_tmp" rename to "seats"
[0m12:28:42.950312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:42.951302 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:28:42.951498 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:28:42.951655 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:28:42.954339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:42.956024 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."seats__dbt_backup"
[0m12:28:42.956412 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:28:42.956594 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
drop table if exists "postgres"."dwh_detailed"."seats__dbt_backup" cascade
[0m12:28:42.957839 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:42.958586 [debug] [Thread-1 (]: On model.dbtvault.seats: Close
[0m12:28:42.959083 [info ] [Thread-1 (]: 6 of 36 OK created sql table model dwh_detailed.seats .......................... [[32mSELECT 1[0m in 0.04s]
[0m12:28:42.959417 [debug] [Thread-1 (]: Finished running node model.dbtvault.seats
[0m12:28:42.959634 [debug] [Thread-1 (]: Began running node model.dbtvault.ticket_flights
[0m12:28:42.960042 [info ] [Thread-1 (]: 7 of 36 START sql table model dwh_detailed.ticket_flights ...................... [RUN]
[0m12:28:42.960586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.seats, now model.dbtvault.ticket_flights)
[0m12:28:42.960947 [debug] [Thread-1 (]: Began compiling node model.dbtvault.ticket_flights
[0m12:28:42.962927 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.ticket_flights"
[0m12:28:42.963219 [debug] [Thread-1 (]: Began executing node model.dbtvault.ticket_flights
[0m12:28:42.966167 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.ticket_flights"
[0m12:28:42.966451 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:28:42.966626 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: BEGIN
[0m12:28:42.966776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:42.970796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.971015 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:28:42.971199 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */

  
    

  create  table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_ticket_flights"
  );
  
[0m12:28:42.988103 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:28:42.990528 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:28:42.990759 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp" rename to "ticket_flights"
[0m12:28:42.991914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:42.993213 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:28:42.993448 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:28:42.993622 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:28:42.996422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:42.998226 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."ticket_flights__dbt_backup"
[0m12:28:42.998626 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:28:42.998810 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
drop table if exists "postgres"."dwh_detailed"."ticket_flights__dbt_backup" cascade
[0m12:28:43.000004 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:43.000779 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: Close
[0m12:28:43.001303 [info ] [Thread-1 (]: 7 of 36 OK created sql table model dwh_detailed.ticket_flights ................. [[32mSELECT 1[0m in 0.04s]
[0m12:28:43.001631 [debug] [Thread-1 (]: Finished running node model.dbtvault.ticket_flights
[0m12:28:43.001864 [debug] [Thread-1 (]: Began running node model.dbtvault.tickets
[0m12:28:43.002386 [info ] [Thread-1 (]: 8 of 36 START sql table model dwh_detailed.tickets ............................. [RUN]
[0m12:28:43.003026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.ticket_flights, now model.dbtvault.tickets)
[0m12:28:43.003236 [debug] [Thread-1 (]: Began compiling node model.dbtvault.tickets
[0m12:28:43.005150 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.tickets"
[0m12:28:43.005431 [debug] [Thread-1 (]: Began executing node model.dbtvault.tickets
[0m12:28:43.008420 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.tickets"
[0m12:28:43.008705 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:28:43.008876 [debug] [Thread-1 (]: On model.dbtvault.tickets: BEGIN
[0m12:28:43.009076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.013072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.013365 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:28:43.013558 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */

  
    

  create  table "postgres"."dwh_detailed"."tickets__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_tickets"
  );
  
[0m12:28:43.030424 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:28:43.032848 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:28:43.033074 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets__dbt_tmp" rename to "tickets"
[0m12:28:43.034379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.035584 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:28:43.035804 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:28:43.035966 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:28:43.038500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:43.040220 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."tickets__dbt_backup"
[0m12:28:43.040592 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:28:43.040783 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
drop table if exists "postgres"."dwh_detailed"."tickets__dbt_backup" cascade
[0m12:28:43.041923 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:43.042636 [debug] [Thread-1 (]: On model.dbtvault.tickets: Close
[0m12:28:43.043142 [info ] [Thread-1 (]: 8 of 36 OK created sql table model dwh_detailed.tickets ........................ [[32mSELECT 1[0m in 0.04s]
[0m12:28:43.043503 [debug] [Thread-1 (]: Finished running node model.dbtvault.tickets
[0m12:28:43.043737 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_aircrafts
[0m12:28:43.044032 [info ] [Thread-1 (]: 9 of 36 START sql view model dwh_detailed.stg_aircrafts ........................ [RUN]
[0m12:28:43.044689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.tickets, now model.dbtvault.stg_aircrafts)
[0m12:28:43.044945 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_aircrafts
[0m12:28:43.056042 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:28:43.056361 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: BEGIN
[0m12:28:43.056561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.060410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.060640 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:28:43.060823 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.079814 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.019 seconds
[0m12:28:43.116233 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:28:43.116536 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.123731 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m12:28:43.126747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_aircrafts"
[0m12:28:43.127151 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_aircrafts
[0m12:28:43.137234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_aircrafts"
[0m12:28:43.137661 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:28:43.137871 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

  create view "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed"."aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS AIRCRAFT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRCRAFT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    AIRCRAFT_PK,
    AIRCRAFT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.154359 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m12:28:43.156719 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:28:43.156946 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
alter table "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m12:28:43.158117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.158962 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:28:43.159159 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:28:43.159330 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:28:43.161813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:43.164007 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup"
[0m12:28:43.165532 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:28:43.165780 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m12:28:43.167160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.167988 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: Close
[0m12:28:43.168509 [info ] [Thread-1 (]: 9 of 36 OK created sql view model dwh_detailed.stg_aircrafts ................... [[32mCREATE VIEW[0m in 0.12s]
[0m12:28:43.168865 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_aircrafts
[0m12:28:43.169082 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_airports
[0m12:28:43.169664 [info ] [Thread-1 (]: 10 of 36 START sql view model dwh_detailed.stg_airports ........................ [RUN]
[0m12:28:43.170540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_aircrafts, now model.dbtvault.stg_airports)
[0m12:28:43.170884 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_airports
[0m12:28:43.175517 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:28:43.175826 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: BEGIN
[0m12:28:43.176034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.179611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.179839 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:28:43.180012 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.191005 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.011 seconds
[0m12:28:43.194550 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:28:43.194789 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.201224 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:28:43.206082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_airports"
[0m12:28:43.206421 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_airports
[0m12:28:43.208818 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_airports"
[0m12:28:43.209100 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:28:43.209310 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

  create view "postgres"."dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed"."airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    AIRPORT_PK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.216742 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:28:43.219146 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:28:43.219382 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
alter table "postgres"."dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m12:28:43.220539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.221367 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:28:43.221642 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:28:43.221805 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:28:43.224614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.226177 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_airports__dbt_backup"
[0m12:28:43.226538 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:28:43.226731 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
drop view if exists "postgres"."dwh_detailed"."stg_airports__dbt_backup" cascade
[0m12:28:43.228041 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.228832 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: Close
[0m12:28:43.229338 [info ] [Thread-1 (]: 10 of 36 OK created sql view model dwh_detailed.stg_airports ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:28:43.229685 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_airports
[0m12:28:43.229914 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_boarding_passes
[0m12:28:43.230626 [info ] [Thread-1 (]: 11 of 36 START sql view model dwh_detailed.stg_boarding_passes ................. [RUN]
[0m12:28:43.231303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_airports, now model.dbtvault.stg_boarding_passes)
[0m12:28:43.231582 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_boarding_passes
[0m12:28:43.236764 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:28:43.236977 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: BEGIN
[0m12:28:43.237138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.240658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m12:28:43.240871 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:28:43.241053 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.252094 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:28:43.255446 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:28:43.255681 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.261806 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:28:43.265567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_boarding_passes"
[0m12:28:43.265869 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_boarding_passes
[0m12:28:43.268622 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_boarding_passes"
[0m12:28:43.268903 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:28:43.269099 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed"."boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS TICKET_FLIGHTS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOARDING_PASSES_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    TICKET_FLIGHTS_PK,
    BOARDING_PASSES_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.276413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:28:43.278735 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:28:43.278987 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m12:28:43.280143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.281049 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:28:43.281260 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:28:43.281426 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:28:43.284046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:43.285727 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m12:28:43.286104 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:28:43.286283 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m12:28:43.287491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.288255 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: Close
[0m12:28:43.288780 [info ] [Thread-1 (]: 11 of 36 OK created sql view model dwh_detailed.stg_boarding_passes ............ [[32mCREATE VIEW[0m in 0.06s]
[0m12:28:43.289112 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_boarding_passes
[0m12:28:43.289326 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_booking
[0m12:28:43.289855 [info ] [Thread-1 (]: 12 of 36 START sql incremental model dwh_detailed.hub_booking .................. [RUN]
[0m12:28:43.290557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_boarding_passes, now model.dbtvault.hub_booking)
[0m12:28:43.290831 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_booking
[0m12:28:43.297573 [info ] [Thread-1 (]: 12:28:43 + Loading postgres.dwh_detailed.hub_booking from 1 source(s)
[0m12:28:43.299140 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_booking"
[0m12:28:43.299583 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_booking
[0m12:28:43.315579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_booking"
[0m12:28:43.316060 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:28:43.316252 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: BEGIN
[0m12:28:43.316425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.320551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.320814 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:28:43.320995 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_booking"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."bookings" AS rr
    WHERE rr.BOOK_PK IS NOT NULL
    ORDER BY rr.BOOK_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.BOOK_PK, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.322103 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.book_pk does not exist
LINE 18:     SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref,...
                                             ^
HINT:  Perhaps you meant to reference the column "rr.book_ref".

[0m12:28:43.322336 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: ROLLBACK
[0m12:28:43.322794 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: Close
[0m12:28:43.326655 [debug] [Thread-1 (]: Database Error in model hub_booking (models/raw_vault/hubs/hub_booking.sql)
  column rr.book_pk does not exist
  LINE 18:     SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref,...
                                               ^
  HINT:  Perhaps you meant to reference the column "rr.book_ref".
  compiled code at target/run/dbtvault/models/raw_vault/hubs/hub_booking.sql
[0m12:28:43.327141 [error] [Thread-1 (]: 12 of 36 ERROR creating sql incremental model dwh_detailed.hub_booking ......... [[31mERROR[0m in 0.04s]
[0m12:28:43.327479 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_booking
[0m12:28:43.327690 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_bookings
[0m12:28:43.328271 [debug] [Thread-4 (]: Marking all children of 'model.dbtvault.hub_booking' to be skipped because of status 'error'.  Reason: Database Error in model hub_booking (models/raw_vault/hubs/hub_booking.sql)
  column rr.book_pk does not exist
  LINE 18:     SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref,...
                                               ^
  HINT:  Perhaps you meant to reference the column "rr.book_ref".
  compiled code at target/run/dbtvault/models/raw_vault/hubs/hub_booking.sql.
[0m12:28:43.327993 [info ] [Thread-1 (]: 13 of 36 START sql view model dwh_detailed.stg_bookings ........................ [RUN]
[0m12:28:43.329024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_booking, now model.dbtvault.stg_bookings)
[0m12:28:43.329229 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_bookings
[0m12:28:43.333668 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:28:43.333914 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: BEGIN
[0m12:28:43.334080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.337854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.338079 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:28:43.338259 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.349304 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:28:43.353085 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:28:43.353305 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.359361 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:28:43.362524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_bookings"
[0m12:28:43.362843 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_bookings
[0m12:28:43.365249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_bookings"
[0m12:28:43.365554 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:28:43.365765 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

  create view "postgres"."dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed"."bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS BOOK_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOOK_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    BOOK_PK,
    BOOK_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.372422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:28:43.374913 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:28:43.375133 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
alter table "postgres"."dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m12:28:43.376279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.377136 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:28:43.377335 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:28:43.377492 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:28:43.380216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.381895 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_bookings__dbt_backup"
[0m12:28:43.382307 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:28:43.382487 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m12:28:43.383644 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.384414 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: Close
[0m12:28:43.384923 [info ] [Thread-1 (]: 13 of 36 OK created sql view model dwh_detailed.stg_bookings ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:28:43.385612 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_bookings
[0m12:28:43.386041 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_flights
[0m12:28:43.386754 [info ] [Thread-1 (]: 14 of 36 START sql view model dwh_detailed.stg_flights ......................... [RUN]
[0m12:28:43.387315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_bookings, now model.dbtvault.stg_flights)
[0m12:28:43.387518 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_flights
[0m12:28:43.392679 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:28:43.392881 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: BEGIN
[0m12:28:43.393033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.397379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.397643 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:28:43.397837 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.408967 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m12:28:43.412525 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:28:43.412741 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.418756 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:28:43.426536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_flights"
[0m12:28:43.426843 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_flights
[0m12:28:43.429085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_flights"
[0m12:28:43.429368 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:28:43.429599 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

  create view "postgres"."dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed"."flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS FLIGHT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS FLIGHT_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_AIRCRAFT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_ARRIVAL_AIRPORT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    FLIGHT_PK,
    FLIGHT_HASHDIFF,
    LINK_FLIGHT_AIRCRAFT_PK,
    LINK_FLIGHT_ARRIVAL_AIRPORT_PK,
    LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.449178 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m12:28:43.451661 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:28:43.451897 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
alter table "postgres"."dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m12:28:43.453313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.454207 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:28:43.454467 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:28:43.454647 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:28:43.457407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.459136 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_flights__dbt_backup"
[0m12:28:43.459521 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:28:43.459693 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_flights__dbt_backup" cascade
[0m12:28:43.460943 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.461698 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: Close
[0m12:28:43.462215 [info ] [Thread-1 (]: 14 of 36 OK created sql view model dwh_detailed.stg_flights .................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:28:43.462550 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_flights
[0m12:28:43.462762 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_seats
[0m12:28:43.463029 [info ] [Thread-1 (]: 15 of 36 START sql view model dwh_detailed.stg_seats ........................... [RUN]
[0m12:28:43.463320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_flights, now model.dbtvault.stg_seats)
[0m12:28:43.463847 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_seats
[0m12:28:43.469139 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:28:43.469384 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: BEGIN
[0m12:28:43.469553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.473193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.473454 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:28:43.473640 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.484852 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:28:43.488097 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:28:43.488331 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.494357 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:28:43.498621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_seats"
[0m12:28:43.498953 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_seats
[0m12:28:43.501292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_seats"
[0m12:28:43.501576 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:28:43.501874 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

  create view "postgres"."dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed"."seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS SEAT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_SEAT_AIRCRAFT_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')), 'hex') AS SEAT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    SEAT_PK,
    LINK_SEAT_AIRCRAFT_PK,
    SEAT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.508977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:28:43.511684 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:28:43.511913 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
alter table "postgres"."dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m12:28:43.513150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.514012 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:28:43.514227 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:28:43.514393 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:28:43.517117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.518836 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_seats__dbt_backup"
[0m12:28:43.519203 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:28:43.519416 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
drop view if exists "postgres"."dwh_detailed"."stg_seats__dbt_backup" cascade
[0m12:28:43.520619 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.521388 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: Close
[0m12:28:43.521906 [info ] [Thread-1 (]: 15 of 36 OK created sql view model dwh_detailed.stg_seats ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:28:43.522236 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_seats
[0m12:28:43.522447 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_ticket_flights
[0m12:28:43.522727 [info ] [Thread-1 (]: 16 of 36 START sql view model dwh_detailed.stg_ticket_flights .................. [RUN]
[0m12:28:43.523119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_seats, now model.dbtvault.stg_ticket_flights)
[0m12:28:43.523846 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_ticket_flights
[0m12:28:43.528312 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:28:43.528528 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: BEGIN
[0m12:28:43.528685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.532123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m12:28:43.532338 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:28:43.532508 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.543464 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:28:43.547211 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:28:43.547446 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.553421 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:28:43.557058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_ticket_flights"
[0m12:28:43.557356 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_ticket_flights
[0m12:28:43.559600 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_ticket_flights"
[0m12:28:43.559922 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:28:43.560142 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed"."ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKET_FLIGHTS_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    TICKET_FLIGHTS_HASHDIFF,
    LINK_TICKET_FLIGHTS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.567072 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:28:43.569361 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:28:43.569596 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m12:28:43.570699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.571519 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:28:43.571752 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:28:43.571911 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:28:43.574434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:43.576406 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m12:28:43.576771 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:28:43.576975 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m12:28:43.578250 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.579102 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: Close
[0m12:28:43.579605 [info ] [Thread-1 (]: 16 of 36 OK created sql view model dwh_detailed.stg_ticket_flights ............. [[32mCREATE VIEW[0m in 0.06s]
[0m12:28:43.579919 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_ticket_flights
[0m12:28:43.580141 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_supplier
[0m12:28:43.580401 [info ] [Thread-1 (]: 17 of 36 START sql incremental model dwh_detailed.hub_supplier ................. [RUN]
[0m12:28:43.581098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_ticket_flights, now model.dbtvault.hub_supplier)
[0m12:28:43.581493 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_supplier
[0m12:28:43.584470 [info ] [Thread-1 (]: 12:28:43 + Loading postgres.dwh_detailed.hub_supplier from 1 source(s)
[0m12:28:43.586142 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_supplier"
[0m12:28:43.586441 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_supplier
[0m12:28:43.589003 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_supplier"
[0m12:28:43.589293 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_supplier"
[0m12:28:43.589463 [debug] [Thread-1 (]: On model.dbtvault.hub_supplier: BEGIN
[0m12:28:43.589639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.593375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.593624 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_supplier"
[0m12:28:43.593847 [debug] [Thread-1 (]: On model.dbtvault.hub_supplier: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_supplier"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_supplier"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."tickets" AS rr
    WHERE rr.TICKET_PK IS NOT NULL
    ORDER BY rr.TICKET_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.TICKET_PK, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.594588 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.ticket_pk does not exist
LINE 18:     SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticke...
                                               ^
HINT:  Perhaps you meant to reference the column "rr.ticket_no".

[0m12:28:43.594838 [debug] [Thread-1 (]: On model.dbtvault.hub_supplier: ROLLBACK
[0m12:28:43.595310 [debug] [Thread-1 (]: On model.dbtvault.hub_supplier: Close
[0m12:28:43.595893 [debug] [Thread-1 (]: Database Error in model hub_supplier (models/raw_vault/hubs/hub_supplier.sql)
  column rr.ticket_pk does not exist
  LINE 18:     SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticke...
                                                 ^
  HINT:  Perhaps you meant to reference the column "rr.ticket_no".
  compiled code at target/run/dbtvault/models/raw_vault/hubs/hub_supplier.sql
[0m12:28:43.596315 [error] [Thread-1 (]: 17 of 36 ERROR creating sql incremental model dwh_detailed.hub_supplier ........ [[31mERROR[0m in 0.02s]
[0m12:28:43.596689 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_supplier
[0m12:28:43.596903 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_tickets
[0m12:28:43.597417 [debug] [Thread-4 (]: Marking all children of 'model.dbtvault.hub_supplier' to be skipped because of status 'error'.  Reason: Database Error in model hub_supplier (models/raw_vault/hubs/hub_supplier.sql)
  column rr.ticket_pk does not exist
  LINE 18:     SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticke...
                                                 ^
  HINT:  Perhaps you meant to reference the column "rr.ticket_no".
  compiled code at target/run/dbtvault/models/raw_vault/hubs/hub_supplier.sql.
[0m12:28:43.597162 [info ] [Thread-1 (]: 18 of 36 START sql view model dwh_detailed.stg_tickets ......................... [RUN]
[0m12:28:43.597833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_supplier, now model.dbtvault.stg_tickets)
[0m12:28:43.598022 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_tickets
[0m12:28:43.602802 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:28:43.603010 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: BEGIN
[0m12:28:43.603176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.606789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.607004 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:28:43.607229 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.618304 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m12:28:43.657278 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:28:43.657586 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:28:43.664474 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m12:28:43.668803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_tickets"
[0m12:28:43.669110 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_tickets
[0m12:28:43.671439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_tickets"
[0m12:28:43.671731 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:28:43.671948 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

  create view "postgres"."dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed"."tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS TICKET_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_BOOKING_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKETHASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    TICKET_PK,
    LINK_TICKET_BOOKING_PK,
    TICKETHASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:28:43.678872 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:28:43.681443 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:28:43.681664 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
alter table "postgres"."dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m12:28:43.682813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:43.683616 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:28:43.683862 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:28:43.684026 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:28:43.687042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.688689 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_tickets__dbt_backup"
[0m12:28:43.689052 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:28:43.689217 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m12:28:43.690452 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:43.691288 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: Close
[0m12:28:43.691856 [info ] [Thread-1 (]: 18 of 36 OK created sql view model dwh_detailed.stg_tickets .................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:28:43.692182 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_tickets
[0m12:28:43.692437 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_aircraft
[0m12:28:43.692702 [info ] [Thread-1 (]: 19 of 36 START sql incremental model dwh_detailed.hub_aircraft ................. [RUN]
[0m12:28:43.693452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_tickets, now model.dbtvault.hub_aircraft)
[0m12:28:43.693755 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_aircraft
[0m12:28:43.696714 [info ] [Thread-1 (]: 12:28:43 + Loading postgres.dwh_detailed.hub_aircraft from 1 source(s)
[0m12:28:43.698399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_aircraft"
[0m12:28:43.698806 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_aircraft
[0m12:28:43.701391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_aircraft"
[0m12:28:43.701680 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:28:43.701876 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: BEGIN
[0m12:28:43.702100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.705669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.705915 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:28:43.706106 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRCRAFT_PK) rr.AIRCRAFT_PK, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.AIRCRAFT_PK IS NOT NULL
    ORDER BY rr.AIRCRAFT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRCRAFT_PK, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.723960 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:28:43.725047 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:28:43.725283 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:28:43.725456 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:28:43.728074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:43.728634 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: Close
[0m12:28:43.729156 [info ] [Thread-1 (]: 19 of 36 OK created sql incremental model dwh_detailed.hub_aircraft ............ [[32mSELECT 1[0m in 0.04s]
[0m12:28:43.729469 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_aircraft
[0m12:28:43.729687 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_aircraft_data
[0m12:28:43.729933 [info ] [Thread-1 (]: 20 of 36 START sql incremental model dwh_detailed.sat_aircraft_data ............ [RUN]
[0m12:28:43.730189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_aircraft, now model.dbtvault.sat_aircraft_data)
[0m12:28:43.730356 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_aircraft_data
[0m12:28:43.736931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_aircraft_data"
[0m12:28:43.737387 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_aircraft_data
[0m12:28:43.739908 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_aircraft_data"
[0m12:28:43.740305 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:28:43.740490 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: BEGIN
[0m12:28:43.740650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.744610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.744841 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:28:43.745018 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_aircraft_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRCRAFT_PK, a.AIRCRAFT_HASHDIFF, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS a
    WHERE a.AIRCRAFT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.745880 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not identify an equality operator for type json
LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                              ^

[0m12:28:43.746070 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: ROLLBACK
[0m12:28:43.746527 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: Close
[0m12:28:43.747091 [debug] [Thread-1 (]: Database Error in model sat_aircraft_data (models/raw_vault/sats/sat_aircraft_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_aircraft_data.sql
[0m12:28:43.747538 [error] [Thread-1 (]: 20 of 36 ERROR creating sql incremental model dwh_detailed.sat_aircraft_data ... [[31mERROR[0m in 0.02s]
[0m12:28:43.747845 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_aircraft_data
[0m12:28:43.748040 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_airport
[0m12:28:43.748313 [debug] [Thread-4 (]: Marking all children of 'model.dbtvault.sat_aircraft_data' to be skipped because of status 'error'.  Reason: Database Error in model sat_aircraft_data (models/raw_vault/sats/sat_aircraft_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_aircraft_data.sql.
[0m12:28:43.748614 [info ] [Thread-1 (]: 21 of 36 START sql incremental model dwh_detailed.hub_airport .................. [RUN]
[0m12:28:43.748992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_aircraft_data, now model.dbtvault.hub_airport)
[0m12:28:43.749171 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_airport
[0m12:28:43.752001 [info ] [Thread-1 (]: 12:28:43 + Loading postgres.dwh_detailed.hub_airport from 1 source(s)
[0m12:28:43.753643 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_airport"
[0m12:28:43.753950 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_airport
[0m12:28:43.756943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_airport"
[0m12:28:43.757291 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:28:43.757496 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: BEGIN
[0m12:28:43.757661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.761275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.761489 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:28:43.761678 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_PK) rr.AIRPORT_PK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS rr
    WHERE rr.AIRPORT_PK IS NOT NULL
    ORDER BY rr.AIRPORT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_PK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.779795 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m12:28:43.781058 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:28:43.781303 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:28:43.781468 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:28:43.784246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.784785 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: Close
[0m12:28:43.785366 [info ] [Thread-1 (]: 21 of 36 OK created sql incremental model dwh_detailed.hub_airport ............. [[32mSELECT 2[0m in 0.04s]
[0m12:28:43.785693 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_airport
[0m12:28:43.785904 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_airports_data
[0m12:28:43.786177 [info ] [Thread-1 (]: 22 of 36 START sql incremental model dwh_detailed.sat_airports_data ............ [RUN]
[0m12:28:43.786474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_airport, now model.dbtvault.sat_airports_data)
[0m12:28:43.786650 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_airports_data
[0m12:28:43.793100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_airports_data"
[0m12:28:43.793464 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_airports_data
[0m12:28:43.796094 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_airports_data"
[0m12:28:43.796397 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:28:43.796611 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: BEGIN
[0m12:28:43.796761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.801039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.801290 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:28:43.801465 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_airports_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS a
    WHERE a.AIRPORT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRPORT_PK, stage.AIRPORT_HASHDIFF, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.828115 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.026 seconds
[0m12:28:43.829237 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:28:43.829484 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:28:43.829647 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:28:43.832312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:43.832829 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: Close
[0m12:28:43.833361 [info ] [Thread-1 (]: 22 of 36 OK created sql incremental model dwh_detailed.sat_airports_data ....... [[32mSELECT 2[0m in 0.05s]
[0m12:28:43.833719 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_airports_data
[0m12:28:43.833939 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:28:43.834184 [info ] [Thread-1 (]: 23 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [RUN]
[0m12:28:43.834597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_airports_data, now model.dbtvault.sat_ticket_flights_boarding_passes)
[0m12:28:43.835189 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:28:43.841856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:28:43.842166 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:28:43.844979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:28:43.845290 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:28:43.845463 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: BEGIN
[0m12:28:43.845613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.849286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.849513 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:28:43.849697 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.TICKET_FLIGHTS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_FLIGHTS_PK, stage.BOARDING_PASSES_HASHDIFF, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.875275 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:28:43.876370 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:28:43.876635 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:28:43.876810 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:28:43.879854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.880444 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: Close
[0m12:28:43.880996 [info ] [Thread-1 (]: 23 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [[32mSELECT 1[0m in 0.05s]
[0m12:28:43.881427 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:28:43.881687 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_booking_data
[0m12:28:43.881960 [info ] [Thread-1 (]: 24 of 36 START sql incremental model dwh_detailed.sat_booking_data ............. [RUN]
[0m12:28:43.882550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_boarding_passes, now model.dbtvault.sat_booking_data)
[0m12:28:43.882775 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_booking_data
[0m12:28:43.889553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_booking_data"
[0m12:28:43.889901 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_booking_data
[0m12:28:43.893003 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_booking_data"
[0m12:28:43.893358 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:28:43.893602 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: BEGIN
[0m12:28:43.893808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.897505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.897781 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:28:43.898011 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_booking_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS a
    WHERE a.BOOK_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.BOOK_PK, stage.BOOK_HASHDIFF, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.924034 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m12:28:43.925243 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:28:43.925488 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:28:43.925684 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:28:43.928504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:43.929047 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: Close
[0m12:28:43.929597 [info ] [Thread-1 (]: 24 of 36 OK created sql incremental model dwh_detailed.sat_booking_data ........ [[32mSELECT 1[0m in 0.05s]
[0m12:28:43.929914 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_booking_data
[0m12:28:43.930213 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_flight
[0m12:28:43.930468 [info ] [Thread-1 (]: 25 of 36 START sql incremental model dwh_detailed.hub_flight ................... [RUN]
[0m12:28:43.930746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_booking_data, now model.dbtvault.hub_flight)
[0m12:28:43.930956 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_flight
[0m12:28:43.934278 [info ] [Thread-1 (]: 12:28:43 + Loading postgres.dwh_detailed.hub_flight from 1 source(s)
[0m12:28:43.936108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_flight"
[0m12:28:43.936414 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_flight
[0m12:28:43.939095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_flight"
[0m12:28:43.939486 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:28:43.939668 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: BEGIN
[0m12:28:43.939817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.943581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.943819 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:28:43.943993 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_flight"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.FLIGHT_PK) rr.FLIGHT_PK, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.FLIGHT_PK IS NOT NULL
    ORDER BY rr.FLIGHT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.FLIGHT_PK, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:43.960100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m12:28:43.961204 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:28:43.961462 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:28:43.961626 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:28:43.964157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:43.964716 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: Close
[0m12:28:43.965266 [info ] [Thread-1 (]: 25 of 36 OK created sql incremental model dwh_detailed.hub_flight .............. [[32mSELECT 1[0m in 0.03s]
[0m12:28:43.965632 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_flight
[0m12:28:43.965853 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_aircraft
[0m12:28:43.966461 [info ] [Thread-1 (]: 26 of 36 START sql incremental model dwh_detailed.link_flight_aircraft ......... [RUN]
[0m12:28:43.966810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_flight, now model.dbtvault.link_flight_aircraft)
[0m12:28:43.967003 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_aircraft
[0m12:28:43.969934 [info ] [Thread-1 (]: 12:28:43 + Loading postgres.dwh_detailed.link_flight_aircraft from 1 source(s)
[0m12:28:43.972485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_aircraft"
[0m12:28:43.972898 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_aircraft
[0m12:28:43.975615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_aircraft"
[0m12:28:43.976103 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:28:43.976294 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: BEGIN
[0m12:28:43.976464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:43.980298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:43.980518 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:28:43.980700 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_AIRCRAFT_PK, rr.flight_id, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_AIRCRAFT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_AIRCRAFT_PK, a.flight_id, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.010649 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m12:28:44.011775 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:28:44.012017 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:28:44.012177 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:28:44.015620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:44.016185 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: Close
[0m12:28:44.016768 [info ] [Thread-1 (]: 26 of 36 OK created sql incremental model dwh_detailed.link_flight_aircraft .... [[32mSELECT 1[0m in 0.05s]
[0m12:28:44.017099 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_aircraft
[0m12:28:44.017312 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_arrival_airport
[0m12:28:44.017590 [info ] [Thread-1 (]: 27 of 36 START sql incremental model dwh_detailed.link_flight_arrival_airport .. [RUN]
[0m12:28:44.017882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_aircraft, now model.dbtvault.link_flight_arrival_airport)
[0m12:28:44.018081 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_arrival_airport
[0m12:28:44.021422 [info ] [Thread-1 (]: 12:28:44 + Loading postgres.dwh_detailed.link_flight_arrival_airport from 1 source(s)
[0m12:28:44.023521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_arrival_airport"
[0m12:28:44.023806 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_arrival_airport
[0m12:28:44.026511 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_arrival_airport"
[0m12:28:44.026814 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:28:44.026988 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: BEGIN
[0m12:28:44.027136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.030955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.031215 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:28:44.031396 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_arrival_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, rr.flight_id, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, a.flight_id, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.061880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m12:28:44.062981 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:28:44.063253 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:28:44.063436 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:28:44.066252 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:44.066773 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: Close
[0m12:28:44.067324 [info ] [Thread-1 (]: 27 of 36 OK created sql incremental model dwh_detailed.link_flight_arrival_airport  [[32mSELECT 1[0m in 0.05s]
[0m12:28:44.067664 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_arrival_airport
[0m12:28:44.067882 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_departure_airport
[0m12:28:44.068135 [info ] [Thread-1 (]: 28 of 36 START sql incremental model dwh_detailed.link_flight_departure_airport  [RUN]
[0m12:28:44.068426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_arrival_airport, now model.dbtvault.link_flight_departure_airport)
[0m12:28:44.068628 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_departure_airport
[0m12:28:44.072462 [info ] [Thread-1 (]: 12:28:44 + Loading postgres.dwh_detailed.link_flight_departure_airport from 1 source(s)
[0m12:28:44.074676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_departure_airport"
[0m12:28:44.075007 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_departure_airport
[0m12:28:44.077778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_departure_airport"
[0m12:28:44.078091 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:28:44.078283 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: BEGIN
[0m12:28:44.078432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.082684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.082930 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:28:44.083126 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_departure_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, rr.flight_id, rr.departure_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, a.flight_id, a.departure_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.112721 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m12:28:44.113835 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:28:44.114096 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:28:44.114258 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:28:44.116917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:44.117533 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: Close
[0m12:28:44.118171 [info ] [Thread-1 (]: 28 of 36 OK created sql incremental model dwh_detailed.link_flight_departure_airport  [[32mSELECT 1[0m in 0.05s]
[0m12:28:44.118531 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_departure_airport
[0m12:28:44.118751 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_flight_data
[0m12:28:44.118997 [info ] [Thread-1 (]: 29 of 36 START sql incremental model dwh_detailed.sat_flight_data .............. [RUN]
[0m12:28:44.119247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_departure_airport, now model.dbtvault.sat_flight_data)
[0m12:28:44.119478 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_flight_data
[0m12:28:44.126546 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_flight_data"
[0m12:28:44.126883 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_flight_data
[0m12:28:44.130073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_flight_data"
[0m12:28:44.130448 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:28:44.130619 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: BEGIN
[0m12:28:44.130775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.135074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.135354 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:28:44.135544 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_flight_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.status, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS a
    WHERE a.FLIGHT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.FLIGHT_PK, stage.FLIGHT_HASHDIFF, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.status, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.166377 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.031 seconds
[0m12:28:44.167541 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:28:44.167820 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:28:44.167994 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:28:44.170682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:44.171224 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: Close
[0m12:28:44.171750 [info ] [Thread-1 (]: 29 of 36 OK created sql incremental model dwh_detailed.sat_flight_data ......... [[32mSELECT 1[0m in 0.05s]
[0m12:28:44.172090 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_flight_data
[0m12:28:44.172308 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_seat
[0m12:28:44.172562 [info ] [Thread-1 (]: 30 of 36 START sql incremental model dwh_detailed.hub_seat ..................... [RUN]
[0m12:28:44.172799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_flight_data, now model.dbtvault.hub_seat)
[0m12:28:44.173001 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_seat
[0m12:28:44.176242 [info ] [Thread-1 (]: 12:28:44 + Loading postgres.dwh_detailed.hub_seat from 1 source(s)
[0m12:28:44.178260 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_seat"
[0m12:28:44.178650 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_seat
[0m12:28:44.181375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_seat"
[0m12:28:44.181700 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:28:44.181874 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: BEGIN
[0m12:28:44.182018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.185722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.185948 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:28:44.186121 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_seat"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.SEAT_PK) rr.SEAT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.SEAT_PK IS NOT NULL
    ORDER BY rr.SEAT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.SEAT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.204153 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:28:44.205298 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:28:44.205531 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:28:44.205704 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:28:44.208343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:44.208869 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: Close
[0m12:28:44.209405 [info ] [Thread-1 (]: 30 of 36 OK created sql incremental model dwh_detailed.hub_seat ................ [[32mSELECT 1[0m in 0.04s]
[0m12:28:44.209740 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_seat
[0m12:28:44.209961 [debug] [Thread-1 (]: Began running node model.dbtvault.link_seat_aircraft
[0m12:28:44.210218 [info ] [Thread-1 (]: 31 of 36 START sql incremental model dwh_detailed.link_seat_aircraft ........... [RUN]
[0m12:28:44.210458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_seat, now model.dbtvault.link_seat_aircraft)
[0m12:28:44.210623 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_seat_aircraft
[0m12:28:44.214304 [info ] [Thread-1 (]: 12:28:44 + Loading postgres.dwh_detailed.link_seat_aircraft from 1 source(s)
[0m12:28:44.216530 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_seat_aircraft"
[0m12:28:44.216813 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_seat_aircraft
[0m12:28:44.219533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_seat_aircraft"
[0m12:28:44.219840 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:28:44.220011 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: BEGIN
[0m12:28:44.220158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.224060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.224322 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:28:44.224507 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_seat_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_SEAT_AIRCRAFT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SEAT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.LINK_SEAT_AIRCRAFT_PK IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SEAT_AIRCRAFT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.250326 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m12:28:44.251437 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:28:44.251684 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:28:44.251846 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:28:44.254586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:44.255101 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: Close
[0m12:28:44.255644 [info ] [Thread-1 (]: 31 of 36 OK created sql incremental model dwh_detailed.link_seat_aircraft ...... [[32mSELECT 1[0m in 0.05s]
[0m12:28:44.255966 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_seat_aircraft
[0m12:28:44.256261 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_seat_data
[0m12:28:44.256622 [info ] [Thread-1 (]: 32 of 36 START sql incremental model dwh_detailed.sat_seat_data ................ [RUN]
[0m12:28:44.257141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_seat_aircraft, now model.dbtvault.sat_seat_data)
[0m12:28:44.257837 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_seat_data
[0m12:28:44.263837 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_seat_data"
[0m12:28:44.264155 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_seat_data
[0m12:28:44.267517 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_seat_data"
[0m12:28:44.267841 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:28:44.268032 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: BEGIN
[0m12:28:44.268181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.271961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.272204 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:28:44.272379 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_seat_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS a
    WHERE a.SEAT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SEAT_PK, stage.SEAT_HASHDIFF, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.297421 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:28:44.298514 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:28:44.298757 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:28:44.298922 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:28:44.301443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:44.301974 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: Close
[0m12:28:44.302517 [info ] [Thread-1 (]: 32 of 36 OK created sql incremental model dwh_detailed.sat_seat_data ........... [[32mSELECT 1[0m in 0.05s]
[0m12:28:44.304690 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_seat_data
[0m12:28:44.304958 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_flights
[0m12:28:44.305256 [info ] [Thread-1 (]: 33 of 36 START sql incremental model dwh_detailed.link_ticket_flights .......... [RUN]
[0m12:28:44.305678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_seat_data, now model.dbtvault.link_ticket_flights)
[0m12:28:44.305879 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_flights
[0m12:28:44.308950 [info ] [Thread-1 (]: 12:28:44 + Loading postgres.dwh_detailed.link_ticket_flights from 1 source(s)
[0m12:28:44.310911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_flights"
[0m12:28:44.311200 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_flights
[0m12:28:44.314017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_flights"
[0m12:28:44.314335 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:28:44.314509 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: BEGIN
[0m12:28:44.314660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.318248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.318469 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:28:44.318643 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_FLIGHTS_PK, rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_FLIGHTS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.LINK_TICKET_FLIGHTS_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.344600 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m12:28:44.345723 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:28:44.345975 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:28:44.346137 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:28:44.348978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:44.349503 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: Close
[0m12:28:44.350082 [info ] [Thread-1 (]: 33 of 36 OK created sql incremental model dwh_detailed.link_ticket_flights ..... [[32mSELECT 1[0m in 0.04s]
[0m12:28:44.350419 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_flights
[0m12:28:44.350626 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_data
[0m12:28:44.350865 [info ] [Thread-1 (]: 34 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_data ...... [RUN]
[0m12:28:44.351122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_flights, now model.dbtvault.sat_ticket_flights_data)
[0m12:28:44.351335 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_data
[0m12:28:44.358392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_data"
[0m12:28:44.358709 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_data
[0m12:28:44.361546 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_data"
[0m12:28:44.361849 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:28:44.362027 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: BEGIN
[0m12:28:44.362177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.366616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.366871 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:28:44.367052 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_flights_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.LINK_TICKET_FLIGHTS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_PK, stage.TICKET_FLIGHTS_HASHDIFF, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.392728 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:28:44.393856 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:28:44.394102 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:28:44.394269 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:28:44.397013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:44.397608 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: Close
[0m12:28:44.398185 [info ] [Thread-1 (]: 34 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_data . [[32mSELECT 1[0m in 0.05s]
[0m12:28:44.398546 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_data
[0m12:28:44.398763 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_booking
[0m12:28:44.399009 [info ] [Thread-1 (]: 35 of 36 START sql incremental model dwh_detailed.link_ticket_booking .......... [RUN]
[0m12:28:44.399285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_data, now model.dbtvault.link_ticket_booking)
[0m12:28:44.399461 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_booking
[0m12:28:44.402570 [info ] [Thread-1 (]: 12:28:44 + Loading postgres.dwh_detailed.link_ticket_booking from 1 source(s)
[0m12:28:44.404879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_booking"
[0m12:28:44.405190 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_booking
[0m12:28:44.408003 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_booking"
[0m12:28:44.408304 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:28:44.408483 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: BEGIN
[0m12:28:44.408632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.412131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m12:28:44.412383 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:28:44.412587 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_ticket_booking"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_BOOKING_PK, rr.ticket_no, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_BOOKING_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.LINK_TICKET_BOOKING_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_BOOKING_PK, a.ticket_no, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.438542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m12:28:44.439761 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:28:44.440042 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:28:44.440297 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:28:44.443050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:28:44.443554 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: Close
[0m12:28:44.444103 [info ] [Thread-1 (]: 35 of 36 OK created sql incremental model dwh_detailed.link_ticket_booking ..... [[32mSELECT 1[0m in 0.04s]
[0m12:28:44.444437 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_booking
[0m12:28:44.444651 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_data
[0m12:28:44.444920 [info ] [Thread-1 (]: 36 of 36 START sql incremental model dwh_detailed.sat_ticket_data .............. [RUN]
[0m12:28:44.446091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_booking, now model.dbtvault.sat_ticket_data)
[0m12:28:44.446558 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_data
[0m12:28:44.454184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_data"
[0m12:28:44.454569 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_data
[0m12:28:44.457444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_data"
[0m12:28:44.457789 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:28:44.457977 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: BEGIN
[0m12:28:44.458130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:44.461892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:28:44.462122 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:28:44.462297 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_PK, a.TICKETHASHDIFF, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS a
    WHERE a.TICKET_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_PK, stage.TICKETHASHDIFF, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:28:44.463242 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not identify an equality operator for type json
LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                              ^

[0m12:28:44.463428 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: ROLLBACK
[0m12:28:44.463940 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: Close
[0m12:28:44.464532 [debug] [Thread-1 (]: Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql
[0m12:28:44.464975 [error] [Thread-1 (]: 36 of 36 ERROR creating sql incremental model dwh_detailed.sat_ticket_data ..... [[31mERROR[0m in 0.02s]
[0m12:28:44.465312 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_data
[0m12:28:44.465606 [debug] [Thread-4 (]: Marking all children of 'model.dbtvault.sat_ticket_data' to be skipped because of status 'error'.  Reason: Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql.
[0m12:28:44.466486 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:44.466655 [debug] [MainThread]: On master: BEGIN
[0m12:28:44.466781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:44.470009 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:28:44.470200 [debug] [MainThread]: On master: COMMIT
[0m12:28:44.470368 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:44.470505 [debug] [MainThread]: On master: COMMIT
[0m12:28:44.470955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:44.471150 [debug] [MainThread]: On master: Close
[0m12:28:44.471399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:44.471541 [debug] [MainThread]: Connection 'model.dbtvault.sat_ticket_data' was properly closed.
[0m12:28:44.471810 [info ] [MainThread]: 
[0m12:28:44.471989 [info ] [MainThread]: Finished running 20 incremental models, 8 table models, 8 view models in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m12:28:44.474612 [debug] [MainThread]: Command end result
[0m12:28:44.496513 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:28:44.497527 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:28:44.501658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/user/dwh/dbt/target/run_results.json
[0m12:28:44.501874 [info ] [MainThread]: 
[0m12:28:44.502092 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:28:44.502264 [info ] [MainThread]: 
[0m12:28:44.502520 [error] [MainThread]:   Database Error in model hub_booking (models/raw_vault/hubs/hub_booking.sql)
  column rr.book_pk does not exist
  LINE 18:     SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref,...
                                               ^
  HINT:  Perhaps you meant to reference the column "rr.book_ref".
  compiled code at target/run/dbtvault/models/raw_vault/hubs/hub_booking.sql
[0m12:28:44.502694 [info ] [MainThread]: 
[0m12:28:44.502876 [error] [MainThread]:   Database Error in model hub_supplier (models/raw_vault/hubs/hub_supplier.sql)
  column rr.ticket_pk does not exist
  LINE 18:     SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticke...
                                                 ^
  HINT:  Perhaps you meant to reference the column "rr.ticket_no".
  compiled code at target/run/dbtvault/models/raw_vault/hubs/hub_supplier.sql
[0m12:28:44.503028 [info ] [MainThread]: 
[0m12:28:44.503207 [error] [MainThread]:   Database Error in model sat_aircraft_data (models/raw_vault/sats/sat_aircraft_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_aircraft_data.sql
[0m12:28:44.503353 [info ] [MainThread]: 
[0m12:28:44.503532 [error] [MainThread]:   Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql
[0m12:28:44.503758 [info ] [MainThread]: 
[0m12:28:44.504086 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=4 SKIP=0 TOTAL=36
[0m12:28:44.504688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6637003, "process_in_blocks": "3112", "process_kernel_time": 0.095895, "process_mem_max_rss": "124284", "process_out_blocks": "7256", "process_user_time": 3.030295}
[0m12:28:44.504964 [debug] [MainThread]: Command `dbt run` failed at 12:28:44.504901 after 3.66 seconds
[0m12:28:44.505158 [debug] [MainThread]: Flushing usage events


============================== 12:32:59.525299 | 443d572d-2dd0-4c0b-9391-f382dfda30c5 ==============================
[0m12:32:59.525299 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:32:59.526935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/user/dwh/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:32:59.527141 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:32:59.650365 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:32:59.688764 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:32:59.758813 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m12:32:59.759308 [debug] [MainThread]: Partial parsing: added file: dbtvault://models/raw_vault/hubs/hub_ticket.sql
[0m12:32:59.759468 [debug] [MainThread]: Partial parsing: deleted file: dbtvault://models/raw_vault/hubs/hub_supplier.sql
[0m12:32:59.759659 [debug] [MainThread]: Partial parsing: updated file: dbtvault://models/raw_vault/hubs/hub_booking.sql
[0m12:32:59.940605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m12:33:00.024980 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:33:00.026400 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:33:00.033253 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m12:33:00.034790 [info ] [MainThread]: 
[0m12:33:00.035029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:00.035193 [info ] [MainThread]: 
[0m12:33:00.035463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:33:00.038943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:33:00.050618 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:33:00.050854 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:33:00.051003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:00.059219 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m12:33:00.059979 [debug] [ThreadPool]: On list_postgres: Close
[0m12:33:00.061971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed)
[0m12:33:00.065571 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:33:00.065770 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m12:33:00.065907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:00.070073 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.070266 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:33:00.070419 [debug] [ThreadPool]: On list_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed'
  
[0m12:33:00.075774 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.005 seconds
[0m12:33:00.076764 [debug] [ThreadPool]: On list_postgres_dwh_detailed: ROLLBACK
[0m12:33:00.077546 [debug] [ThreadPool]: On list_postgres_dwh_detailed: Close
[0m12:33:00.083856 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:00.084051 [debug] [MainThread]: On master: BEGIN
[0m12:33:00.084190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:00.087818 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.088023 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:00.088208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:33:00.095758 [debug] [MainThread]: SQL status: SELECT 61 in 0.007 seconds
[0m12:33:00.097859 [debug] [MainThread]: On master: ROLLBACK
[0m12:33:00.098391 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:00.098607 [debug] [MainThread]: On master: BEGIN
[0m12:33:00.099358 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:33:00.099533 [debug] [MainThread]: On master: COMMIT
[0m12:33:00.099676 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:00.099813 [debug] [MainThread]: On master: COMMIT
[0m12:33:00.100231 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:33:00.100415 [debug] [MainThread]: On master: Close
[0m12:33:00.101633 [debug] [Thread-1 (]: Began running node model.dbtvault.aircrafts
[0m12:33:00.101945 [info ] [Thread-1 (]: 1 of 36 START sql table model dwh_detailed.aircrafts ........................... [RUN]
[0m12:33:00.102255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed, now model.dbtvault.aircrafts)
[0m12:33:00.102462 [debug] [Thread-1 (]: Began compiling node model.dbtvault.aircrafts
[0m12:33:00.106872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.aircrafts"
[0m12:33:00.107183 [debug] [Thread-1 (]: Began executing node model.dbtvault.aircrafts
[0m12:33:00.128047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.aircrafts"
[0m12:33:00.128451 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:33:00.128660 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: BEGIN
[0m12:33:00.128827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.132930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.133154 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:33:00.133323 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */

  
    

  create  table "postgres"."dwh_detailed"."aircrafts__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_aircrafts"
  );
  
[0m12:33:00.154843 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m12:33:00.159257 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:33:00.159513 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts" rename to "aircrafts__dbt_backup"
[0m12:33:00.161301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.163823 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:33:00.164033 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts__dbt_tmp" rename to "aircrafts"
[0m12:33:00.164946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.175308 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:33:00.175549 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:33:00.175714 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:33:00.178507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.182674 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."aircrafts__dbt_backup"
[0m12:33:00.185082 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:33:00.185288 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
drop table if exists "postgres"."dwh_detailed"."aircrafts__dbt_backup" cascade
[0m12:33:00.215521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m12:33:00.217361 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: Close
[0m12:33:00.218615 [info ] [Thread-1 (]: 1 of 36 OK created sql table model dwh_detailed.aircrafts ...................... [[32mSELECT 1[0m in 0.12s]
[0m12:33:00.219019 [debug] [Thread-1 (]: Finished running node model.dbtvault.aircrafts
[0m12:33:00.219245 [debug] [Thread-1 (]: Began running node model.dbtvault.airports
[0m12:33:00.219906 [info ] [Thread-1 (]: 2 of 36 START sql table model dwh_detailed.airports ............................ [RUN]
[0m12:33:00.220234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.aircrafts, now model.dbtvault.airports)
[0m12:33:00.220427 [debug] [Thread-1 (]: Began compiling node model.dbtvault.airports
[0m12:33:00.222422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.airports"
[0m12:33:00.222742 [debug] [Thread-1 (]: Began executing node model.dbtvault.airports
[0m12:33:00.225152 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.airports"
[0m12:33:00.225463 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:33:00.225641 [debug] [Thread-1 (]: On model.dbtvault.airports: BEGIN
[0m12:33:00.225787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.229795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.230023 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:33:00.230197 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */

  
    

  create  table "postgres"."dwh_detailed"."airports__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_airports"
  );
  
[0m12:33:00.248547 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m12:33:00.251076 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:33:00.251326 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports" rename to "airports__dbt_backup"
[0m12:33:00.252989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.255653 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:33:00.255860 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports__dbt_tmp" rename to "airports"
[0m12:33:00.256786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.257669 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:33:00.257870 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:33:00.258025 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:33:00.260778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.262527 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."airports__dbt_backup"
[0m12:33:00.262954 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:33:00.263141 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
drop table if exists "postgres"."dwh_detailed"."airports__dbt_backup" cascade
[0m12:33:00.268481 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:33:00.269330 [debug] [Thread-1 (]: On model.dbtvault.airports: Close
[0m12:33:00.269863 [info ] [Thread-1 (]: 2 of 36 OK created sql table model dwh_detailed.airports ....................... [[32mSELECT 2[0m in 0.05s]
[0m12:33:00.270195 [debug] [Thread-1 (]: Finished running node model.dbtvault.airports
[0m12:33:00.270408 [debug] [Thread-1 (]: Began running node model.dbtvault.boarding_passes
[0m12:33:00.271062 [info ] [Thread-1 (]: 3 of 36 START sql table model dwh_detailed.boarding_passes ..................... [RUN]
[0m12:33:00.271593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.airports, now model.dbtvault.boarding_passes)
[0m12:33:00.271805 [debug] [Thread-1 (]: Began compiling node model.dbtvault.boarding_passes
[0m12:33:00.273700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.boarding_passes"
[0m12:33:00.274027 [debug] [Thread-1 (]: Began executing node model.dbtvault.boarding_passes
[0m12:33:00.276512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.boarding_passes"
[0m12:33:00.276814 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:33:00.276989 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: BEGIN
[0m12:33:00.277158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.281050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.281325 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:33:00.281515 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */

  
    

  create  table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_boarding_passes"
  );
  
[0m12:33:00.298903 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:33:00.301368 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:33:00.301603 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes" rename to "boarding_passes__dbt_backup"
[0m12:33:00.302981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.305856 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:33:00.306064 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp" rename to "boarding_passes"
[0m12:33:00.306999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.307921 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:33:00.308120 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:33:00.308288 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:33:00.311015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.312749 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."boarding_passes__dbt_backup"
[0m12:33:00.313131 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:33:00.313309 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
drop table if exists "postgres"."dwh_detailed"."boarding_passes__dbt_backup" cascade
[0m12:33:00.318333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:33:00.319129 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: Close
[0m12:33:00.319629 [info ] [Thread-1 (]: 3 of 36 OK created sql table model dwh_detailed.boarding_passes ................ [[32mSELECT 1[0m in 0.05s]
[0m12:33:00.319986 [debug] [Thread-1 (]: Finished running node model.dbtvault.boarding_passes
[0m12:33:00.320200 [debug] [Thread-1 (]: Began running node model.dbtvault.bookings
[0m12:33:00.320704 [info ] [Thread-1 (]: 4 of 36 START sql table model dwh_detailed.bookings ............................ [RUN]
[0m12:33:00.321027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.boarding_passes, now model.dbtvault.bookings)
[0m12:33:00.321228 [debug] [Thread-1 (]: Began compiling node model.dbtvault.bookings
[0m12:33:00.323156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.bookings"
[0m12:33:00.323468 [debug] [Thread-1 (]: Began executing node model.dbtvault.bookings
[0m12:33:00.325893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.bookings"
[0m12:33:00.326201 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:33:00.326394 [debug] [Thread-1 (]: On model.dbtvault.bookings: BEGIN
[0m12:33:00.326543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.330265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.330525 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:33:00.330703 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */

  
    

  create  table "postgres"."dwh_detailed"."bookings__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_bookings"
  );
  
[0m12:33:00.348866 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:33:00.351891 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:33:00.352152 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings" rename to "bookings__dbt_backup"
[0m12:33:00.353645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.356075 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:33:00.356281 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings__dbt_tmp" rename to "bookings"
[0m12:33:00.357169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.358139 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:33:00.358346 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:33:00.358507 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:33:00.361220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.362838 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."bookings__dbt_backup"
[0m12:33:00.363229 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:33:00.363405 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
drop table if exists "postgres"."dwh_detailed"."bookings__dbt_backup" cascade
[0m12:33:00.367984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:33:00.368810 [debug] [Thread-1 (]: On model.dbtvault.bookings: Close
[0m12:33:00.369349 [info ] [Thread-1 (]: 4 of 36 OK created sql table model dwh_detailed.bookings ....................... [[32mSELECT 1[0m in 0.05s]
[0m12:33:00.369679 [debug] [Thread-1 (]: Finished running node model.dbtvault.bookings
[0m12:33:00.369889 [debug] [Thread-1 (]: Began running node model.dbtvault.flights
[0m12:33:00.370157 [info ] [Thread-1 (]: 5 of 36 START sql table model dwh_detailed.flights ............................. [RUN]
[0m12:33:00.370465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.bookings, now model.dbtvault.flights)
[0m12:33:00.370916 [debug] [Thread-1 (]: Began compiling node model.dbtvault.flights
[0m12:33:00.372971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.flights"
[0m12:33:00.373282 [debug] [Thread-1 (]: Began executing node model.dbtvault.flights
[0m12:33:00.376331 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.flights"
[0m12:33:00.376636 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:33:00.376840 [debug] [Thread-1 (]: On model.dbtvault.flights: BEGIN
[0m12:33:00.376988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.381171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.381413 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:33:00.381582 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */

  
    

  create  table "postgres"."dwh_detailed"."flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_flights"
  );
  
[0m12:33:00.399128 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:33:00.401610 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:33:00.401852 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights" rename to "flights__dbt_backup"
[0m12:33:00.403350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.405684 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:33:00.405897 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights__dbt_tmp" rename to "flights"
[0m12:33:00.406907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.407856 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:33:00.408073 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:33:00.408237 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:33:00.411111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.412868 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."flights__dbt_backup"
[0m12:33:00.413276 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:33:00.413456 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
drop table if exists "postgres"."dwh_detailed"."flights__dbt_backup" cascade
[0m12:33:00.419356 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:33:00.420208 [debug] [Thread-1 (]: On model.dbtvault.flights: Close
[0m12:33:00.420714 [info ] [Thread-1 (]: 5 of 36 OK created sql table model dwh_detailed.flights ........................ [[32mSELECT 1[0m in 0.05s]
[0m12:33:00.421033 [debug] [Thread-1 (]: Finished running node model.dbtvault.flights
[0m12:33:00.421256 [debug] [Thread-1 (]: Began running node model.dbtvault.seats
[0m12:33:00.421808 [info ] [Thread-1 (]: 6 of 36 START sql table model dwh_detailed.seats ............................... [RUN]
[0m12:33:00.422601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.flights, now model.dbtvault.seats)
[0m12:33:00.422825 [debug] [Thread-1 (]: Began compiling node model.dbtvault.seats
[0m12:33:00.424713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.seats"
[0m12:33:00.425032 [debug] [Thread-1 (]: Began executing node model.dbtvault.seats
[0m12:33:00.457509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.seats"
[0m12:33:00.457951 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:33:00.458151 [debug] [Thread-1 (]: On model.dbtvault.seats: BEGIN
[0m12:33:00.458307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.462422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.462676 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:33:00.462850 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */

  
    

  create  table "postgres"."dwh_detailed"."seats__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_seats"
  );
  
[0m12:33:00.481510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:33:00.484056 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:33:00.484309 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats" rename to "seats__dbt_backup"
[0m12:33:00.485610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.487898 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:33:00.488097 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats__dbt_tmp" rename to "seats"
[0m12:33:00.488966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.489854 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:33:00.490052 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:33:00.490213 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:33:00.494245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:33:00.495854 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."seats__dbt_backup"
[0m12:33:00.496247 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:33:00.496430 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
drop table if exists "postgres"."dwh_detailed"."seats__dbt_backup" cascade
[0m12:33:00.500838 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:33:00.501635 [debug] [Thread-1 (]: On model.dbtvault.seats: Close
[0m12:33:00.502151 [info ] [Thread-1 (]: 6 of 36 OK created sql table model dwh_detailed.seats .......................... [[32mSELECT 1[0m in 0.08s]
[0m12:33:00.502504 [debug] [Thread-1 (]: Finished running node model.dbtvault.seats
[0m12:33:00.502728 [debug] [Thread-1 (]: Began running node model.dbtvault.ticket_flights
[0m12:33:00.503301 [info ] [Thread-1 (]: 7 of 36 START sql table model dwh_detailed.ticket_flights ...................... [RUN]
[0m12:33:00.504005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.seats, now model.dbtvault.ticket_flights)
[0m12:33:00.504232 [debug] [Thread-1 (]: Began compiling node model.dbtvault.ticket_flights
[0m12:33:00.506070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.ticket_flights"
[0m12:33:00.506394 [debug] [Thread-1 (]: Began executing node model.dbtvault.ticket_flights
[0m12:33:00.509444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.ticket_flights"
[0m12:33:00.509757 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:33:00.509940 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: BEGIN
[0m12:33:00.510092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.514344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.514605 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:33:00.514775 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */

  
    

  create  table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_ticket_flights"
  );
  
[0m12:33:00.532156 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:33:00.534631 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:33:00.534878 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights" rename to "ticket_flights__dbt_backup"
[0m12:33:00.536237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.538750 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:33:00.538965 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp" rename to "ticket_flights"
[0m12:33:00.539861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.540781 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:33:00.540986 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:33:00.541142 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:33:00.544019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.545661 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."ticket_flights__dbt_backup"
[0m12:33:00.546109 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:33:00.546295 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
drop table if exists "postgres"."dwh_detailed"."ticket_flights__dbt_backup" cascade
[0m12:33:00.551448 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:33:00.552375 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: Close
[0m12:33:00.552924 [info ] [Thread-1 (]: 7 of 36 OK created sql table model dwh_detailed.ticket_flights ................. [[32mSELECT 1[0m in 0.05s]
[0m12:33:00.553274 [debug] [Thread-1 (]: Finished running node model.dbtvault.ticket_flights
[0m12:33:00.553489 [debug] [Thread-1 (]: Began running node model.dbtvault.tickets
[0m12:33:00.553749 [info ] [Thread-1 (]: 8 of 36 START sql table model dwh_detailed.tickets ............................. [RUN]
[0m12:33:00.554031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.ticket_flights, now model.dbtvault.tickets)
[0m12:33:00.554426 [debug] [Thread-1 (]: Began compiling node model.dbtvault.tickets
[0m12:33:00.557054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.tickets"
[0m12:33:00.557521 [debug] [Thread-1 (]: Began executing node model.dbtvault.tickets
[0m12:33:00.559870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.tickets"
[0m12:33:00.560187 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:33:00.560369 [debug] [Thread-1 (]: On model.dbtvault.tickets: BEGIN
[0m12:33:00.560535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.564456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.564737 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:33:00.564915 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */

  
    

  create  table "postgres"."dwh_detailed"."tickets__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_tickets"
  );
  
[0m12:33:00.582837 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:33:00.585357 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:33:00.585603 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets" rename to "tickets__dbt_backup"
[0m12:33:00.586910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.589159 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:33:00.589358 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets__dbt_tmp" rename to "tickets"
[0m12:33:00.590274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.591213 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:33:00.591411 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:33:00.591587 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:33:00.594922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.598591 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."tickets__dbt_backup"
[0m12:33:00.599033 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:33:00.599214 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
drop table if exists "postgres"."dwh_detailed"."tickets__dbt_backup" cascade
[0m12:33:00.606809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:33:00.607828 [debug] [Thread-1 (]: On model.dbtvault.tickets: Close
[0m12:33:00.608405 [info ] [Thread-1 (]: 8 of 36 OK created sql table model dwh_detailed.tickets ........................ [[32mSELECT 1[0m in 0.05s]
[0m12:33:00.608757 [debug] [Thread-1 (]: Finished running node model.dbtvault.tickets
[0m12:33:00.608982 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_aircrafts
[0m12:33:00.609598 [info ] [Thread-1 (]: 9 of 36 START sql view model dwh_detailed.stg_aircrafts ........................ [RUN]
[0m12:33:00.610399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.tickets, now model.dbtvault.stg_aircrafts)
[0m12:33:00.610798 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_aircrafts
[0m12:33:00.632634 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:33:00.632932 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: BEGIN
[0m12:33:00.633104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.637511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.637777 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:33:00.637961 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.649322 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:33:00.678147 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:33:00.678456 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.685305 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m12:33:00.713690 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_aircrafts"
[0m12:33:00.714103 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_aircrafts
[0m12:33:00.723874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_aircrafts"
[0m12:33:00.724232 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:33:00.724436 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

  create view "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed"."aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS AIRCRAFT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRCRAFT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    AIRCRAFT_PK,
    AIRCRAFT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:00.732041 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:33:00.734715 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:33:00.734955 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
alter table "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m12:33:00.736732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:33:00.737594 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:33:00.737832 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:33:00.737991 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:33:00.740821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.742558 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup"
[0m12:33:00.744047 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:33:00.744256 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m12:33:00.745551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:00.746309 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: Close
[0m12:33:00.746817 [info ] [Thread-1 (]: 9 of 36 OK created sql view model dwh_detailed.stg_aircrafts ................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:33:00.747213 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_aircrafts
[0m12:33:00.747441 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_airports
[0m12:33:00.748032 [info ] [Thread-1 (]: 10 of 36 START sql view model dwh_detailed.stg_airports ........................ [RUN]
[0m12:33:00.748772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_aircrafts, now model.dbtvault.stg_airports)
[0m12:33:00.749017 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_airports
[0m12:33:00.753565 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:33:00.753782 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: BEGIN
[0m12:33:00.753943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.758099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.758349 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:33:00.758525 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.769683 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.011 seconds
[0m12:33:00.773506 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:33:00.773742 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.780003 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:33:00.784226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_airports"
[0m12:33:00.784591 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_airports
[0m12:33:00.787034 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_airports"
[0m12:33:00.787345 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:33:00.787549 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

  create view "postgres"."dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed"."airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    AIRPORT_PK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:00.794667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:33:00.796777 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:33:00.797001 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
alter table "postgres"."dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m12:33:00.798229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.799072 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:33:00.799274 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:33:00.799426 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:33:00.803169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:33:00.805226 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_airports__dbt_backup"
[0m12:33:00.805600 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:33:00.805771 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
drop view if exists "postgres"."dwh_detailed"."stg_airports__dbt_backup" cascade
[0m12:33:00.807240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:00.808003 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: Close
[0m12:33:00.808518 [info ] [Thread-1 (]: 10 of 36 OK created sql view model dwh_detailed.stg_airports ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:33:00.809193 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_airports
[0m12:33:00.809695 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_boarding_passes
[0m12:33:00.810526 [info ] [Thread-1 (]: 11 of 36 START sql view model dwh_detailed.stg_boarding_passes ................. [RUN]
[0m12:33:00.811000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_airports, now model.dbtvault.stg_boarding_passes)
[0m12:33:00.811223 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_boarding_passes
[0m12:33:00.815462 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:33:00.815712 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: BEGIN
[0m12:33:00.815877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.820122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.820364 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:33:00.820539 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.831545 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:33:00.834751 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:33:00.834979 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.841087 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:33:00.845551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_boarding_passes"
[0m12:33:00.845910 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_boarding_passes
[0m12:33:00.848332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_boarding_passes"
[0m12:33:00.848627 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:33:00.848849 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed"."boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS TICKET_FLIGHTS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOARDING_PASSES_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    TICKET_FLIGHTS_PK,
    BOARDING_PASSES_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:00.856147 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:33:00.858196 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:33:00.858414 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m12:33:00.859631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.860468 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:33:00.860669 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:33:00.860823 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:33:00.863598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.865147 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m12:33:00.865539 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:33:00.865718 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m12:33:00.867144 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:00.867935 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: Close
[0m12:33:00.868460 [info ] [Thread-1 (]: 11 of 36 OK created sql view model dwh_detailed.stg_boarding_passes ............ [[32mCREATE VIEW[0m in 0.06s]
[0m12:33:00.869127 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_boarding_passes
[0m12:33:00.869580 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_bookings
[0m12:33:00.870182 [info ] [Thread-1 (]: 12 of 36 START sql view model dwh_detailed.stg_bookings ........................ [RUN]
[0m12:33:00.870840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_boarding_passes, now model.dbtvault.stg_bookings)
[0m12:33:00.871047 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_bookings
[0m12:33:00.875850 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:33:00.876063 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: BEGIN
[0m12:33:00.876221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.880033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.880258 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:33:00.880434 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.891434 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:33:00.894626 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:33:00.894850 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.900844 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:33:00.903847 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_bookings"
[0m12:33:00.904177 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_bookings
[0m12:33:00.906489 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_bookings"
[0m12:33:00.906773 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:33:00.906991 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

  create view "postgres"."dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed"."bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS BOOK_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOOK_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    BOOK_PK,
    BOOK_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:00.914211 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:33:00.916643 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:33:00.916869 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
alter table "postgres"."dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m12:33:00.918047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.918894 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:33:00.919088 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:33:00.919247 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:33:00.922042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:00.923615 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_bookings__dbt_backup"
[0m12:33:00.923998 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:33:00.924168 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m12:33:00.925458 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:00.926189 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: Close
[0m12:33:00.926680 [info ] [Thread-1 (]: 12 of 36 OK created sql view model dwh_detailed.stg_bookings ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:33:00.927025 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_bookings
[0m12:33:00.927244 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_flights
[0m12:33:00.927803 [info ] [Thread-1 (]: 13 of 36 START sql view model dwh_detailed.stg_flights ......................... [RUN]
[0m12:33:00.928288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_bookings, now model.dbtvault.stg_flights)
[0m12:33:00.928491 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_flights
[0m12:33:00.932882 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:33:00.933111 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: BEGIN
[0m12:33:00.933353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:00.937295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:00.937531 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:33:00.937696 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.949004 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m12:33:00.952911 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:33:00.953144 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:00.959389 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:33:00.966589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_flights"
[0m12:33:00.966919 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_flights
[0m12:33:00.971048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_flights"
[0m12:33:00.971460 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:33:00.971705 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

  create view "postgres"."dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed"."flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS FLIGHT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS FLIGHT_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_AIRCRAFT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_ARRIVAL_AIRPORT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    FLIGHT_PK,
    FLIGHT_HASHDIFF,
    LINK_FLIGHT_AIRCRAFT_PK,
    LINK_FLIGHT_ARRIVAL_AIRPORT_PK,
    LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:00.981314 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:33:00.983542 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:33:00.983783 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
alter table "postgres"."dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m12:33:00.985167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:00.985984 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:33:00.986180 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:33:00.986363 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:33:00.989146 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.024506 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_flights__dbt_backup"
[0m12:33:01.024998 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:33:01.025185 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_flights__dbt_backup" cascade
[0m12:33:01.026972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:33:01.027844 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: Close
[0m12:33:01.028354 [info ] [Thread-1 (]: 13 of 36 OK created sql view model dwh_detailed.stg_flights .................... [[32mCREATE VIEW[0m in 0.10s]
[0m12:33:01.028920 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_flights
[0m12:33:01.029396 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_seats
[0m12:33:01.030094 [info ] [Thread-1 (]: 14 of 36 START sql view model dwh_detailed.stg_seats ........................... [RUN]
[0m12:33:01.030784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_flights, now model.dbtvault.stg_seats)
[0m12:33:01.030989 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_seats
[0m12:33:01.035262 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:33:01.035467 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: BEGIN
[0m12:33:01.035640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.039576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:01.039870 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:33:01.040039 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.051151 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:33:01.054249 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:33:01.054494 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.060613 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:33:01.065309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_seats"
[0m12:33:01.065658 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_seats
[0m12:33:01.068015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_seats"
[0m12:33:01.068323 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:33:01.068530 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

  create view "postgres"."dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed"."seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS SEAT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_SEAT_AIRCRAFT_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')), 'hex') AS SEAT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    SEAT_PK,
    LINK_SEAT_AIRCRAFT_PK,
    SEAT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:01.075497 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:33:01.077645 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:33:01.077874 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
alter table "postgres"."dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m12:33:01.079190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:01.080027 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:33:01.080223 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:33:01.080375 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:33:01.083704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.085240 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_seats__dbt_backup"
[0m12:33:01.085645 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:33:01.085826 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
drop view if exists "postgres"."dwh_detailed"."stg_seats__dbt_backup" cascade
[0m12:33:01.087099 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:01.087859 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: Close
[0m12:33:01.088361 [info ] [Thread-1 (]: 14 of 36 OK created sql view model dwh_detailed.stg_seats ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:33:01.089022 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_seats
[0m12:33:01.089452 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_ticket_flights
[0m12:33:01.089983 [info ] [Thread-1 (]: 15 of 36 START sql view model dwh_detailed.stg_ticket_flights .................. [RUN]
[0m12:33:01.090780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_seats, now model.dbtvault.stg_ticket_flights)
[0m12:33:01.091220 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_ticket_flights
[0m12:33:01.099729 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:33:01.100063 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: BEGIN
[0m12:33:01.100239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.104874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:33:01.105222 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:33:01.105403 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.117660 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.012 seconds
[0m12:33:01.121108 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:33:01.121373 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.127627 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:33:01.131324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_ticket_flights"
[0m12:33:01.131686 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_ticket_flights
[0m12:33:01.134819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_ticket_flights"
[0m12:33:01.135148 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:33:01.135368 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed"."ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKET_FLIGHTS_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    TICKET_FLIGHTS_HASHDIFF,
    LINK_TICKET_FLIGHTS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:01.142018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:33:01.144169 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:33:01.144389 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m12:33:01.145521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:01.146378 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:33:01.146578 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:33:01.146750 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:33:01.149372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:33:01.150923 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m12:33:01.151292 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:33:01.151471 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m12:33:01.152774 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:01.153615 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: Close
[0m12:33:01.154132 [info ] [Thread-1 (]: 15 of 36 OK created sql view model dwh_detailed.stg_ticket_flights ............. [[32mCREATE VIEW[0m in 0.06s]
[0m12:33:01.154450 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_ticket_flights
[0m12:33:01.154658 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_tickets
[0m12:33:01.155224 [info ] [Thread-1 (]: 16 of 36 START sql view model dwh_detailed.stg_tickets ......................... [RUN]
[0m12:33:01.156054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_ticket_flights, now model.dbtvault.stg_tickets)
[0m12:33:01.156292 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_tickets
[0m12:33:01.160563 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:33:01.160776 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: BEGIN
[0m12:33:01.160953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.164632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:01.164854 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:33:01.165022 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.176069 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m12:33:01.179968 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:33:01.180199 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.186444 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:33:01.191087 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_tickets"
[0m12:33:01.191437 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_tickets
[0m12:33:01.193872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_tickets"
[0m12:33:01.194197 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:33:01.194413 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

  create view "postgres"."dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed"."tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS TICKET_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_BOOKING_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKETHASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    TICKET_PK,
    LINK_TICKET_BOOKING_PK,
    TICKETHASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:33:01.202126 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:33:01.204448 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:33:01.204691 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
alter table "postgres"."dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m12:33:01.205831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:33:01.206650 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:33:01.206861 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:33:01.207022 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:33:01.209769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.211800 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_tickets__dbt_backup"
[0m12:33:01.212229 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:33:01.212470 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m12:33:01.213730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:33:01.214577 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: Close
[0m12:33:01.215075 [info ] [Thread-1 (]: 16 of 36 OK created sql view model dwh_detailed.stg_tickets .................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:33:01.215404 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_tickets
[0m12:33:01.215619 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_aircraft
[0m12:33:01.215884 [info ] [Thread-1 (]: 17 of 36 START sql incremental model dwh_detailed.hub_aircraft ................. [RUN]
[0m12:33:01.216429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_tickets, now model.dbtvault.hub_aircraft)
[0m12:33:01.216684 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_aircraft
[0m12:33:01.223678 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.hub_aircraft from 1 source(s)
[0m12:33:01.227026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_aircraft"
[0m12:33:01.227351 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_aircraft
[0m12:33:01.242896 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:33:01.243157 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

    
  
    

  create temporary table "hub_aircraft__dbt_tmp123301239534"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRCRAFT_PK) rr.AIRCRAFT_PK, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.AIRCRAFT_PK IS NOT NULL
    ORDER BY rr.AIRCRAFT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRCRAFT_PK, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_aircraft" AS d
    ON a.AIRCRAFT_PK = d.AIRCRAFT_PK
    WHERE d.AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.243356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.263224 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m12:33:01.266061 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:33:01.266345 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: BEGIN
[0m12:33:01.266859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.267060 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:33:01.267216 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft__dbt_tmp123301239534'
        
      order by ordinal_position

  
[0m12:33:01.275173 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:33:01.277519 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:33:01.277730 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.283388 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:33:01.287748 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:33:01.287997 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.293582 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:33:01.299710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_aircraft"
[0m12:33:01.300076 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:33:01.300266 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      insert into "postgres"."dwh_detailed"."hub_aircraft" ("aircraft_pk", "aircraft_code", "load_date", "record_source")
    (
        select "aircraft_pk", "aircraft_code", "load_date", "record_source"
        from "hub_aircraft__dbt_tmp123301239534"
    )


  
[0m12:33:01.302592 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:33:01.303463 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:33:01.303657 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:33:01.303832 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:33:01.306655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.307134 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: Close
[0m12:33:01.307637 [info ] [Thread-1 (]: 17 of 36 OK created sql incremental model dwh_detailed.hub_aircraft ............ [[32mINSERT 0 0[0m in 0.09s]
[0m12:33:01.307979 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_aircraft
[0m12:33:01.308192 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_aircraft_data
[0m12:33:01.308455 [info ] [Thread-1 (]: 18 of 36 START sql incremental model dwh_detailed.sat_aircraft_data ............ [RUN]
[0m12:33:01.309770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_aircraft, now model.dbtvault.sat_aircraft_data)
[0m12:33:01.310662 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_aircraft_data
[0m12:33:01.336259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_aircraft_data"
[0m12:33:01.336726 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_aircraft_data
[0m12:33:01.339522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_aircraft_data"
[0m12:33:01.339854 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:33:01.340032 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: BEGIN
[0m12:33:01.340184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.344147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:01.344378 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:33:01.344559 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_aircraft_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRCRAFT_PK, a.AIRCRAFT_HASHDIFF, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS a
    WHERE a.AIRCRAFT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.345512 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not identify an equality operator for type json
LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                              ^

[0m12:33:01.345727 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: ROLLBACK
[0m12:33:01.346214 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: Close
[0m12:33:01.347179 [debug] [Thread-1 (]: Database Error in model sat_aircraft_data (models/raw_vault/sats/sat_aircraft_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_aircraft_data.sql
[0m12:33:01.347630 [error] [Thread-1 (]: 18 of 36 ERROR creating sql incremental model dwh_detailed.sat_aircraft_data ... [[31mERROR[0m in 0.04s]
[0m12:33:01.347974 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_aircraft_data
[0m12:33:01.348189 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_airport
[0m12:33:01.348481 [debug] [Thread-4 (]: Marking all children of 'model.dbtvault.sat_aircraft_data' to be skipped because of status 'error'.  Reason: Database Error in model sat_aircraft_data (models/raw_vault/sats/sat_aircraft_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_aircraft_data.sql.
[0m12:33:01.348830 [info ] [Thread-1 (]: 19 of 36 START sql incremental model dwh_detailed.hub_airport .................. [RUN]
[0m12:33:01.349595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_aircraft_data, now model.dbtvault.hub_airport)
[0m12:33:01.349777 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_airport
[0m12:33:01.352614 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.hub_airport from 1 source(s)
[0m12:33:01.354872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_airport"
[0m12:33:01.355161 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_airport
[0m12:33:01.358410 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:33:01.358630 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

    
  
    

  create temporary table "hub_airport__dbt_tmp123301356687"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_PK) rr.AIRPORT_PK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS rr
    WHERE rr.AIRPORT_PK IS NOT NULL
    ORDER BY rr.AIRPORT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_PK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_airport" AS d
    ON a.AIRPORT_PK = d.AIRPORT_PK
    WHERE d.AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.358803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.377412 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m12:33:01.379847 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:33:01.380136 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: BEGIN
[0m12:33:01.380706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.380914 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:33:01.381074 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport__dbt_tmp123301356687'
        
      order by ordinal_position

  
[0m12:33:01.389163 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:33:01.391317 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:33:01.391548 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.397128 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:33:01.399256 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:33:01.399483 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.405223 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:33:01.406391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_airport"
[0m12:33:01.406818 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:33:01.407007 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      insert into "postgres"."dwh_detailed"."hub_airport" ("airport_pk", "airport_code", "load_date", "record_source")
    (
        select "airport_pk", "airport_code", "load_date", "record_source"
        from "hub_airport__dbt_tmp123301356687"
    )


  
[0m12:33:01.409086 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:33:01.409932 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:33:01.410156 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:33:01.410321 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:33:01.413279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.413757 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: Close
[0m12:33:01.414260 [info ] [Thread-1 (]: 19 of 36 OK created sql incremental model dwh_detailed.hub_airport ............. [[32mINSERT 0 0[0m in 0.06s]
[0m12:33:01.414584 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_airport
[0m12:33:01.414800 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_airports_data
[0m12:33:01.415072 [info ] [Thread-1 (]: 20 of 36 START sql incremental model dwh_detailed.sat_airports_data ............ [RUN]
[0m12:33:01.415455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_airport, now model.dbtvault.sat_airports_data)
[0m12:33:01.415676 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_airports_data
[0m12:33:01.424393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_airports_data"
[0m12:33:01.424816 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_airports_data
[0m12:33:01.427560 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:33:01.427918 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

    
  
    

  create temporary table "sat_airports_data__dbt_tmp123301426471"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS a
    WHERE a.AIRPORT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.AIRPORT_PK, current_records.AIRPORT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.AIRPORT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_airports_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.AIRPORT_PK
                FROM source_data
            ) AS source_records
                ON current_records.AIRPORT_PK = source_records.AIRPORT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRPORT_PK, stage.AIRPORT_HASHDIFF, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.AIRPORT_PK = stage.AIRPORT_PK
        AND latest_records.AIRPORT_HASHDIFF = stage.AIRPORT_HASHDIFF
    WHERE latest_records.AIRPORT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.428131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.470864 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m12:33:01.473165 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:33:01.473433 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: BEGIN
[0m12:33:01.474291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.474550 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:33:01.474728 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data__dbt_tmp123301426471'
        
      order by ordinal_position

  
[0m12:33:01.520708 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.046 seconds
[0m12:33:01.523311 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:33:01.523571 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.529523 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:33:01.532436 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:33:01.532679 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.538451 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:33:01.539772 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_airports_data"
[0m12:33:01.540114 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:33:01.540300 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      insert into "postgres"."dwh_detailed"."sat_airports_data" ("airport_pk", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_date", "record_source")
    (
        select "airport_pk", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_date", "record_source"
        from "sat_airports_data__dbt_tmp123301426471"
    )


  
[0m12:33:01.544072 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:33:01.544967 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:33:01.545181 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:33:01.545362 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:33:01.548311 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.548880 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: Close
[0m12:33:01.549416 [info ] [Thread-1 (]: 20 of 36 OK created sql incremental model dwh_detailed.sat_airports_data ....... [[32mINSERT 0 0[0m in 0.13s]
[0m12:33:01.549753 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_airports_data
[0m12:33:01.549986 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:33:01.550268 [info ] [Thread-1 (]: 21 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [RUN]
[0m12:33:01.550622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_airports_data, now model.dbtvault.sat_ticket_flights_boarding_passes)
[0m12:33:01.553467 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:33:01.562395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.562931 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:33:01.565730 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.565974 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

    
  
    

  create temporary table "sat_ticket_flights_boarding_passes__dbt_tmp123301564631"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.TICKET_FLIGHTS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.TICKET_FLIGHTS_PK, current_records.BOARDING_PASSES_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.TICKET_FLIGHTS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes" AS current_records
            JOIN (
                SELECT DISTINCT source_data.TICKET_FLIGHTS_PK
                FROM source_data
            ) AS source_records
                ON current_records.TICKET_FLIGHTS_PK = source_records.TICKET_FLIGHTS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_FLIGHTS_PK, stage.BOARDING_PASSES_HASHDIFF, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.TICKET_FLIGHTS_PK = stage.TICKET_FLIGHTS_PK
        AND latest_records.BOARDING_PASSES_HASHDIFF = stage.BOARDING_PASSES_HASHDIFF
    WHERE latest_records.BOARDING_PASSES_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.566169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.605878 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:33:01.608700 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.608984 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: BEGIN
[0m12:33:01.609519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.609728 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.609908 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes__dbt_tmp123301564631'
        
      order by ordinal_position

  
[0m12:33:01.672342 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.062 seconds
[0m12:33:01.674888 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.675133 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.680672 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:33:01.682846 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.683061 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.688567 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:33:01.689721 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.690060 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.690246 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      insert into "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes" ("ticket_flights_pk", "boarding_passes_hashdiff", "boarding_no", "seat_no", "effective_from", "load_date", "record_source")
    (
        select "ticket_flights_pk", "boarding_passes_hashdiff", "boarding_no", "seat_no", "effective_from", "load_date", "record_source"
        from "sat_ticket_flights_boarding_passes__dbt_tmp123301564631"
    )


  
[0m12:33:01.693966 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:33:01.694831 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:33:01.695037 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:33:01.695200 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:33:01.698249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.698753 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: Close
[0m12:33:01.699271 [info ] [Thread-1 (]: 21 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [[32mINSERT 0 0[0m in 0.15s]
[0m12:33:01.699665 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:33:01.699904 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_booking
[0m12:33:01.700179 [info ] [Thread-1 (]: 22 of 36 START sql incremental model dwh_detailed.hub_booking .................. [RUN]
[0m12:33:01.700490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_boarding_passes, now model.dbtvault.hub_booking)
[0m12:33:01.700757 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_booking
[0m12:33:01.703961 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.hub_booking from 1 source(s)
[0m12:33:01.705988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_booking"
[0m12:33:01.706450 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_booking
[0m12:33:01.709823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_booking"
[0m12:33:01.710162 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:33:01.710337 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: BEGIN
[0m12:33:01.710481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.714017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m12:33:01.714288 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:33:01.714462 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_booking"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS rr
    WHERE rr.BOOK_PK IS NOT NULL
    ORDER BY rr.BOOK_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.BOOK_PK, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.732087 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:33:01.733206 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:33:01.733444 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:33:01.733599 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:33:01.736112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:33:01.736620 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: Close
[0m12:33:01.737165 [info ] [Thread-1 (]: 22 of 36 OK created sql incremental model dwh_detailed.hub_booking ............. [[32mSELECT 1[0m in 0.04s]
[0m12:33:01.737495 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_booking
[0m12:33:01.737735 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_booking_data
[0m12:33:01.737994 [info ] [Thread-1 (]: 23 of 36 START sql incremental model dwh_detailed.sat_booking_data ............. [RUN]
[0m12:33:01.738274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_booking, now model.dbtvault.sat_booking_data)
[0m12:33:01.738502 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_booking_data
[0m12:33:01.746103 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_booking_data"
[0m12:33:01.746458 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_booking_data
[0m12:33:01.749225 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:33:01.749487 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

    
  
    

  create temporary table "sat_booking_data__dbt_tmp123301748080"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS a
    WHERE a.BOOK_PK IS NOT NULL
),

latest_records AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.BOOK_PK, current_records.BOOK_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.BOOK_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_booking_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.BOOK_PK
                FROM source_data
            ) AS source_records
                ON current_records.BOOK_PK = source_records.BOOK_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.BOOK_PK, stage.BOOK_HASHDIFF, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.BOOK_PK = stage.BOOK_PK
        AND latest_records.BOOK_HASHDIFF = stage.BOOK_HASHDIFF
    WHERE latest_records.BOOK_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.749679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.787934 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m12:33:01.790661 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:33:01.790962 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: BEGIN
[0m12:33:01.791701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.791995 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:33:01.792176 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data__dbt_tmp123301748080'
        
      order by ordinal_position

  
[0m12:33:01.853101 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.061 seconds
[0m12:33:01.855737 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:33:01.856018 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.861844 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:33:01.864026 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:33:01.864243 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.869874 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:33:01.871049 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_booking_data"
[0m12:33:01.871369 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:33:01.871550 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      insert into "postgres"."dwh_detailed"."sat_booking_data" ("book_pk", "book_hashdiff", "book_date", "total_amount", "effective_from", "load_date", "record_source")
    (
        select "book_pk", "book_hashdiff", "book_date", "total_amount", "effective_from", "load_date", "record_source"
        from "sat_booking_data__dbt_tmp123301748080"
    )


  
[0m12:33:01.875379 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:33:01.876266 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:33:01.876501 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:33:01.876661 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:33:01.879530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.879982 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: Close
[0m12:33:01.880500 [info ] [Thread-1 (]: 23 of 36 OK created sql incremental model dwh_detailed.sat_booking_data ........ [[32mINSERT 0 0[0m in 0.14s]
[0m12:33:01.880837 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_booking_data
[0m12:33:01.881059 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_flight
[0m12:33:01.881328 [info ] [Thread-1 (]: 24 of 36 START sql incremental model dwh_detailed.hub_flight ................... [RUN]
[0m12:33:01.881902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_booking_data, now model.dbtvault.hub_flight)
[0m12:33:01.882331 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_flight
[0m12:33:01.888889 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.hub_flight from 1 source(s)
[0m12:33:01.891264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_flight"
[0m12:33:01.891591 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_flight
[0m12:33:01.895002 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:33:01.895235 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

    
  
    

  create temporary table "hub_flight__dbt_tmp123301893847"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.FLIGHT_PK) rr.FLIGHT_PK, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.FLIGHT_PK IS NOT NULL
    ORDER BY rr.FLIGHT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.FLIGHT_PK, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_flight" AS d
    ON a.FLIGHT_PK = d.FLIGHT_PK
    WHERE d.FLIGHT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.895409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.912613 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m12:33:01.914819 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:33:01.915103 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: BEGIN
[0m12:33:01.915624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.915817 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:33:01.915979 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight__dbt_tmp123301893847'
        
      order by ordinal_position

  
[0m12:33:01.924387 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:33:01.926687 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:33:01.926953 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.933000 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:33:01.935337 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:33:01.935580 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.941330 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:33:01.942440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_flight"
[0m12:33:01.942768 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:33:01.942956 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      insert into "postgres"."dwh_detailed"."hub_flight" ("flight_pk", "flight_id", "load_date", "record_source")
    (
        select "flight_pk", "flight_id", "load_date", "record_source"
        from "hub_flight__dbt_tmp123301893847"
    )


  
[0m12:33:01.945045 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:33:01.945869 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:33:01.946078 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:33:01.946232 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:33:01.948905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:33:01.949363 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: Close
[0m12:33:01.949945 [info ] [Thread-1 (]: 24 of 36 OK created sql incremental model dwh_detailed.hub_flight .............. [[32mINSERT 0 0[0m in 0.07s]
[0m12:33:01.950313 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_flight
[0m12:33:01.950527 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_aircraft
[0m12:33:01.950777 [info ] [Thread-1 (]: 25 of 36 START sql incremental model dwh_detailed.link_flight_aircraft ......... [RUN]
[0m12:33:01.951059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_flight, now model.dbtvault.link_flight_aircraft)
[0m12:33:01.951254 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_aircraft
[0m12:33:01.992979 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.link_flight_aircraft from 1 source(s)
[0m12:33:02.002785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_aircraft"
[0m12:33:02.003133 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_aircraft
[0m12:33:02.005812 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:33:02.006029 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

    
  
    

  create temporary table "link_flight_aircraft__dbt_tmp123302004687"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_AIRCRAFT_PK, rr.flight_id, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_AIRCRAFT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_AIRCRAFT_PK, a.flight_id, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_aircraft" AS d
    ON a.LINK_FLIGHT_AIRCRAFT_PK = d.LINK_FLIGHT_AIRCRAFT_PK
    WHERE d.LINK_FLIGHT_AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:02.006213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:02.041296 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m12:33:02.043646 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:33:02.043913 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: BEGIN
[0m12:33:02.044586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:02.044831 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:33:02.044999 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft__dbt_tmp123302004687'
        
      order by ordinal_position

  
[0m12:33:02.103138 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.058 seconds
[0m12:33:02.105449 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:33:02.105676 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:02.112664 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m12:33:02.115300 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:33:02.115543 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:02.121180 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:02.122317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_aircraft"
[0m12:33:02.122691 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:33:02.122918 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      insert into "postgres"."dwh_detailed"."link_flight_aircraft" ("link_flight_aircraft_pk", "flight_id", "aircraft_code", "load_date", "record_source")
    (
        select "link_flight_aircraft_pk", "flight_id", "aircraft_code", "load_date", "record_source"
        from "link_flight_aircraft__dbt_tmp123302004687"
    )


  
[0m12:33:02.126603 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:02.127504 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:33:02.127700 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:33:02.127857 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:33:02.130475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:33:02.130945 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: Close
[0m12:33:02.131470 [info ] [Thread-1 (]: 25 of 36 OK created sql incremental model dwh_detailed.link_flight_aircraft .... [[32mINSERT 0 0[0m in 0.18s]
[0m12:33:02.131785 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_aircraft
[0m12:33:02.132001 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_arrival_airport
[0m12:33:02.132339 [info ] [Thread-1 (]: 26 of 36 START sql incremental model dwh_detailed.link_flight_arrival_airport .. [RUN]
[0m12:33:02.132619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_aircraft, now model.dbtvault.link_flight_arrival_airport)
[0m12:33:02.132800 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_arrival_airport
[0m12:33:02.137759 [info ] [Thread-1 (]: 12:33:02 + Loading postgres.dwh_detailed.link_flight_arrival_airport from 1 source(s)
[0m12:33:02.140266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.140606 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_arrival_airport
[0m12:33:02.143596 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.143883 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

    
  
    

  create temporary table "link_flight_arrival_airport__dbt_tmp123302142412"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, rr.flight_id, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, a.flight_id, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_arrival_airport" AS d
    ON a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK = d.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
    WHERE d.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:02.144065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:02.177761 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m12:33:02.180519 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.180783 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: BEGIN
[0m12:33:02.181348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:02.181612 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.181795 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport__dbt_tmp123302142412'
        
      order by ordinal_position

  
[0m12:33:02.217325 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.035 seconds
[0m12:33:02.219953 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.220245 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:02.226033 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:33:02.228150 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.228359 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:02.233918 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:02.235146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.235526 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.235712 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      insert into "postgres"."dwh_detailed"."link_flight_arrival_airport" ("link_flight_arrival_airport_pk", "flight_id", "arrival_airport", "load_date", "record_source")
    (
        select "link_flight_arrival_airport_pk", "flight_id", "arrival_airport", "load_date", "record_source"
        from "link_flight_arrival_airport__dbt_tmp123302142412"
    )


  
[0m12:33:02.239417 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:02.240277 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:33:02.240485 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:33:02.240642 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:33:02.243584 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:02.244050 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: Close
[0m12:33:02.244597 [info ] [Thread-1 (]: 26 of 36 OK created sql incremental model dwh_detailed.link_flight_arrival_airport  [[32mINSERT 0 0[0m in 0.11s]
[0m12:33:02.244966 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_arrival_airport
[0m12:33:02.245195 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_departure_airport
[0m12:33:02.245474 [info ] [Thread-1 (]: 27 of 36 START sql incremental model dwh_detailed.link_flight_departure_airport  [RUN]
[0m12:33:02.245837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_arrival_airport, now model.dbtvault.link_flight_departure_airport)
[0m12:33:02.246218 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_departure_airport
[0m12:33:02.250745 [info ] [Thread-1 (]: 12:33:02 + Loading postgres.dwh_detailed.link_flight_departure_airport from 1 source(s)
[0m12:33:02.253323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.253643 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_departure_airport
[0m12:33:02.257036 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.257271 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

    
  
    

  create temporary table "link_flight_departure_airport__dbt_tmp123302255883"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, rr.flight_id, rr.departure_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, a.flight_id, a.departure_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_departure_airport" AS d
    ON a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK = d.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
    WHERE d.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:02.257453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:02.291203 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m12:33:02.293442 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.293715 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: BEGIN
[0m12:33:02.294280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:02.294522 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.294698 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport__dbt_tmp123302255883'
        
      order by ordinal_position

  
[0m12:33:02.340331 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.045 seconds
[0m12:33:02.342797 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.343034 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:02.348637 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:02.350753 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.350976 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:02.356451 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:02.357573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.357902 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.358082 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      insert into "postgres"."dwh_detailed"."link_flight_departure_airport" ("link_flight_departure_airport_pk", "flight_id", "departure_airport", "load_date", "record_source")
    (
        select "link_flight_departure_airport_pk", "flight_id", "departure_airport", "load_date", "record_source"
        from "link_flight_departure_airport__dbt_tmp123302255883"
    )


  
[0m12:33:02.361643 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:02.362532 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:33:02.362737 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:33:02.362895 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:33:02.365677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:02.366165 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: Close
[0m12:33:02.366697 [info ] [Thread-1 (]: 27 of 36 OK created sql incremental model dwh_detailed.link_flight_departure_airport  [[32mINSERT 0 0[0m in 0.12s]
[0m12:33:02.367046 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_departure_airport
[0m12:33:02.367263 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_flight_data
[0m12:33:02.367545 [info ] [Thread-1 (]: 28 of 36 START sql incremental model dwh_detailed.sat_flight_data .............. [RUN]
[0m12:33:02.367941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_departure_airport, now model.dbtvault.sat_flight_data)
[0m12:33:02.368157 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_flight_data
[0m12:33:02.379903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_flight_data"
[0m12:33:02.380341 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_flight_data
[0m12:33:02.383197 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:33:02.383466 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

    
  
    

  create temporary table "sat_flight_data__dbt_tmp123302382052"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.status, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS a
    WHERE a.FLIGHT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.FLIGHT_PK, current_records.FLIGHT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.FLIGHT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_flight_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.FLIGHT_PK
                FROM source_data
            ) AS source_records
                ON current_records.FLIGHT_PK = source_records.FLIGHT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.FLIGHT_PK, stage.FLIGHT_HASHDIFF, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.status, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.FLIGHT_PK = stage.FLIGHT_PK
        AND latest_records.FLIGHT_HASHDIFF = stage.FLIGHT_HASHDIFF
    WHERE latest_records.FLIGHT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:02.383663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:02.423977 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:33:02.426292 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:33:02.426555 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: BEGIN
[0m12:33:02.427067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:02.427250 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:33:02.427416 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data__dbt_tmp123302382052'
        
      order by ordinal_position

  
[0m12:33:01.808778 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.065 seconds
[0m12:33:01.001089 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:33:01.001341 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.007150 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m12:33:01.009851 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:33:01.010075 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.015927 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m12:33:01.017252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_flight_data"
[0m12:33:01.017592 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:33:01.017791 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      insert into "postgres"."dwh_detailed"."sat_flight_data" ("flight_pk", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "status", "actual_departure", "actual_arrival", "effective_from", "load_date", "record_source")
    (
        select "flight_pk", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "status", "actual_departure", "actual_arrival", "effective_from", "load_date", "record_source"
        from "sat_flight_data__dbt_tmp123302382052"
    )


  
[0m12:33:01.021476 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:01.022352 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:33:01.022566 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:33:01.022726 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:33:01.025615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.026151 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: Close
[0m12:33:01.026675 [info ] [Thread-1 (]: 28 of 36 OK created sql incremental model dwh_detailed.sat_flight_data ......... [[32mINSERT 0 0[0m in -1.34s]
[0m12:33:01.026986 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_flight_data
[0m12:33:01.027204 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_seat
[0m12:33:01.027496 [info ] [Thread-1 (]: 29 of 36 START sql incremental model dwh_detailed.hub_seat ..................... [RUN]
[0m12:33:01.027800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_flight_data, now model.dbtvault.hub_seat)
[0m12:33:01.028949 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_seat
[0m12:33:01.034175 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.hub_seat from 1 source(s)
[0m12:33:01.036527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_seat"
[0m12:33:01.036975 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_seat
[0m12:33:01.039848 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:33:01.040064 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

    
  
    

  create temporary table "hub_seat__dbt_tmp123301038693"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.SEAT_PK) rr.SEAT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.SEAT_PK IS NOT NULL
    ORDER BY rr.SEAT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.SEAT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_seat" AS d
    ON a.SEAT_PK = d.SEAT_PK
    WHERE d.SEAT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.040247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.057873 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m12:33:01.060602 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:33:01.060871 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: BEGIN
[0m12:33:01.061441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.061674 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:33:01.061864 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat__dbt_tmp123301038693'
        
      order by ordinal_position

  
[0m12:33:01.070411 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m12:33:01.072540 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:33:01.072755 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.078407 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:01.080429 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:33:01.080727 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.086336 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:01.087502 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_seat"
[0m12:33:01.087871 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:33:01.088075 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      insert into "postgres"."dwh_detailed"."hub_seat" ("seat_pk", "aircraft_code", "seat_no", "load_date", "record_source")
    (
        select "seat_pk", "aircraft_code", "seat_no", "load_date", "record_source"
        from "hub_seat__dbt_tmp123301038693"
    )


  
[0m12:33:01.090216 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:33:01.091019 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:33:01.091226 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:33:01.091381 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:33:01.094630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.095086 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: Close
[0m12:33:01.095599 [info ] [Thread-1 (]: 29 of 36 OK created sql incremental model dwh_detailed.hub_seat ................ [[32mINSERT 0 0[0m in 0.07s]
[0m12:33:01.095927 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_seat
[0m12:33:01.096142 [debug] [Thread-1 (]: Began running node model.dbtvault.link_seat_aircraft
[0m12:33:01.096483 [info ] [Thread-1 (]: 30 of 36 START sql incremental model dwh_detailed.link_seat_aircraft ........... [RUN]
[0m12:33:01.097011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_seat, now model.dbtvault.link_seat_aircraft)
[0m12:33:01.097408 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_seat_aircraft
[0m12:33:01.100714 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.link_seat_aircraft from 1 source(s)
[0m12:33:01.103090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_seat_aircraft"
[0m12:33:01.103395 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_seat_aircraft
[0m12:33:01.106701 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:33:01.106968 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

    
  
    

  create temporary table "link_seat_aircraft__dbt_tmp123301105604"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_SEAT_AIRCRAFT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SEAT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.LINK_SEAT_AIRCRAFT_PK IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SEAT_AIRCRAFT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_seat_aircraft" AS d
    ON a.LINK_SEAT_AIRCRAFT_PK = d.LINK_SEAT_AIRCRAFT_PK
    WHERE d.LINK_SEAT_AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.107158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.137451 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.030 seconds
[0m12:33:01.139725 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:33:01.139985 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: BEGIN
[0m12:33:01.140595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.140848 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:33:01.141020 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft__dbt_tmp123301105604'
        
      order by ordinal_position

  
[0m12:33:01.207443 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.066 seconds
[0m12:33:01.209856 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:33:01.210139 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.215938 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:33:01.218295 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:33:01.218548 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.224260 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:01.225462 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_seat_aircraft"
[0m12:33:01.225794 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:33:01.225970 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      insert into "postgres"."dwh_detailed"."link_seat_aircraft" ("link_seat_aircraft_pk", "aircraft_code", "seat_no", "load_date", "record_source")
    (
        select "link_seat_aircraft_pk", "aircraft_code", "seat_no", "load_date", "record_source"
        from "link_seat_aircraft__dbt_tmp123301105604"
    )


  
[0m12:33:01.229582 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:01.230565 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:33:01.230776 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:33:01.230960 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:33:01.233897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.234409 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: Close
[0m12:33:01.234918 [info ] [Thread-1 (]: 30 of 36 OK created sql incremental model dwh_detailed.link_seat_aircraft ...... [[32mINSERT 0 0[0m in 0.14s]
[0m12:33:01.235253 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_seat_aircraft
[0m12:33:01.235464 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_seat_data
[0m12:33:01.235789 [info ] [Thread-1 (]: 31 of 36 START sql incremental model dwh_detailed.sat_seat_data ................ [RUN]
[0m12:33:01.236038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_seat_aircraft, now model.dbtvault.sat_seat_data)
[0m12:33:01.236229 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_seat_data
[0m12:33:01.246030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_seat_data"
[0m12:33:01.246439 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_seat_data
[0m12:33:01.249284 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:33:01.249533 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

    
  
    

  create temporary table "sat_seat_data__dbt_tmp123301248135"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS a
    WHERE a.SEAT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SEAT_PK, current_records.SEAT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SEAT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_seat_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.SEAT_PK
                FROM source_data
            ) AS source_records
                ON current_records.SEAT_PK = source_records.SEAT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SEAT_PK, stage.SEAT_HASHDIFF, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SEAT_PK = stage.SEAT_PK
        AND latest_records.SEAT_HASHDIFF = stage.SEAT_HASHDIFF
    WHERE latest_records.SEAT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.249717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.286317 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m12:33:01.288644 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:33:01.288910 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: BEGIN
[0m12:33:01.289485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.289710 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:33:01.289873 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data__dbt_tmp123301248135'
        
      order by ordinal_position

  
[0m12:33:01.344265 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.054 seconds
[0m12:33:01.346587 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:33:01.346838 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.353647 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m12:33:01.356672 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:33:01.357042 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.363217 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:33:01.364552 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_seat_data"
[0m12:33:01.364961 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:33:01.365157 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      insert into "postgres"."dwh_detailed"."sat_seat_data" ("seat_pk", "seat_hashdiff", "fare_conditions", "effective_from", "load_date", "record_source")
    (
        select "seat_pk", "seat_hashdiff", "fare_conditions", "effective_from", "load_date", "record_source"
        from "sat_seat_data__dbt_tmp123301248135"
    )


  
[0m12:33:01.368716 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:01.369659 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:33:01.369869 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:33:01.370027 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:33:01.372730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:33:01.373250 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: Close
[0m12:33:01.373779 [info ] [Thread-1 (]: 31 of 36 OK created sql incremental model dwh_detailed.sat_seat_data ........... [[32mINSERT 0 0[0m in 0.14s]
[0m12:33:01.374116 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_seat_data
[0m12:33:01.374329 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_flights
[0m12:33:01.374716 [info ] [Thread-1 (]: 32 of 36 START sql incremental model dwh_detailed.link_ticket_flights .......... [RUN]
[0m12:33:01.377277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_seat_data, now model.dbtvault.link_ticket_flights)
[0m12:33:01.377820 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_flights
[0m12:33:01.380759 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.link_ticket_flights from 1 source(s)
[0m12:33:01.383134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_flights"
[0m12:33:01.383460 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_flights
[0m12:33:01.386263 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:33:01.386495 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp123301385134"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_FLIGHTS_PK, rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_FLIGHTS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.LINK_TICKET_FLIGHTS_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_ticket_flights" AS d
    ON a.LINK_TICKET_FLIGHTS_PK = d.LINK_TICKET_FLIGHTS_PK
    WHERE d.LINK_TICKET_FLIGHTS_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.386672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.417560 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m12:33:01.420285 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:33:01.420545 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: BEGIN
[0m12:33:01.421115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.421363 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:33:01.421534 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp123301385134'
        
      order by ordinal_position

  
[0m12:33:01.475633 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.054 seconds
[0m12:33:01.478212 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:33:01.478455 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.484355 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:33:01.486492 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:33:01.486719 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.492372 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:01.493498 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_flights"
[0m12:33:01.493846 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:33:01.494029 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed"."link_ticket_flights" ("link_ticket_flights_pk", "ticket_no", "flight_id", "load_date", "record_source")
    (
        select "link_ticket_flights_pk", "ticket_no", "flight_id", "load_date", "record_source"
        from "link_ticket_flights__dbt_tmp123301385134"
    )


  
[0m12:33:01.497845 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:01.498792 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:33:01.499094 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:33:01.499259 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:33:01.502214 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.502697 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: Close
[0m12:33:01.503247 [info ] [Thread-1 (]: 32 of 36 OK created sql incremental model dwh_detailed.link_ticket_flights ..... [[32mINSERT 0 0[0m in 0.13s]
[0m12:33:01.503564 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_flights
[0m12:33:01.503770 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_data
[0m12:33:01.504123 [info ] [Thread-1 (]: 33 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_data ...... [RUN]
[0m12:33:01.504527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_flights, now model.dbtvault.sat_ticket_flights_data)
[0m12:33:01.504722 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_data
[0m12:33:01.515863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.516264 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_data
[0m12:33:01.519012 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.519268 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

    
  
    

  create temporary table "sat_ticket_flights_data__dbt_tmp123301517863"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.LINK_TICKET_FLIGHTS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINK_TICKET_FLIGHTS_PK, current_records.TICKET_FLIGHTS_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.LINK_TICKET_FLIGHTS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_ticket_flights_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINK_TICKET_FLIGHTS_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINK_TICKET_FLIGHTS_PK = source_records.LINK_TICKET_FLIGHTS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_PK, stage.TICKET_FLIGHTS_HASHDIFF, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.LINK_TICKET_FLIGHTS_PK = stage.LINK_TICKET_FLIGHTS_PK
        AND latest_records.TICKET_FLIGHTS_HASHDIFF = stage.TICKET_FLIGHTS_HASHDIFF
    WHERE latest_records.TICKET_FLIGHTS_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.519467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.556032 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m12:33:01.558387 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.558629 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: BEGIN
[0m12:33:01.559169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.559409 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.559574 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data__dbt_tmp123301517863'
        
      order by ordinal_position

  
[0m12:33:01.616084 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.056 seconds
[0m12:33:01.618557 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.618782 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.624818 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:33:01.626912 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.627115 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.632762 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:33:01.633857 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.634209 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.634391 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      insert into "postgres"."dwh_detailed"."sat_ticket_flights_data" ("link_ticket_flights_pk", "ticket_flights_hashdiff", "fare_conditions", "amount", "effective_from", "load_date", "record_source")
    (
        select "link_ticket_flights_pk", "ticket_flights_hashdiff", "fare_conditions", "amount", "effective_from", "load_date", "record_source"
        from "sat_ticket_flights_data__dbt_tmp123301517863"
    )


  
[0m12:33:01.638495 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:33:01.639306 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:33:01.639515 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:33:01.639676 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:33:01.642595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.643058 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: Close
[0m12:33:01.643602 [info ] [Thread-1 (]: 33 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_data . [[32mINSERT 0 0[0m in 0.14s]
[0m12:33:01.643920 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_data
[0m12:33:01.644131 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_ticket
[0m12:33:01.644468 [info ] [Thread-1 (]: 34 of 36 START sql incremental model dwh_detailed.hub_ticket ................... [RUN]
[0m12:33:01.644737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_data, now model.dbtvault.hub_ticket)
[0m12:33:01.644916 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_ticket
[0m12:33:01.653481 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.hub_ticket from 1 source(s)
[0m12:33:01.655521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_ticket"
[0m12:33:01.655837 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_ticket
[0m12:33:01.658612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_ticket"
[0m12:33:01.658949 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:33:01.659126 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: BEGIN
[0m12:33:01.659287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.662861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:01.663109 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:33:01.663292 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_ticket"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.TICKET_PK IS NOT NULL
    ORDER BY rr.TICKET_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.TICKET_PK, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.680386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:33:01.681491 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:33:01.681737 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:33:01.681914 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:33:01.684637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.685215 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: Close
[0m12:33:01.685723 [info ] [Thread-1 (]: 34 of 36 OK created sql incremental model dwh_detailed.hub_ticket .............. [[32mSELECT 1[0m in 0.04s]
[0m12:33:01.686125 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_ticket
[0m12:33:01.686359 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_booking
[0m12:33:01.686634 [info ] [Thread-1 (]: 35 of 36 START sql incremental model dwh_detailed.link_ticket_booking .......... [RUN]
[0m12:33:01.686965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_ticket, now model.dbtvault.link_ticket_booking)
[0m12:33:01.687235 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_booking
[0m12:33:01.690354 [info ] [Thread-1 (]: 12:33:01 + Loading postgres.dwh_detailed.link_ticket_booking from 1 source(s)
[0m12:33:01.692953 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_booking"
[0m12:33:01.693298 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_booking
[0m12:33:01.696559 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:33:01.696783 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

    
  
    

  create temporary table "link_ticket_booking__dbt_tmp123301695408"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_BOOKING_PK, rr.ticket_no, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_BOOKING_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.LINK_TICKET_BOOKING_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_BOOKING_PK, a.ticket_no, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_ticket_booking" AS d
    ON a.LINK_TICKET_BOOKING_PK = d.LINK_TICKET_BOOKING_PK
    WHERE d.LINK_TICKET_BOOKING_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.696974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.727670 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m12:33:01.729912 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:33:01.730174 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: BEGIN
[0m12:33:01.730746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:33:01.730954 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:33:01.731124 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking__dbt_tmp123301695408'
        
      order by ordinal_position

  
[0m12:33:01.797602 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.066 seconds
[0m12:33:01.799931 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:33:01.800181 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.805881 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:01.807953 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:33:01.808180 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:33:01.813912 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:33:01.815044 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_booking"
[0m12:33:01.815369 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:33:01.815567 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      insert into "postgres"."dwh_detailed"."link_ticket_booking" ("link_ticket_booking_pk", "ticket_no", "book_ref", "load_date", "record_source")
    (
        select "link_ticket_booking_pk", "ticket_no", "book_ref", "load_date", "record_source"
        from "link_ticket_booking__dbt_tmp123301695408"
    )


  
[0m12:33:01.819145 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:33:01.820078 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:33:01.820283 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:33:01.820438 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:33:01.823196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:33:01.823692 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: Close
[0m12:33:01.824210 [info ] [Thread-1 (]: 35 of 36 OK created sql incremental model dwh_detailed.link_ticket_booking ..... [[32mINSERT 0 0[0m in 0.14s]
[0m12:33:01.824545 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_booking
[0m12:33:01.824766 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_data
[0m12:33:01.825021 [info ] [Thread-1 (]: 36 of 36 START sql incremental model dwh_detailed.sat_ticket_data .............. [RUN]
[0m12:33:01.825587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_booking, now model.dbtvault.sat_ticket_data)
[0m12:33:01.826244 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_data
[0m12:33:01.835740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_data"
[0m12:33:01.836145 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_data
[0m12:33:01.838862 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_data"
[0m12:33:01.839186 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:33:01.839396 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: BEGIN
[0m12:33:01.839541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:01.843520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:33:01.843813 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:33:01.843988 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_PK, a.TICKETHASHDIFF, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS a
    WHERE a.TICKET_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_PK, stage.TICKETHASHDIFF, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:33:01.845054 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not identify an equality operator for type json
LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                              ^

[0m12:33:01.845310 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: ROLLBACK
[0m12:33:01.845813 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: Close
[0m12:33:01.846369 [debug] [Thread-1 (]: Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql
[0m12:33:01.846821 [error] [Thread-1 (]: 36 of 36 ERROR creating sql incremental model dwh_detailed.sat_ticket_data ..... [[31mERROR[0m in 0.02s]
[0m12:33:01.847152 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_data
[0m12:33:01.847479 [debug] [Thread-4 (]: Marking all children of 'model.dbtvault.sat_ticket_data' to be skipped because of status 'error'.  Reason: Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql.
[0m12:33:01.848368 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:01.848539 [debug] [MainThread]: On master: BEGIN
[0m12:33:01.848684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:01.852087 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:33:01.852277 [debug] [MainThread]: On master: COMMIT
[0m12:33:01.852427 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:01.852557 [debug] [MainThread]: On master: COMMIT
[0m12:33:01.852906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:33:01.853118 [debug] [MainThread]: On master: Close
[0m12:33:01.853360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:01.853502 [debug] [MainThread]: Connection 'model.dbtvault.sat_ticket_data' was properly closed.
[0m12:33:01.853742 [info ] [MainThread]: 
[0m12:33:01.853941 [info ] [MainThread]: Finished running 20 incremental models, 8 table models, 8 view models in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m12:33:01.856488 [debug] [MainThread]: Command end result
[0m12:33:01.912574 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:33:01.913622 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:33:01.917886 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/user/dwh/dbt/target/run_results.json
[0m12:33:01.918087 [info ] [MainThread]: 
[0m12:33:01.918310 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:33:01.918489 [info ] [MainThread]: 
[0m12:33:01.918694 [error] [MainThread]:   Database Error in model sat_aircraft_data (models/raw_vault/sats/sat_aircraft_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...TINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.mode...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_aircraft_data.sql
[0m12:33:01.918873 [info ] [MainThread]: 
[0m12:33:01.919055 [error] [MainThread]:   Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql
[0m12:33:01.919232 [info ] [MainThread]: 
[0m12:33:01.919412 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=2 SKIP=0 TOTAL=36
[0m12:33:01.919929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9291954, "process_in_blocks": "0", "process_kernel_time": 0.082629, "process_mem_max_rss": "119560", "process_out_blocks": "7408", "process_user_time": 2.295262}
[0m12:33:01.920154 [debug] [MainThread]: Command `dbt run` failed at 12:33:01.920104 after 3.93 seconds
[0m12:33:01.920345 [debug] [MainThread]: Flushing usage events


============================== 12:42:47.420735 | 3b7247d2-9391-41b6-a18f-0e458ac679f5 ==============================
[0m12:42:47.420735 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:42:47.423301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/user/dwh/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m12:42:47.423617 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:42:47.589062 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:47.633361 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:42:47.767546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:47.768089 [debug] [MainThread]: Partial parsing: updated file: dbtvault://models/raw_stage/aircrafts.sql
[0m12:42:47.912415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m12:42:47.998634 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:42:48.000808 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:42:48.014847 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m12:42:48.016489 [info ] [MainThread]: 
[0m12:42:48.016720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:48.016884 [info ] [MainThread]: 
[0m12:42:48.017180 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:42:48.020590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:42:48.036960 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:42:48.037227 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:42:48.037376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:48.047236 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m12:42:48.048143 [debug] [ThreadPool]: On list_postgres: Close
[0m12:42:48.050279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed)
[0m12:42:48.054021 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:42:48.054354 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m12:42:48.054517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:48.060020 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:42:48.060276 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:42:48.060431 [debug] [ThreadPool]: On list_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed'
  
[0m12:42:48.065625 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.005 seconds
[0m12:42:48.066776 [debug] [ThreadPool]: On list_postgres_dwh_detailed: ROLLBACK
[0m12:42:48.067539 [debug] [ThreadPool]: On list_postgres_dwh_detailed: Close
[0m12:42:48.073983 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:48.074182 [debug] [MainThread]: On master: BEGIN
[0m12:42:48.074337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:48.078471 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.078770 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:48.078961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:42:48.087456 [debug] [MainThread]: SQL status: SELECT 61 in 0.008 seconds
[0m12:42:48.089613 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:48.090203 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:48.090411 [debug] [MainThread]: On master: BEGIN
[0m12:42:48.091272 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:42:48.091523 [debug] [MainThread]: On master: COMMIT
[0m12:42:48.091675 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:48.091821 [debug] [MainThread]: On master: COMMIT
[0m12:42:48.092272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:48.092462 [debug] [MainThread]: On master: Close
[0m12:42:48.093706 [debug] [Thread-1 (]: Began running node model.dbtvault.aircrafts
[0m12:42:48.094020 [info ] [Thread-1 (]: 1 of 36 START sql table model dwh_detailed.aircrafts ........................... [RUN]
[0m12:42:48.094306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed, now model.dbtvault.aircrafts)
[0m12:42:48.094513 [debug] [Thread-1 (]: Began compiling node model.dbtvault.aircrafts
[0m12:42:48.099641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.aircrafts"
[0m12:42:48.100493 [debug] [Thread-1 (]: Began executing node model.dbtvault.aircrafts
[0m12:42:48.121711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.aircrafts"
[0m12:42:48.122221 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:42:48.122416 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: BEGIN
[0m12:42:48.122576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.126730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.127002 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:42:48.127176 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */

  
    

  create  table "postgres"."dwh_detailed"."aircrafts__dbt_tmp"
  
  
    as
  
  (
    SELECT aircraft_code, model::jsonb as model, range
FROM "postgres"."public"."postgres_public_aircrafts"
  );
  
[0m12:42:48.154564 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m12:42:48.159007 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:42:48.159266 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts" rename to "aircrafts__dbt_backup"
[0m12:42:48.161164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:42:48.163408 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:42:48.163649 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts__dbt_tmp" rename to "aircrafts"
[0m12:42:48.164675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.175916 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:42:48.176181 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:42:48.176355 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:42:48.180594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:42:48.184552 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."aircrafts__dbt_backup"
[0m12:42:48.186970 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:42:48.187186 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
drop table if exists "postgres"."dwh_detailed"."aircrafts__dbt_backup" cascade
[0m12:42:48.193420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:42:48.195168 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: Close
[0m12:42:48.198257 [info ] [Thread-1 (]: 1 of 36 OK created sql table model dwh_detailed.aircrafts ...................... [[32mSELECT 1[0m in 0.10s]
[0m12:42:48.198984 [debug] [Thread-1 (]: Finished running node model.dbtvault.aircrafts
[0m12:42:48.199288 [debug] [Thread-1 (]: Began running node model.dbtvault.airports
[0m12:42:48.199679 [info ] [Thread-1 (]: 2 of 36 START sql table model dwh_detailed.airports ............................ [RUN]
[0m12:42:48.200179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.aircrafts, now model.dbtvault.airports)
[0m12:42:48.200383 [debug] [Thread-1 (]: Began compiling node model.dbtvault.airports
[0m12:42:48.202368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.airports"
[0m12:42:48.202690 [debug] [Thread-1 (]: Began executing node model.dbtvault.airports
[0m12:42:48.205177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.airports"
[0m12:42:48.205532 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:42:48.205717 [debug] [Thread-1 (]: On model.dbtvault.airports: BEGIN
[0m12:42:48.205892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.209936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.210186 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:42:48.210364 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */

  
    

  create  table "postgres"."dwh_detailed"."airports__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_airports"
  );
  
[0m12:42:48.228370 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m12:42:48.231447 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:42:48.231684 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports" rename to "airports__dbt_backup"
[0m12:42:48.233433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.235905 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:42:48.236135 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports__dbt_tmp" rename to "airports"
[0m12:42:48.237263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.238268 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:42:48.238470 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:42:48.238624 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:42:48.242062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.243773 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."airports__dbt_backup"
[0m12:42:48.244227 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:42:48.244410 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
drop table if exists "postgres"."dwh_detailed"."airports__dbt_backup" cascade
[0m12:42:48.250175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:42:48.251152 [debug] [Thread-1 (]: On model.dbtvault.airports: Close
[0m12:42:48.251724 [info ] [Thread-1 (]: 2 of 36 OK created sql table model dwh_detailed.airports ....................... [[32mSELECT 2[0m in 0.05s]
[0m12:42:48.252098 [debug] [Thread-1 (]: Finished running node model.dbtvault.airports
[0m12:42:48.252316 [debug] [Thread-1 (]: Began running node model.dbtvault.boarding_passes
[0m12:42:48.252623 [info ] [Thread-1 (]: 3 of 36 START sql table model dwh_detailed.boarding_passes ..................... [RUN]
[0m12:42:48.253161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.airports, now model.dbtvault.boarding_passes)
[0m12:42:48.253538 [debug] [Thread-1 (]: Began compiling node model.dbtvault.boarding_passes
[0m12:42:48.255576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.boarding_passes"
[0m12:42:48.255877 [debug] [Thread-1 (]: Began executing node model.dbtvault.boarding_passes
[0m12:42:48.258643 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.boarding_passes"
[0m12:42:48.258964 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:42:48.259138 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: BEGIN
[0m12:42:48.259284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.263700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.263967 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:42:48.264138 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */

  
    

  create  table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_boarding_passes"
  );
  
[0m12:42:48.281199 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:42:48.284296 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:42:48.284546 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes" rename to "boarding_passes__dbt_backup"
[0m12:42:48.285871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.288326 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:42:48.288538 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp" rename to "boarding_passes"
[0m12:42:48.289487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.290497 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:42:48.290701 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:42:48.290859 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:42:48.293839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.295559 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."boarding_passes__dbt_backup"
[0m12:42:48.295943 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:42:48.296122 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
drop table if exists "postgres"."dwh_detailed"."boarding_passes__dbt_backup" cascade
[0m12:42:48.301223 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:42:48.302126 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: Close
[0m12:42:48.302666 [info ] [Thread-1 (]: 3 of 36 OK created sql table model dwh_detailed.boarding_passes ................ [[32mSELECT 1[0m in 0.05s]
[0m12:42:48.303034 [debug] [Thread-1 (]: Finished running node model.dbtvault.boarding_passes
[0m12:42:48.303246 [debug] [Thread-1 (]: Began running node model.dbtvault.bookings
[0m12:42:48.303833 [info ] [Thread-1 (]: 4 of 36 START sql table model dwh_detailed.bookings ............................ [RUN]
[0m12:42:48.304276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.boarding_passes, now model.dbtvault.bookings)
[0m12:42:48.304499 [debug] [Thread-1 (]: Began compiling node model.dbtvault.bookings
[0m12:42:48.306506 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.bookings"
[0m12:42:48.306967 [debug] [Thread-1 (]: Began executing node model.dbtvault.bookings
[0m12:42:48.310091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.bookings"
[0m12:42:48.310425 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:42:48.310603 [debug] [Thread-1 (]: On model.dbtvault.bookings: BEGIN
[0m12:42:48.310754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.314536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.314774 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:42:48.314946 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */

  
    

  create  table "postgres"."dwh_detailed"."bookings__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_bookings"
  );
  
[0m12:42:48.332602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:42:48.335150 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:42:48.335387 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings" rename to "bookings__dbt_backup"
[0m12:42:48.336759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.339302 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:42:48.339542 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings__dbt_tmp" rename to "bookings"
[0m12:42:48.340577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.341490 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:42:48.341690 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:42:48.341856 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:42:48.345320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.347324 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."bookings__dbt_backup"
[0m12:42:48.347798 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:42:48.348029 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
drop table if exists "postgres"."dwh_detailed"."bookings__dbt_backup" cascade
[0m12:42:48.353396 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:42:48.354434 [debug] [Thread-1 (]: On model.dbtvault.bookings: Close
[0m12:42:48.354986 [info ] [Thread-1 (]: 4 of 36 OK created sql table model dwh_detailed.bookings ....................... [[32mSELECT 1[0m in 0.05s]
[0m12:42:48.355351 [debug] [Thread-1 (]: Finished running node model.dbtvault.bookings
[0m12:42:48.355574 [debug] [Thread-1 (]: Began running node model.dbtvault.flights
[0m12:42:48.355836 [info ] [Thread-1 (]: 5 of 36 START sql table model dwh_detailed.flights ............................. [RUN]
[0m12:42:48.356301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.bookings, now model.dbtvault.flights)
[0m12:42:48.357064 [debug] [Thread-1 (]: Began compiling node model.dbtvault.flights
[0m12:42:48.359093 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.flights"
[0m12:42:48.359434 [debug] [Thread-1 (]: Began executing node model.dbtvault.flights
[0m12:42:48.362499 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.flights"
[0m12:42:48.362840 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:42:48.363045 [debug] [Thread-1 (]: On model.dbtvault.flights: BEGIN
[0m12:42:48.363208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.367823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:42:48.368082 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:42:48.368248 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */

  
    

  create  table "postgres"."dwh_detailed"."flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_flights"
  );
  
[0m12:42:48.386744 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:42:48.389364 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:42:48.389603 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights" rename to "flights__dbt_backup"
[0m12:42:48.390894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.393291 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:42:48.393511 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights__dbt_tmp" rename to "flights"
[0m12:42:48.394478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.395373 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:42:48.395591 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:42:48.395745 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:42:48.399500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:42:48.401389 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."flights__dbt_backup"
[0m12:42:48.401805 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:42:48.401985 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
drop table if exists "postgres"."dwh_detailed"."flights__dbt_backup" cascade
[0m12:42:48.408672 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:42:48.409659 [debug] [Thread-1 (]: On model.dbtvault.flights: Close
[0m12:42:48.410272 [info ] [Thread-1 (]: 5 of 36 OK created sql table model dwh_detailed.flights ........................ [[32mSELECT 1[0m in 0.05s]
[0m12:42:48.410616 [debug] [Thread-1 (]: Finished running node model.dbtvault.flights
[0m12:42:48.410830 [debug] [Thread-1 (]: Began running node model.dbtvault.seats
[0m12:42:48.411090 [info ] [Thread-1 (]: 6 of 36 START sql table model dwh_detailed.seats ............................... [RUN]
[0m12:42:48.411646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.flights, now model.dbtvault.seats)
[0m12:42:48.411940 [debug] [Thread-1 (]: Began compiling node model.dbtvault.seats
[0m12:42:48.414515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.seats"
[0m12:42:48.415022 [debug] [Thread-1 (]: Began executing node model.dbtvault.seats
[0m12:42:48.419086 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.seats"
[0m12:42:48.419542 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:42:48.419757 [debug] [Thread-1 (]: On model.dbtvault.seats: BEGIN
[0m12:42:48.419922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.423833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.424106 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:42:48.424273 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */

  
    

  create  table "postgres"."dwh_detailed"."seats__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_seats"
  );
  
[0m12:42:48.440519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m12:42:48.443071 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:42:48.443314 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats" rename to "seats__dbt_backup"
[0m12:42:48.444571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.446617 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:42:48.446825 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats__dbt_tmp" rename to "seats"
[0m12:42:48.447783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.448771 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:42:48.448978 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:42:48.449132 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:42:48.452228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.454351 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."seats__dbt_backup"
[0m12:42:48.454759 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:42:48.454941 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
drop table if exists "postgres"."dwh_detailed"."seats__dbt_backup" cascade
[0m12:42:48.459488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:42:48.460304 [debug] [Thread-1 (]: On model.dbtvault.seats: Close
[0m12:42:48.460837 [info ] [Thread-1 (]: 6 of 36 OK created sql table model dwh_detailed.seats .......................... [[32mSELECT 1[0m in 0.05s]
[0m12:42:48.461169 [debug] [Thread-1 (]: Finished running node model.dbtvault.seats
[0m12:42:48.461383 [debug] [Thread-1 (]: Began running node model.dbtvault.ticket_flights
[0m12:42:48.461885 [info ] [Thread-1 (]: 7 of 36 START sql table model dwh_detailed.ticket_flights ...................... [RUN]
[0m12:42:48.462280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.seats, now model.dbtvault.ticket_flights)
[0m12:42:48.462672 [debug] [Thread-1 (]: Began compiling node model.dbtvault.ticket_flights
[0m12:42:48.464754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.ticket_flights"
[0m12:42:48.465074 [debug] [Thread-1 (]: Began executing node model.dbtvault.ticket_flights
[0m12:42:48.467477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.ticket_flights"
[0m12:42:48.467863 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:42:48.468085 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: BEGIN
[0m12:42:48.468234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.471958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.472212 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:42:48.472385 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */

  
    

  create  table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_ticket_flights"
  );
  
[0m12:42:48.487565 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m12:42:48.490178 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:42:48.490419 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights" rename to "ticket_flights__dbt_backup"
[0m12:42:48.491522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.494072 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:42:48.494449 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp" rename to "ticket_flights"
[0m12:42:48.495731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.496683 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:42:48.496885 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:42:48.497040 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:42:48.500098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.534280 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."ticket_flights__dbt_backup"
[0m12:42:48.534777 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:42:48.534955 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
drop table if exists "postgres"."dwh_detailed"."ticket_flights__dbt_backup" cascade
[0m12:42:48.540551 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:42:48.541405 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: Close
[0m12:42:48.541973 [info ] [Thread-1 (]: 7 of 36 OK created sql table model dwh_detailed.ticket_flights ................. [[32mSELECT 1[0m in 0.08s]
[0m12:42:48.542331 [debug] [Thread-1 (]: Finished running node model.dbtvault.ticket_flights
[0m12:42:48.542550 [debug] [Thread-1 (]: Began running node model.dbtvault.tickets
[0m12:42:48.542799 [info ] [Thread-1 (]: 8 of 36 START sql table model dwh_detailed.tickets ............................. [RUN]
[0m12:42:48.543077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.ticket_flights, now model.dbtvault.tickets)
[0m12:42:48.543268 [debug] [Thread-1 (]: Began compiling node model.dbtvault.tickets
[0m12:42:48.545377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.tickets"
[0m12:42:48.545968 [debug] [Thread-1 (]: Began executing node model.dbtvault.tickets
[0m12:42:48.548449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.tickets"
[0m12:42:48.548756 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:42:48.548940 [debug] [Thread-1 (]: On model.dbtvault.tickets: BEGIN
[0m12:42:48.549092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.553146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.553400 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:42:48.553568 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */

  
    

  create  table "postgres"."dwh_detailed"."tickets__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_tickets"
  );
  
[0m12:42:48.569271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m12:42:48.571786 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:42:48.572028 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets" rename to "tickets__dbt_backup"
[0m12:42:48.573109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.575520 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:42:48.575722 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets__dbt_tmp" rename to "tickets"
[0m12:42:48.576516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.577383 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:42:48.577610 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:42:48.577831 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:42:48.580616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.582229 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."tickets__dbt_backup"
[0m12:42:48.582622 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:42:48.582816 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
drop table if exists "postgres"."dwh_detailed"."tickets__dbt_backup" cascade
[0m12:42:48.587225 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:42:48.588168 [debug] [Thread-1 (]: On model.dbtvault.tickets: Close
[0m12:42:48.588711 [info ] [Thread-1 (]: 8 of 36 OK created sql table model dwh_detailed.tickets ........................ [[32mSELECT 1[0m in 0.05s]
[0m12:42:48.589052 [debug] [Thread-1 (]: Finished running node model.dbtvault.tickets
[0m12:42:48.589264 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_aircrafts
[0m12:42:48.589950 [info ] [Thread-1 (]: 9 of 36 START sql view model dwh_detailed.stg_aircrafts ........................ [RUN]
[0m12:42:48.590416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.tickets, now model.dbtvault.stg_aircrafts)
[0m12:42:48.590615 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_aircrafts
[0m12:42:48.613527 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:42:48.613846 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: BEGIN
[0m12:42:48.614013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.618745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:42:48.619070 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:42:48.619258 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.631080 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.012 seconds
[0m12:42:48.661852 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:42:48.662148 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.669292 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m12:42:48.698995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_aircrafts"
[0m12:42:48.699394 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_aircrafts
[0m12:42:48.709842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_aircrafts"
[0m12:42:48.710187 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:42:48.710396 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

  create view "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed"."aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS AIRCRAFT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRCRAFT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    AIRCRAFT_PK,
    AIRCRAFT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:48.718568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:42:48.720859 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:42:48.721088 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
alter table "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m12:42:48.722376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.723261 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:42:48.723464 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:42:48.723624 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:42:48.727813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:42:48.729556 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup"
[0m12:42:48.731057 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:42:48.731302 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m12:42:48.732764 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:42:48.733584 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: Close
[0m12:42:48.734142 [info ] [Thread-1 (]: 9 of 36 OK created sql view model dwh_detailed.stg_aircrafts ................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:42:48.734491 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_aircrafts
[0m12:42:48.734711 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_airports
[0m12:42:48.735285 [info ] [Thread-1 (]: 10 of 36 START sql view model dwh_detailed.stg_airports ........................ [RUN]
[0m12:42:48.736107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_aircrafts, now model.dbtvault.stg_airports)
[0m12:42:48.736396 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_airports
[0m12:42:48.741412 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:42:48.741619 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: BEGIN
[0m12:42:48.741792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.745564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.745819 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:42:48.746007 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.757280 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.011 seconds
[0m12:42:48.760770 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:42:48.761013 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.767253 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:42:48.771441 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_airports"
[0m12:42:48.771771 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_airports
[0m12:42:48.774193 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_airports"
[0m12:42:48.774486 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:42:48.774689 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

  create view "postgres"."dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed"."airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    AIRPORT_PK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:48.781888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:42:48.784582 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:42:48.784822 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
alter table "postgres"."dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m12:42:48.786202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.787057 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:42:48.787280 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:42:48.787443 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:42:48.791952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:42:48.793737 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_airports__dbt_backup"
[0m12:42:48.794133 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:42:48.794315 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
drop view if exists "postgres"."dwh_detailed"."stg_airports__dbt_backup" cascade
[0m12:42:48.795695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:42:48.796479 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: Close
[0m12:42:48.796995 [info ] [Thread-1 (]: 10 of 36 OK created sql view model dwh_detailed.stg_airports ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:42:48.797324 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_airports
[0m12:42:48.797581 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_boarding_passes
[0m12:42:48.797908 [info ] [Thread-1 (]: 11 of 36 START sql view model dwh_detailed.stg_boarding_passes ................. [RUN]
[0m12:42:48.798463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_airports, now model.dbtvault.stg_boarding_passes)
[0m12:42:48.799008 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_boarding_passes
[0m12:42:48.803440 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:42:48.803662 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: BEGIN
[0m12:42:48.803827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.807777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.808023 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:42:48.808195 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.819598 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:42:48.823451 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:42:48.823686 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.829980 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:42:48.833686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_boarding_passes"
[0m12:42:48.834035 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_boarding_passes
[0m12:42:48.836470 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_boarding_passes"
[0m12:42:48.836765 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:42:48.836990 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed"."boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS TICKET_FLIGHTS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOARDING_PASSES_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    TICKET_FLIGHTS_PK,
    BOARDING_PASSES_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:48.844182 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:42:48.846413 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:42:48.846652 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m12:42:48.847930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.848787 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:42:48.848990 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:42:48.849147 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:42:48.852443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.854531 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m12:42:48.855032 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:42:48.855225 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m12:42:48.856651 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:42:48.857581 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: Close
[0m12:42:48.858126 [info ] [Thread-1 (]: 11 of 36 OK created sql view model dwh_detailed.stg_boarding_passes ............ [[32mCREATE VIEW[0m in 0.06s]
[0m12:42:48.858457 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_boarding_passes
[0m12:42:48.858685 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_bookings
[0m12:42:48.859302 [info ] [Thread-1 (]: 12 of 36 START sql view model dwh_detailed.stg_bookings ........................ [RUN]
[0m12:42:48.860257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_boarding_passes, now model.dbtvault.stg_bookings)
[0m12:42:48.860504 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_bookings
[0m12:42:48.865078 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:42:48.865292 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: BEGIN
[0m12:42:48.865453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.869615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:48.869868 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:42:48.870046 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.881532 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:42:48.884834 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:42:48.885057 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.891483 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:42:48.894640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_bookings"
[0m12:42:48.894967 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_bookings
[0m12:42:48.898025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_bookings"
[0m12:42:48.898363 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:42:48.898597 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

  create view "postgres"."dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed"."bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS BOOK_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOOK_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    BOOK_PK,
    BOOK_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:48.905645 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:42:48.907932 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:42:48.908189 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
alter table "postgres"."dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m12:42:48.909368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.910217 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:42:48.910419 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:42:48.910571 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:42:48.913686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.915339 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_bookings__dbt_backup"
[0m12:42:48.915719 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:42:48.915899 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m12:42:48.917202 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:42:48.917995 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: Close
[0m12:42:48.918543 [info ] [Thread-1 (]: 12 of 36 OK created sql view model dwh_detailed.stg_bookings ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:42:48.919242 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_bookings
[0m12:42:48.919701 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_flights
[0m12:42:48.920299 [info ] [Thread-1 (]: 13 of 36 START sql view model dwh_detailed.stg_flights ......................... [RUN]
[0m12:42:48.920984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_bookings, now model.dbtvault.stg_flights)
[0m12:42:48.921202 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_flights
[0m12:42:48.926194 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:42:48.926417 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: BEGIN
[0m12:42:48.926579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:48.931157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:42:48.931418 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:42:48.931594 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.942932 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m12:42:48.946651 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:42:48.946901 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:48.953325 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:42:48.960769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_flights"
[0m12:42:48.961145 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_flights
[0m12:42:48.964015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_flights"
[0m12:42:48.964312 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:42:48.964539 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

  create view "postgres"."dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed"."flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS FLIGHT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS FLIGHT_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_AIRCRAFT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_ARRIVAL_AIRPORT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    FLIGHT_PK,
    FLIGHT_HASHDIFF,
    LINK_FLIGHT_AIRCRAFT_PK,
    LINK_FLIGHT_ARRIVAL_AIRPORT_PK,
    LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:48.975063 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:42:48.977344 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:42:48.977580 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
alter table "postgres"."dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m12:42:48.979073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:48.979917 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:42:48.980126 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:42:48.980285 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:42:48.983196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:48.984845 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_flights__dbt_backup"
[0m12:42:48.985238 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:42:48.985434 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_flights__dbt_backup" cascade
[0m12:42:48.986842 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:42:48.987693 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: Close
[0m12:42:48.988257 [info ] [Thread-1 (]: 13 of 36 OK created sql view model dwh_detailed.stg_flights .................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:42:48.989411 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_flights
[0m12:42:48.989903 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_seats
[0m12:42:48.990724 [info ] [Thread-1 (]: 14 of 36 START sql view model dwh_detailed.stg_seats ........................... [RUN]
[0m12:42:48.991546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_flights, now model.dbtvault.stg_seats)
[0m12:42:48.991764 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_seats
[0m12:42:48.996280 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:42:48.996497 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: BEGIN
[0m12:42:48.996676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.000641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:49.000899 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:42:49.001094 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.012254 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:42:49.016001 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:42:49.016244 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.022492 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:42:49.026712 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_seats"
[0m12:42:49.027057 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_seats
[0m12:42:49.029685 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_seats"
[0m12:42:49.030000 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:42:49.030206 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

  create view "postgres"."dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed"."seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS SEAT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_SEAT_AIRCRAFT_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')), 'hex') AS SEAT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    SEAT_PK,
    LINK_SEAT_AIRCRAFT_PK,
    SEAT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:49.038018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:42:49.040285 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:42:49.040523 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
alter table "postgres"."dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m12:42:49.041780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:49.042589 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:42:49.042804 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:42:49.042965 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:42:49.045849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.081386 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_seats__dbt_backup"
[0m12:42:49.081955 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:42:49.082145 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
drop view if exists "postgres"."dwh_detailed"."stg_seats__dbt_backup" cascade
[0m12:42:49.084134 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:42:49.084977 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: Close
[0m12:42:49.085534 [info ] [Thread-1 (]: 14 of 36 OK created sql view model dwh_detailed.stg_seats ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:42:49.086264 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_seats
[0m12:42:49.086751 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_ticket_flights
[0m12:42:49.087329 [info ] [Thread-1 (]: 15 of 36 START sql view model dwh_detailed.stg_ticket_flights .................. [RUN]
[0m12:42:49.088143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_seats, now model.dbtvault.stg_ticket_flights)
[0m12:42:49.088364 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_ticket_flights
[0m12:42:49.092744 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:42:49.092959 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: BEGIN
[0m12:42:49.093140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.097097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:49.097349 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:42:49.097552 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.109148 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:42:49.112466 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:42:49.112719 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.119499 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m12:42:49.123877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_ticket_flights"
[0m12:42:49.124277 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_ticket_flights
[0m12:42:49.126762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_ticket_flights"
[0m12:42:49.127059 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:42:49.127261 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed"."ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKET_FLIGHTS_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    TICKET_FLIGHTS_HASHDIFF,
    LINK_TICKET_FLIGHTS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:49.134898 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:42:49.137297 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:42:49.137569 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m12:42:49.138961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:49.139826 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:42:49.140033 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:42:49.140189 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:42:49.144392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:42:49.146339 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m12:42:49.146781 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:42:49.146978 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m12:42:49.148729 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:42:49.149563 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: Close
[0m12:42:49.150107 [info ] [Thread-1 (]: 15 of 36 OK created sql view model dwh_detailed.stg_ticket_flights ............. [[32mCREATE VIEW[0m in 0.06s]
[0m12:42:49.150442 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_ticket_flights
[0m12:42:49.150652 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_tickets
[0m12:42:49.151068 [info ] [Thread-1 (]: 16 of 36 START sql view model dwh_detailed.stg_tickets ......................... [RUN]
[0m12:42:49.151644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_ticket_flights, now model.dbtvault.stg_tickets)
[0m12:42:49.152165 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_tickets
[0m12:42:49.157228 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:42:49.157475 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: BEGIN
[0m12:42:49.157655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.161954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:49.162339 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:42:49.162540 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.174213 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m12:42:49.177965 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:42:49.178217 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.184902 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:49.189536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_tickets"
[0m12:42:49.189905 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_tickets
[0m12:42:49.192712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_tickets"
[0m12:42:49.193028 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:42:49.193261 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

  create view "postgres"."dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed"."tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS TICKET_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_BOOKING_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKETHASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    TICKET_PK,
    LINK_TICKET_BOOKING_PK,
    TICKETHASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:42:49.201571 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:42:49.204020 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:42:49.204270 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
alter table "postgres"."dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m12:42:49.205671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:42:49.206556 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:42:49.206766 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:42:49.206922 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:42:49.210196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.212033 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_tickets__dbt_backup"
[0m12:42:49.212473 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:42:49.212662 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m12:42:49.214023 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:42:49.214853 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: Close
[0m12:42:49.215394 [info ] [Thread-1 (]: 16 of 36 OK created sql view model dwh_detailed.stg_tickets .................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:42:49.215733 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_tickets
[0m12:42:49.215960 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_aircraft
[0m12:42:49.216592 [info ] [Thread-1 (]: 17 of 36 START sql incremental model dwh_detailed.hub_aircraft ................. [RUN]
[0m12:42:49.217933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_tickets, now model.dbtvault.hub_aircraft)
[0m12:42:49.218244 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_aircraft
[0m12:42:49.230641 [info ] [Thread-1 (]: 12:42:49 + Loading postgres.dwh_detailed.hub_aircraft from 1 source(s)
[0m12:42:49.262678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_aircraft"
[0m12:42:49.263183 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_aircraft
[0m12:42:49.279207 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:42:49.279478 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

    
  
    

  create temporary table "hub_aircraft__dbt_tmp124249275832"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRCRAFT_PK) rr.AIRCRAFT_PK, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.AIRCRAFT_PK IS NOT NULL
    ORDER BY rr.AIRCRAFT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRCRAFT_PK, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_aircraft" AS d
    ON a.AIRCRAFT_PK = d.AIRCRAFT_PK
    WHERE d.AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.279663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.299108 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m12:42:49.301415 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:42:49.301681 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: BEGIN
[0m12:42:49.302390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:49.302629 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:42:49.302797 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft__dbt_tmp124249275832'
        
      order by ordinal_position

  
[0m12:42:49.311293 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:42:49.313463 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:42:49.313696 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.319435 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:42:49.324585 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:42:49.324842 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.330881 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:42:49.337302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_aircraft"
[0m12:42:49.337766 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:42:49.337989 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      insert into "postgres"."dwh_detailed"."hub_aircraft" ("aircraft_pk", "aircraft_code", "load_date", "record_source")
    (
        select "aircraft_pk", "aircraft_code", "load_date", "record_source"
        from "hub_aircraft__dbt_tmp124249275832"
    )


  
[0m12:42:49.340217 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:42:49.341094 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:42:49.341304 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:42:49.341463 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:42:49.344555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.345090 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: Close
[0m12:42:49.345637 [info ] [Thread-1 (]: 17 of 36 OK created sql incremental model dwh_detailed.hub_aircraft ............ [[32mINSERT 0 0[0m in 0.13s]
[0m12:42:49.345985 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_aircraft
[0m12:42:49.346208 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_aircraft_data
[0m12:42:49.346626 [info ] [Thread-1 (]: 18 of 36 START sql incremental model dwh_detailed.sat_aircraft_data ............ [RUN]
[0m12:42:49.346908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_aircraft, now model.dbtvault.sat_aircraft_data)
[0m12:42:49.347105 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_aircraft_data
[0m12:42:49.371482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_aircraft_data"
[0m12:42:49.371938 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_aircraft_data
[0m12:42:49.374734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_aircraft_data"
[0m12:42:49.375084 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:42:49.375275 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: BEGIN
[0m12:42:49.375431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.379355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:49.379596 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:42:49.379778 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_aircraft_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRCRAFT_PK, a.AIRCRAFT_HASHDIFF, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS a
    WHERE a.AIRCRAFT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.405175 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:42:49.406338 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m12:42:49.406593 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:42:49.406757 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m12:42:49.409604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.410112 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: Close
[0m12:42:49.410661 [info ] [Thread-1 (]: 18 of 36 OK created sql incremental model dwh_detailed.sat_aircraft_data ....... [[32mSELECT 1[0m in 0.06s]
[0m12:42:49.411005 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_aircraft_data
[0m12:42:49.411252 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_airport
[0m12:42:49.411512 [info ] [Thread-1 (]: 19 of 36 START sql incremental model dwh_detailed.hub_airport .................. [RUN]
[0m12:42:49.411794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_aircraft_data, now model.dbtvault.hub_airport)
[0m12:42:49.411984 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_airport
[0m12:42:49.415546 [info ] [Thread-1 (]: 12:42:49 + Loading postgres.dwh_detailed.hub_airport from 1 source(s)
[0m12:42:49.418258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_airport"
[0m12:42:49.418592 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_airport
[0m12:42:49.421427 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:42:49.421653 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

    
  
    

  create temporary table "hub_airport__dbt_tmp124249420286"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_PK) rr.AIRPORT_PK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS rr
    WHERE rr.AIRPORT_PK IS NOT NULL
    ORDER BY rr.AIRPORT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_PK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_airport" AS d
    ON a.AIRPORT_PK = d.AIRPORT_PK
    WHERE d.AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.421829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.441452 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m12:42:49.443767 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:42:49.444034 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: BEGIN
[0m12:42:49.444616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:49.444858 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:42:49.445028 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport__dbt_tmp124249420286'
        
      order by ordinal_position

  
[0m12:42:49.453242 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:42:49.455325 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:42:49.455545 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.461404 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:42:49.464117 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:42:49.464344 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.470220 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:42:49.471322 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_airport"
[0m12:42:49.471688 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:42:49.471882 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      insert into "postgres"."dwh_detailed"."hub_airport" ("airport_pk", "airport_code", "load_date", "record_source")
    (
        select "airport_pk", "airport_code", "load_date", "record_source"
        from "hub_airport__dbt_tmp124249420286"
    )


  
[0m12:42:49.474157 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:42:49.475433 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:42:49.475773 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:42:49.476050 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:42:49.479505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.480041 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: Close
[0m12:42:49.480589 [info ] [Thread-1 (]: 19 of 36 OK created sql incremental model dwh_detailed.hub_airport ............. [[32mINSERT 0 0[0m in 0.07s]
[0m12:42:49.480919 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_airport
[0m12:42:49.481149 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_airports_data
[0m12:42:49.481547 [info ] [Thread-1 (]: 20 of 36 START sql incremental model dwh_detailed.sat_airports_data ............ [RUN]
[0m12:42:49.481875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_airport, now model.dbtvault.sat_airports_data)
[0m12:42:49.482103 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_airports_data
[0m12:42:49.490462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_airports_data"
[0m12:42:49.490930 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_airports_data
[0m12:42:49.494239 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:42:49.494500 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

    
  
    

  create temporary table "sat_airports_data__dbt_tmp124249492592"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS a
    WHERE a.AIRPORT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.AIRPORT_PK, current_records.AIRPORT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.AIRPORT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_airports_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.AIRPORT_PK
                FROM source_data
            ) AS source_records
                ON current_records.AIRPORT_PK = source_records.AIRPORT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRPORT_PK, stage.AIRPORT_HASHDIFF, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.AIRPORT_PK = stage.AIRPORT_PK
        AND latest_records.AIRPORT_HASHDIFF = stage.AIRPORT_HASHDIFF
    WHERE latest_records.AIRPORT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.494728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.536889 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m12:42:49.539507 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:42:49.539762 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: BEGIN
[0m12:42:49.540347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:49.540584 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:42:49.540782 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data__dbt_tmp124249492592'
        
      order by ordinal_position

  
[0m12:42:49.607286 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.066 seconds
[0m12:42:49.609813 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:42:49.610073 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.615975 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:42:49.618300 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:42:49.618524 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.624247 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m12:42:49.625448 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_airports_data"
[0m12:42:49.625787 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:42:49.625968 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      insert into "postgres"."dwh_detailed"."sat_airports_data" ("airport_pk", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_date", "record_source")
    (
        select "airport_pk", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_date", "record_source"
        from "sat_airports_data__dbt_tmp124249492592"
    )


  
[0m12:42:49.630273 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:49.631126 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:42:49.631332 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:42:49.631494 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:42:49.634690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.635197 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: Close
[0m12:42:49.635716 [info ] [Thread-1 (]: 20 of 36 OK created sql incremental model dwh_detailed.sat_airports_data ....... [[32mINSERT 0 0[0m in 0.15s]
[0m12:42:49.636039 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_airports_data
[0m12:42:49.636268 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:42:49.636540 [info ] [Thread-1 (]: 21 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [RUN]
[0m12:42:49.636877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_airports_data, now model.dbtvault.sat_ticket_flights_boarding_passes)
[0m12:42:49.637068 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:42:49.646143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.646585 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:42:49.649470 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.649737 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

    
  
    

  create temporary table "sat_ticket_flights_boarding_passes__dbt_tmp124249648240"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.TICKET_FLIGHTS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.TICKET_FLIGHTS_PK, current_records.BOARDING_PASSES_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.TICKET_FLIGHTS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes" AS current_records
            JOIN (
                SELECT DISTINCT source_data.TICKET_FLIGHTS_PK
                FROM source_data
            ) AS source_records
                ON current_records.TICKET_FLIGHTS_PK = source_records.TICKET_FLIGHTS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_FLIGHTS_PK, stage.BOARDING_PASSES_HASHDIFF, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.TICKET_FLIGHTS_PK = stage.TICKET_FLIGHTS_PK
        AND latest_records.BOARDING_PASSES_HASHDIFF = stage.BOARDING_PASSES_HASHDIFF
    WHERE latest_records.BOARDING_PASSES_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.649942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.690318 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:42:49.692590 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.692836 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: BEGIN
[0m12:42:49.693393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:49.693606 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.693766 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes__dbt_tmp124249648240'
        
      order by ordinal_position

  
[0m12:42:49.744428 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.050 seconds
[0m12:42:49.746990 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.747236 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.753169 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:42:49.755844 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.756069 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.761930 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:42:49.763176 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.763511 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.763734 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      insert into "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes" ("ticket_flights_pk", "boarding_passes_hashdiff", "boarding_no", "seat_no", "effective_from", "load_date", "record_source")
    (
        select "ticket_flights_pk", "boarding_passes_hashdiff", "boarding_no", "seat_no", "effective_from", "load_date", "record_source"
        from "sat_ticket_flights_boarding_passes__dbt_tmp124249648240"
    )


  
[0m12:42:49.767605 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:49.768505 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:42:49.768728 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:42:49.768885 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:42:49.771993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.772482 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: Close
[0m12:42:49.773004 [info ] [Thread-1 (]: 21 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [[32mINSERT 0 0[0m in 0.14s]
[0m12:42:49.773324 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:42:49.773529 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_booking
[0m12:42:49.773792 [info ] [Thread-1 (]: 22 of 36 START sql incremental model dwh_detailed.hub_booking .................. [RUN]
[0m12:42:49.774157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_boarding_passes, now model.dbtvault.hub_booking)
[0m12:42:49.774340 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_booking
[0m12:42:49.779887 [info ] [Thread-1 (]: 12:42:49 + Loading postgres.dwh_detailed.hub_booking from 1 source(s)
[0m12:42:49.782465 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_booking"
[0m12:42:49.782797 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_booking
[0m12:42:49.785666 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:42:49.785890 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

    
  
    

  create temporary table "hub_booking__dbt_tmp124249784553"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS rr
    WHERE rr.BOOK_PK IS NOT NULL
    ORDER BY rr.BOOK_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.BOOK_PK, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_booking" AS d
    ON a.BOOK_PK = d.BOOK_PK
    WHERE d.BOOK_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.786065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.804557 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m12:42:49.806834 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:42:49.807087 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: BEGIN
[0m12:42:49.807687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:49.807992 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:42:49.808163 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_booking__dbt_tmp124249784553'
        
      order by ordinal_position

  
[0m12:42:49.816348 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:42:49.819185 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:42:49.819412 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.825121 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:42:49.827209 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:42:49.827459 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.832992 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:42:49.834089 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_booking"
[0m12:42:49.834421 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:42:49.834636 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      insert into "postgres"."dwh_detailed"."hub_booking" ("book_pk", "book_ref", "load_date", "record_source")
    (
        select "book_pk", "book_ref", "load_date", "record_source"
        from "hub_booking__dbt_tmp124249784553"
    )


  
[0m12:42:49.836777 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:42:49.837767 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:42:49.837986 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:42:49.838145 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:42:49.840924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.841372 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: Close
[0m12:42:49.841888 [info ] [Thread-1 (]: 22 of 36 OK created sql incremental model dwh_detailed.hub_booking ............. [[32mINSERT 0 0[0m in 0.07s]
[0m12:42:49.842214 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_booking
[0m12:42:49.842435 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_booking_data
[0m12:42:49.842691 [info ] [Thread-1 (]: 23 of 36 START sql incremental model dwh_detailed.sat_booking_data ............. [RUN]
[0m12:42:49.843155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_booking, now model.dbtvault.sat_booking_data)
[0m12:42:49.843383 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_booking_data
[0m12:42:49.851205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_booking_data"
[0m12:42:49.851647 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_booking_data
[0m12:42:49.854950 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:42:49.855200 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

    
  
    

  create temporary table "sat_booking_data__dbt_tmp124249853819"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS a
    WHERE a.BOOK_PK IS NOT NULL
),

latest_records AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.BOOK_PK, current_records.BOOK_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.BOOK_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_booking_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.BOOK_PK
                FROM source_data
            ) AS source_records
                ON current_records.BOOK_PK = source_records.BOOK_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.BOOK_PK, stage.BOOK_HASHDIFF, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.BOOK_PK = stage.BOOK_PK
        AND latest_records.BOOK_HASHDIFF = stage.BOOK_HASHDIFF
    WHERE latest_records.BOOK_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.855389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:49.895124 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:42:49.897510 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:42:49.897840 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: BEGIN
[0m12:42:49.898479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:49.898703 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:42:49.898874 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data__dbt_tmp124249853819'
        
      order by ordinal_position

  
[0m12:42:49.956576 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.057 seconds
[0m12:42:49.959136 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:42:49.959396 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.965245 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:42:49.967439 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:42:49.967654 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:49.973344 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:42:49.974530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_booking_data"
[0m12:42:49.974883 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:42:49.975063 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      insert into "postgres"."dwh_detailed"."sat_booking_data" ("book_pk", "book_hashdiff", "book_date", "total_amount", "effective_from", "load_date", "record_source")
    (
        select "book_pk", "book_hashdiff", "book_date", "total_amount", "effective_from", "load_date", "record_source"
        from "sat_booking_data__dbt_tmp124249853819"
    )


  
[0m12:42:49.978753 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:42:49.979702 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:42:49.979906 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:42:49.980084 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:42:49.983209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:49.983705 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: Close
[0m12:42:49.984235 [info ] [Thread-1 (]: 23 of 36 OK created sql incremental model dwh_detailed.sat_booking_data ........ [[32mINSERT 0 0[0m in 0.14s]
[0m12:42:49.984563 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_booking_data
[0m12:42:49.984771 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_flight
[0m12:42:49.985093 [info ] [Thread-1 (]: 24 of 36 START sql incremental model dwh_detailed.hub_flight ................... [RUN]
[0m12:42:49.985355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_booking_data, now model.dbtvault.hub_flight)
[0m12:42:49.985526 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_flight
[0m12:42:49.991330 [info ] [Thread-1 (]: 12:42:49 + Loading postgres.dwh_detailed.hub_flight from 1 source(s)
[0m12:42:49.995245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_flight"
[0m12:42:49.995591 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_flight
[0m12:42:49.998470 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:42:49.998694 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

    
  
    

  create temporary table "hub_flight__dbt_tmp124249997224"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.FLIGHT_PK) rr.FLIGHT_PK, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.FLIGHT_PK IS NOT NULL
    ORDER BY rr.FLIGHT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.FLIGHT_PK, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_flight" AS d
    ON a.FLIGHT_PK = d.FLIGHT_PK
    WHERE d.FLIGHT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:49.998868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.016781 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m12:42:50.019057 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:42:50.019326 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: BEGIN
[0m12:42:50.019925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:50.020150 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:42:50.020308 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight__dbt_tmp124249997224'
        
      order by ordinal_position

  
[0m12:42:50.028320 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:42:50.030551 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:42:50.030771 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.036429 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:42:50.039129 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:42:50.039342 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.044882 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:42:50.081128 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_flight"
[0m12:42:50.081595 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:42:50.081789 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      insert into "postgres"."dwh_detailed"."hub_flight" ("flight_pk", "flight_id", "load_date", "record_source")
    (
        select "flight_pk", "flight_id", "load_date", "record_source"
        from "hub_flight__dbt_tmp124249997224"
    )


  
[0m12:42:50.084531 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:42:50.085416 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:42:50.085624 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:42:50.085783 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:42:50.088810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:50.089351 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: Close
[0m12:42:50.089878 [info ] [Thread-1 (]: 24 of 36 OK created sql incremental model dwh_detailed.hub_flight .............. [[32mINSERT 0 0[0m in 0.10s]
[0m12:42:50.090228 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_flight
[0m12:42:50.090440 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_aircraft
[0m12:42:50.090703 [info ] [Thread-1 (]: 25 of 36 START sql incremental model dwh_detailed.link_flight_aircraft ......... [RUN]
[0m12:42:50.091022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_flight, now model.dbtvault.link_flight_aircraft)
[0m12:42:50.091509 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_aircraft
[0m12:42:50.096699 [info ] [Thread-1 (]: 12:42:50 + Loading postgres.dwh_detailed.link_flight_aircraft from 1 source(s)
[0m12:42:50.107255 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_aircraft"
[0m12:42:50.107617 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_aircraft
[0m12:42:50.110531 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:42:50.110764 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

    
  
    

  create temporary table "link_flight_aircraft__dbt_tmp124250109347"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_AIRCRAFT_PK, rr.flight_id, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_AIRCRAFT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_AIRCRAFT_PK, a.flight_id, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_aircraft" AS d
    ON a.LINK_FLIGHT_AIRCRAFT_PK = d.LINK_FLIGHT_AIRCRAFT_PK
    WHERE d.LINK_FLIGHT_AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:50.110967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.147251 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m12:42:50.149597 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:42:50.150353 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: BEGIN
[0m12:42:50.150928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:50.151237 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:42:50.151419 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft__dbt_tmp124250109347'
        
      order by ordinal_position

  
[0m12:42:50.212613 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.061 seconds
[0m12:42:50.215177 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:42:50.215427 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.221166 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:50.223317 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:42:50.223536 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.229066 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:42:50.230230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_aircraft"
[0m12:42:50.230558 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:42:50.230753 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      insert into "postgres"."dwh_detailed"."link_flight_aircraft" ("link_flight_aircraft_pk", "flight_id", "aircraft_code", "load_date", "record_source")
    (
        select "link_flight_aircraft_pk", "flight_id", "aircraft_code", "load_date", "record_source"
        from "link_flight_aircraft__dbt_tmp124250109347"
    )


  
[0m12:42:50.234268 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:42:50.235097 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:42:50.235300 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:42:50.235459 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:42:50.238287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:50.238778 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: Close
[0m12:42:50.239309 [info ] [Thread-1 (]: 25 of 36 OK created sql incremental model dwh_detailed.link_flight_aircraft .... [[32mINSERT 0 0[0m in 0.15s]
[0m12:42:50.239643 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_aircraft
[0m12:42:50.239864 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_arrival_airport
[0m12:42:50.240136 [info ] [Thread-1 (]: 26 of 36 START sql incremental model dwh_detailed.link_flight_arrival_airport .. [RUN]
[0m12:42:50.241946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_aircraft, now model.dbtvault.link_flight_arrival_airport)
[0m12:42:50.242550 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_arrival_airport
[0m12:42:50.246259 [info ] [Thread-1 (]: 12:42:50 + Loading postgres.dwh_detailed.link_flight_arrival_airport from 1 source(s)
[0m12:42:50.248872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.249223 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_arrival_airport
[0m12:42:50.252601 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.252830 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

    
  
    

  create temporary table "link_flight_arrival_airport__dbt_tmp124250251483"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, rr.flight_id, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, a.flight_id, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_arrival_airport" AS d
    ON a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK = d.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
    WHERE d.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:50.253026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.288702 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m12:42:50.291153 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.291408 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: BEGIN
[0m12:42:50.292018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:50.292251 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.292423 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport__dbt_tmp124250251483'
        
      order by ordinal_position

  
[0m12:42:50.358319 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.066 seconds
[0m12:42:50.360832 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.361097 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.367068 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:50.369375 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.369628 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.375344 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:42:50.376571 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.376930 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.377118 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      insert into "postgres"."dwh_detailed"."link_flight_arrival_airport" ("link_flight_arrival_airport_pk", "flight_id", "arrival_airport", "load_date", "record_source")
    (
        select "link_flight_arrival_airport_pk", "flight_id", "arrival_airport", "load_date", "record_source"
        from "link_flight_arrival_airport__dbt_tmp124250251483"
    )


  
[0m12:42:50.381056 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:50.381977 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:42:50.382197 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:42:50.382358 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:42:50.385479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:50.386021 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: Close
[0m12:42:50.386537 [info ] [Thread-1 (]: 26 of 36 OK created sql incremental model dwh_detailed.link_flight_arrival_airport  [[32mINSERT 0 0[0m in 0.14s]
[0m12:42:50.386859 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_arrival_airport
[0m12:42:50.387085 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_departure_airport
[0m12:42:50.387464 [info ] [Thread-1 (]: 27 of 36 START sql incremental model dwh_detailed.link_flight_departure_airport  [RUN]
[0m12:42:50.387759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_arrival_airport, now model.dbtvault.link_flight_departure_airport)
[0m12:42:50.387965 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_departure_airport
[0m12:42:50.393022 [info ] [Thread-1 (]: 12:42:50 + Loading postgres.dwh_detailed.link_flight_departure_airport from 1 source(s)
[0m12:42:50.395650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.395982 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_departure_airport
[0m12:42:50.399069 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.399309 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

    
  
    

  create temporary table "link_flight_departure_airport__dbt_tmp124250397692"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, rr.flight_id, rr.departure_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, a.flight_id, a.departure_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_departure_airport" AS d
    ON a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK = d.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
    WHERE d.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:50.399502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.434667 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m12:42:50.436993 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.437312 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: BEGIN
[0m12:42:50.438033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:50.438274 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.438444 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport__dbt_tmp124250397692'
        
      order by ordinal_position

  
[0m12:42:50.497969 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.059 seconds
[0m12:42:50.500351 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.500601 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.506538 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:50.509410 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.509633 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.515312 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:42:50.516513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.516922 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.517137 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      insert into "postgres"."dwh_detailed"."link_flight_departure_airport" ("link_flight_departure_airport_pk", "flight_id", "departure_airport", "load_date", "record_source")
    (
        select "link_flight_departure_airport_pk", "flight_id", "departure_airport", "load_date", "record_source"
        from "link_flight_departure_airport__dbt_tmp124250397692"
    )


  
[0m12:42:50.520883 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:50.521718 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:42:50.521930 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:42:50.522104 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:42:50.525160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:50.525657 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: Close
[0m12:42:50.526192 [info ] [Thread-1 (]: 27 of 36 OK created sql incremental model dwh_detailed.link_flight_departure_airport  [[32mINSERT 0 0[0m in 0.14s]
[0m12:42:50.526550 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_departure_airport
[0m12:42:50.526760 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_flight_data
[0m12:42:50.527039 [info ] [Thread-1 (]: 28 of 36 START sql incremental model dwh_detailed.sat_flight_data .............. [RUN]
[0m12:42:50.527384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_departure_airport, now model.dbtvault.sat_flight_data)
[0m12:42:50.527572 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_flight_data
[0m12:42:50.539704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_flight_data"
[0m12:42:50.540150 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_flight_data
[0m12:42:50.543094 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:42:50.543369 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

    
  
    

  create temporary table "sat_flight_data__dbt_tmp124250541969"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.status, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS a
    WHERE a.FLIGHT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.FLIGHT_PK, current_records.FLIGHT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.FLIGHT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_flight_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.FLIGHT_PK
                FROM source_data
            ) AS source_records
                ON current_records.FLIGHT_PK = source_records.FLIGHT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.FLIGHT_PK, stage.FLIGHT_HASHDIFF, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.status, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.FLIGHT_PK = stage.FLIGHT_PK
        AND latest_records.FLIGHT_HASHDIFF = stage.FLIGHT_HASHDIFF
    WHERE latest_records.FLIGHT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:50.543559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.588633 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.045 seconds
[0m12:42:50.591496 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:42:50.591757 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: BEGIN
[0m12:42:50.592335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:50.592591 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:42:50.592769 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data__dbt_tmp124250541969'
        
      order by ordinal_position

  
[0m12:42:50.654085 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.061 seconds
[0m12:42:50.656817 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:42:50.657048 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.663133 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m12:42:50.665343 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:42:50.665558 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.671430 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m12:42:50.672774 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_flight_data"
[0m12:42:50.673110 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:42:50.673295 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      insert into "postgres"."dwh_detailed"."sat_flight_data" ("flight_pk", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "status", "actual_departure", "actual_arrival", "effective_from", "load_date", "record_source")
    (
        select "flight_pk", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "status", "actual_departure", "actual_arrival", "effective_from", "load_date", "record_source"
        from "sat_flight_data__dbt_tmp124250541969"
    )


  
[0m12:42:50.677259 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:50.678154 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:42:50.678357 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:42:50.678511 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:42:50.681737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:50.682265 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: Close
[0m12:42:50.682783 [info ] [Thread-1 (]: 28 of 36 OK created sql incremental model dwh_detailed.sat_flight_data ......... [[32mINSERT 0 0[0m in 0.16s]
[0m12:42:50.683108 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_flight_data
[0m12:42:50.683350 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_seat
[0m12:42:50.683831 [info ] [Thread-1 (]: 29 of 36 START sql incremental model dwh_detailed.hub_seat ..................... [RUN]
[0m12:42:50.684159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_flight_data, now model.dbtvault.hub_seat)
[0m12:42:50.684352 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_seat
[0m12:42:50.688500 [info ] [Thread-1 (]: 12:42:50 + Loading postgres.dwh_detailed.hub_seat from 1 source(s)
[0m12:42:50.691357 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_seat"
[0m12:42:50.691706 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_seat
[0m12:42:50.695159 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:42:50.695391 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

    
  
    

  create temporary table "hub_seat__dbt_tmp124250694006"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.SEAT_PK) rr.SEAT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.SEAT_PK IS NOT NULL
    ORDER BY rr.SEAT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.SEAT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_seat" AS d
    ON a.SEAT_PK = d.SEAT_PK
    WHERE d.SEAT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:50.695571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.714798 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m12:42:50.717188 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:42:50.717453 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: BEGIN
[0m12:42:50.718173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:42:50.718418 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:42:50.718583 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat__dbt_tmp124250694006'
        
      order by ordinal_position

  
[0m12:42:50.726883 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m12:42:50.729382 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:42:50.729627 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.735434 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:50.737626 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:42:50.737864 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.743490 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:42:50.744727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_seat"
[0m12:42:50.745070 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:42:50.745259 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      insert into "postgres"."dwh_detailed"."hub_seat" ("seat_pk", "aircraft_code", "seat_no", "load_date", "record_source")
    (
        select "seat_pk", "aircraft_code", "seat_no", "load_date", "record_source"
        from "hub_seat__dbt_tmp124250694006"
    )


  
[0m12:42:50.747578 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:42:50.748530 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:42:50.748743 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:42:50.748904 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:42:50.751881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:50.752392 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: Close
[0m12:42:50.752922 [info ] [Thread-1 (]: 29 of 36 OK created sql incremental model dwh_detailed.hub_seat ................ [[32mINSERT 0 0[0m in 0.07s]
[0m12:42:50.753291 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_seat
[0m12:42:50.753512 [debug] [Thread-1 (]: Began running node model.dbtvault.link_seat_aircraft
[0m12:42:50.753799 [info ] [Thread-1 (]: 30 of 36 START sql incremental model dwh_detailed.link_seat_aircraft ........... [RUN]
[0m12:42:50.754269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_seat, now model.dbtvault.link_seat_aircraft)
[0m12:42:50.754504 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_seat_aircraft
[0m12:42:50.758514 [info ] [Thread-1 (]: 12:42:50 + Loading postgres.dwh_detailed.link_seat_aircraft from 1 source(s)
[0m12:42:50.761340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_seat_aircraft"
[0m12:42:50.761711 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_seat_aircraft
[0m12:42:50.764624 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:42:50.764856 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

    
  
    

  create temporary table "link_seat_aircraft__dbt_tmp124250763440"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_SEAT_AIRCRAFT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SEAT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.LINK_SEAT_AIRCRAFT_PK IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SEAT_AIRCRAFT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_seat_aircraft" AS d
    ON a.LINK_SEAT_AIRCRAFT_PK = d.LINK_SEAT_AIRCRAFT_PK
    WHERE d.LINK_SEAT_AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:50.765035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.797231 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m12:42:50.799621 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:42:50.799906 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: BEGIN
[0m12:42:50.800487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:50.800686 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:42:50.800851 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft__dbt_tmp124250763440'
        
      order by ordinal_position

  
[0m12:42:50.866695 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.066 seconds
[0m12:42:50.869229 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:42:50.869492 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.875451 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:50.878161 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:42:50.878400 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:50.884078 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:42:50.885273 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_seat_aircraft"
[0m12:42:50.885600 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:42:50.885837 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      insert into "postgres"."dwh_detailed"."link_seat_aircraft" ("link_seat_aircraft_pk", "aircraft_code", "seat_no", "load_date", "record_source")
    (
        select "link_seat_aircraft_pk", "aircraft_code", "seat_no", "load_date", "record_source"
        from "link_seat_aircraft__dbt_tmp124250763440"
    )


  
[0m12:42:50.890173 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:50.891157 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:42:50.891376 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:42:50.891556 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:42:50.894235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:42:50.894738 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: Close
[0m12:42:50.895309 [info ] [Thread-1 (]: 30 of 36 OK created sql incremental model dwh_detailed.link_seat_aircraft ...... [[32mINSERT 0 0[0m in 0.14s]
[0m12:42:50.895636 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_seat_aircraft
[0m12:42:50.895856 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_seat_data
[0m12:42:50.896123 [info ] [Thread-1 (]: 31 of 36 START sql incremental model dwh_detailed.sat_seat_data ................ [RUN]
[0m12:42:50.896557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_seat_aircraft, now model.dbtvault.sat_seat_data)
[0m12:42:50.896766 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_seat_data
[0m12:42:50.905221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_seat_data"
[0m12:42:50.905727 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_seat_data
[0m12:42:50.908814 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:42:50.909074 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

    
  
    

  create temporary table "sat_seat_data__dbt_tmp124250907641"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS a
    WHERE a.SEAT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SEAT_PK, current_records.SEAT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SEAT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_seat_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.SEAT_PK
                FROM source_data
            ) AS source_records
                ON current_records.SEAT_PK = source_records.SEAT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SEAT_PK, stage.SEAT_HASHDIFF, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SEAT_PK = stage.SEAT_PK
        AND latest_records.SEAT_HASHDIFF = stage.SEAT_HASHDIFF
    WHERE latest_records.SEAT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:50.909262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:50.949406 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:42:50.952266 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:42:50.952511 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: BEGIN
[0m12:42:50.953027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:50.953226 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:42:50.953394 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data__dbt_tmp124250907641'
        
      order by ordinal_position

  
[0m12:42:50.995165 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.041 seconds
[0m12:42:50.997890 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:42:50.998188 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.004132 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:42:51.006300 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:42:51.006566 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.012420 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:42:51.013589 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_seat_data"
[0m12:42:51.013979 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:42:51.014211 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      insert into "postgres"."dwh_detailed"."sat_seat_data" ("seat_pk", "seat_hashdiff", "fare_conditions", "effective_from", "load_date", "record_source")
    (
        select "seat_pk", "seat_hashdiff", "fare_conditions", "effective_from", "load_date", "record_source"
        from "sat_seat_data__dbt_tmp124250907641"
    )


  
[0m12:42:51.018081 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:51.019034 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:42:51.019254 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:42:51.019419 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:42:51.022570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:51.023070 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: Close
[0m12:42:51.023598 [info ] [Thread-1 (]: 31 of 36 OK created sql incremental model dwh_detailed.sat_seat_data ........... [[32mINSERT 0 0[0m in 0.13s]
[0m12:42:51.023956 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_seat_data
[0m12:42:51.024177 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_flights
[0m12:42:51.024447 [info ] [Thread-1 (]: 32 of 36 START sql incremental model dwh_detailed.link_ticket_flights .......... [RUN]
[0m12:42:51.024959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_seat_data, now model.dbtvault.link_ticket_flights)
[0m12:42:51.025220 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_flights
[0m12:42:51.033456 [info ] [Thread-1 (]: 12:42:51 + Loading postgres.dwh_detailed.link_ticket_flights from 1 source(s)
[0m12:42:51.036082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_flights"
[0m12:42:51.036422 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_flights
[0m12:42:51.039763 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:42:51.040023 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp124251038604"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_FLIGHTS_PK, rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_FLIGHTS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.LINK_TICKET_FLIGHTS_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_ticket_flights" AS d
    ON a.LINK_TICKET_FLIGHTS_PK = d.LINK_TICKET_FLIGHTS_PK
    WHERE d.LINK_TICKET_FLIGHTS_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:51.040203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:51.071645 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m12:42:51.073885 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:42:51.074127 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: BEGIN
[0m12:42:51.074677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:51.074940 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:42:51.075113 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp124251038604'
        
      order by ordinal_position

  
[0m12:42:51.132877 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.057 seconds
[0m12:42:51.135516 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:42:51.135860 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.141889 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:51.144073 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:42:51.144314 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.149887 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:42:51.151008 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_flights"
[0m12:42:51.151370 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:42:51.151568 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed"."link_ticket_flights" ("link_ticket_flights_pk", "ticket_no", "flight_id", "load_date", "record_source")
    (
        select "link_ticket_flights_pk", "ticket_no", "flight_id", "load_date", "record_source"
        from "link_ticket_flights__dbt_tmp124251038604"
    )


  
[0m12:42:51.155155 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:42:51.155980 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:42:51.156179 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:42:51.156330 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:42:51.159510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:51.159996 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: Close
[0m12:42:51.160531 [info ] [Thread-1 (]: 32 of 36 OK created sql incremental model dwh_detailed.link_ticket_flights ..... [[32mINSERT 0 0[0m in 0.14s]
[0m12:42:51.160855 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_flights
[0m12:42:51.161066 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_data
[0m12:42:51.161331 [info ] [Thread-1 (]: 33 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_data ...... [RUN]
[0m12:42:51.161697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_flights, now model.dbtvault.sat_ticket_flights_data)
[0m12:42:51.161877 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_data
[0m12:42:51.171999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.172506 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_data
[0m12:42:51.175454 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.175704 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

    
  
    

  create temporary table "sat_ticket_flights_data__dbt_tmp124251174279"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.LINK_TICKET_FLIGHTS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINK_TICKET_FLIGHTS_PK, current_records.TICKET_FLIGHTS_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.LINK_TICKET_FLIGHTS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_ticket_flights_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINK_TICKET_FLIGHTS_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINK_TICKET_FLIGHTS_PK = source_records.LINK_TICKET_FLIGHTS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_PK, stage.TICKET_FLIGHTS_HASHDIFF, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.LINK_TICKET_FLIGHTS_PK = stage.LINK_TICKET_FLIGHTS_PK
        AND latest_records.TICKET_FLIGHTS_HASHDIFF = stage.TICKET_FLIGHTS_HASHDIFF
    WHERE latest_records.TICKET_FLIGHTS_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:51.175895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:51.215701 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:42:51.218014 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.218272 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: BEGIN
[0m12:42:51.218923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:51.219173 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.219348 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data__dbt_tmp124251174279'
        
      order by ordinal_position

  
[0m12:42:51.289365 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.070 seconds
[0m12:42:51.291891 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.292128 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.298164 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:42:51.300806 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.301024 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.306676 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:42:51.307891 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.308246 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.308445 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      insert into "postgres"."dwh_detailed"."sat_ticket_flights_data" ("link_ticket_flights_pk", "ticket_flights_hashdiff", "fare_conditions", "amount", "effective_from", "load_date", "record_source")
    (
        select "link_ticket_flights_pk", "ticket_flights_hashdiff", "fare_conditions", "amount", "effective_from", "load_date", "record_source"
        from "sat_ticket_flights_data__dbt_tmp124251174279"
    )


  
[0m12:42:51.312185 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:51.313026 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:42:51.313225 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:42:51.313394 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:42:51.316252 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:51.316734 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: Close
[0m12:42:51.317247 [info ] [Thread-1 (]: 33 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_data . [[32mINSERT 0 0[0m in 0.16s]
[0m12:42:51.317626 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_data
[0m12:42:51.317841 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_ticket
[0m12:42:51.318097 [info ] [Thread-1 (]: 34 of 36 START sql incremental model dwh_detailed.hub_ticket ................... [RUN]
[0m12:42:51.318372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_data, now model.dbtvault.hub_ticket)
[0m12:42:51.318583 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_ticket
[0m12:42:51.325216 [info ] [Thread-1 (]: 12:42:51 + Loading postgres.dwh_detailed.hub_ticket from 1 source(s)
[0m12:42:51.327757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_ticket"
[0m12:42:51.328140 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_ticket
[0m12:42:51.330988 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:42:51.331210 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

    
  
    

  create temporary table "hub_ticket__dbt_tmp124251329878"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.TICKET_PK IS NOT NULL
    ORDER BY rr.TICKET_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.TICKET_PK, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_ticket" AS d
    ON a.TICKET_PK = d.TICKET_PK
    WHERE d.TICKET_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:51.331385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:51.351356 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m12:42:51.354182 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:42:51.354434 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: BEGIN
[0m12:42:51.355117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:42:51.355338 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:42:51.355500 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_ticket__dbt_tmp124251329878'
        
      order by ordinal_position

  
[0m12:42:51.363878 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:42:51.366218 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:42:51.366458 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_ticket'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.372548 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:42:51.375001 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:42:51.375275 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_ticket'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.381212 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:42:51.382382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_ticket"
[0m12:42:51.382741 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:42:51.382918 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      insert into "postgres"."dwh_detailed"."hub_ticket" ("ticket_pk", "ticket_no", "load_date", "record_source")
    (
        select "ticket_pk", "ticket_no", "load_date", "record_source"
        from "hub_ticket__dbt_tmp124251329878"
    )


  
[0m12:42:51.385080 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:42:51.385914 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:42:51.386109 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:42:51.386262 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:42:51.389262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:42:51.389759 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: Close
[0m12:42:51.390297 [info ] [Thread-1 (]: 34 of 36 OK created sql incremental model dwh_detailed.hub_ticket .............. [[32mINSERT 0 0[0m in 0.07s]
[0m12:42:51.390642 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_ticket
[0m12:42:51.390859 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_booking
[0m12:42:51.391128 [info ] [Thread-1 (]: 35 of 36 START sql incremental model dwh_detailed.link_ticket_booking .......... [RUN]
[0m12:42:51.391483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_ticket, now model.dbtvault.link_ticket_booking)
[0m12:42:51.392049 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_booking
[0m12:42:51.395689 [info ] [Thread-1 (]: 12:42:51 + Loading postgres.dwh_detailed.link_ticket_booking from 1 source(s)
[0m12:42:51.398282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_booking"
[0m12:42:51.398594 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_booking
[0m12:42:51.401956 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:42:51.402233 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

    
  
    

  create temporary table "link_ticket_booking__dbt_tmp124251400769"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_BOOKING_PK, rr.ticket_no, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_BOOKING_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.LINK_TICKET_BOOKING_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_BOOKING_PK, a.ticket_no, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_ticket_booking" AS d
    ON a.LINK_TICKET_BOOKING_PK = d.LINK_TICKET_BOOKING_PK
    WHERE d.LINK_TICKET_BOOKING_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:51.402419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:51.434596 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m12:42:51.436852 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:42:51.437115 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: BEGIN
[0m12:42:51.437866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:42:51.438135 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:42:51.438333 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking__dbt_tmp124251400769'
        
      order by ordinal_position

  
[0m12:42:51.496972 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.058 seconds
[0m12:42:51.499358 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:42:51.499581 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.505471 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:42:51.507621 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:42:51.507845 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:42:51.513395 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:42:51.514610 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_booking"
[0m12:42:51.514964 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:42:51.515148 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      insert into "postgres"."dwh_detailed"."link_ticket_booking" ("link_ticket_booking_pk", "ticket_no", "book_ref", "load_date", "record_source")
    (
        select "link_ticket_booking_pk", "ticket_no", "book_ref", "load_date", "record_source"
        from "link_ticket_booking__dbt_tmp124251400769"
    )


  
[0m12:42:51.518870 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:42:51.519706 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:42:51.519911 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:42:51.520070 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:42:51.522750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:42:51.523256 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: Close
[0m12:42:51.523827 [info ] [Thread-1 (]: 35 of 36 OK created sql incremental model dwh_detailed.link_ticket_booking ..... [[32mINSERT 0 0[0m in 0.13s]
[0m12:42:51.524149 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_booking
[0m12:42:51.524358 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_data
[0m12:42:51.524727 [info ] [Thread-1 (]: 36 of 36 START sql incremental model dwh_detailed.sat_ticket_data .............. [RUN]
[0m12:42:51.524987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_booking, now model.dbtvault.sat_ticket_data)
[0m12:42:51.525169 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_data
[0m12:42:51.569368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_data"
[0m12:42:51.569794 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_data
[0m12:42:51.572505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_data"
[0m12:42:51.572835 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:42:51.573016 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: BEGIN
[0m12:42:51.573179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:51.576992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:42:51.577223 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:42:51.577430 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_PK, a.TICKETHASHDIFF, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS a
    WHERE a.TICKET_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_PK, stage.TICKETHASHDIFF, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:42:51.578531 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not identify an equality operator for type json
LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                              ^

[0m12:42:51.578750 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: ROLLBACK
[0m12:42:51.579257 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: Close
[0m12:42:51.582575 [debug] [Thread-1 (]: Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql
[0m12:42:51.583044 [error] [Thread-1 (]: 36 of 36 ERROR creating sql incremental model dwh_detailed.sat_ticket_data ..... [[31mERROR[0m in 0.06s]
[0m12:42:51.583374 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_data
[0m12:42:51.583728 [debug] [Thread-4 (]: Marking all children of 'model.dbtvault.sat_ticket_data' to be skipped because of status 'error'.  Reason: Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql.
[0m12:42:51.585028 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:51.585210 [debug] [MainThread]: On master: BEGIN
[0m12:42:51.585341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:42:51.588800 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:42:51.589001 [debug] [MainThread]: On master: COMMIT
[0m12:42:51.589149 [debug] [MainThread]: Using postgres connection "master"
[0m12:42:51.589285 [debug] [MainThread]: On master: COMMIT
[0m12:42:51.589671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:51.589864 [debug] [MainThread]: On master: Close
[0m12:42:51.590101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:51.590239 [debug] [MainThread]: Connection 'model.dbtvault.sat_ticket_data' was properly closed.
[0m12:42:51.590479 [info ] [MainThread]: 
[0m12:42:51.590663 [info ] [MainThread]: Finished running 20 incremental models, 8 table models, 8 view models in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m12:42:51.593752 [debug] [MainThread]: Command end result
[0m12:42:51.616362 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:42:51.617582 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:42:51.622211 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/user/dwh/dbt/target/run_results.json
[0m12:42:51.622457 [info ] [MainThread]: 
[0m12:42:51.622676 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:51.622855 [info ] [MainThread]: 
[0m12:42:51.623063 [error] [MainThread]:   Database Error in model sat_ticket_data (models/raw_vault/sats/sat_ticket_data.sql)
  could not identify an equality operator for type json
  LINE 22: ...SHDIFF, stage.passenger_id, stage.passenger_name, stage.cont...
                                                                ^
  compiled code at target/run/dbtvault/models/raw_vault/sats/sat_ticket_data.sql
[0m12:42:51.623243 [info ] [MainThread]: 
[0m12:42:51.623434 [info ] [MainThread]: Done. PASS=35 WARN=0 ERROR=1 SKIP=0 TOTAL=36
[0m12:42:51.624616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.236065, "process_in_blocks": "69712", "process_kernel_time": 0.084624, "process_mem_max_rss": "121420", "process_out_blocks": "7416", "process_user_time": 2.4071}
[0m12:42:51.624867 [debug] [MainThread]: Command `dbt run` failed at 12:42:51.624811 after 4.24 seconds
[0m12:42:51.625053 [debug] [MainThread]: Flushing usage events


============================== 12:43:42.021368 | be4d476b-bd36-4da2-adb7-4d21f530f86f ==============================
[0m12:43:42.021368 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:43:42.023859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/user/dwh/dbt/logs', 'profiles_dir': '/home/user/dwh/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m12:43:42.024095 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:43:42.189518 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:43:42.243668 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:43:42.368644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:43:42.369152 [debug] [MainThread]: Partial parsing: updated file: dbtvault://models/raw_stage/tickets.sql
[0m12:43:42.511052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m12:43:42.596721 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:43:42.598469 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:43:42.611207 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m12:43:42.612765 [info ] [MainThread]: 
[0m12:43:42.613020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:42.613179 [info ] [MainThread]: 
[0m12:43:42.613479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:42.616966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:43:42.631114 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:43:42.631392 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:43:42.631538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:42.642381 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m12:43:42.643222 [debug] [ThreadPool]: On list_postgres: Close
[0m12:43:42.645423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed)
[0m12:43:42.649173 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:43:42.649365 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m12:43:42.649502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:42.653438 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.653636 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:43:42.653793 [debug] [ThreadPool]: On list_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed'
  
[0m12:43:42.658491 [debug] [ThreadPool]: SQL status: SELECT 35 in 0.005 seconds
[0m12:43:42.659477 [debug] [ThreadPool]: On list_postgres_dwh_detailed: ROLLBACK
[0m12:43:42.659979 [debug] [ThreadPool]: On list_postgres_dwh_detailed: Close
[0m12:43:42.666160 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:42.666356 [debug] [MainThread]: On master: BEGIN
[0m12:43:42.666499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:42.670052 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.670274 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:42.670476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:42.677737 [debug] [MainThread]: SQL status: SELECT 61 in 0.007 seconds
[0m12:43:42.679818 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:42.680326 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:42.680549 [debug] [MainThread]: On master: BEGIN
[0m12:43:42.681276 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:43:42.681458 [debug] [MainThread]: On master: COMMIT
[0m12:43:42.681608 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:42.681740 [debug] [MainThread]: On master: COMMIT
[0m12:43:42.682272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:42.682445 [debug] [MainThread]: On master: Close
[0m12:43:42.683850 [debug] [Thread-1 (]: Began running node model.dbtvault.aircrafts
[0m12:43:42.684340 [info ] [Thread-1 (]: 1 of 36 START sql table model dwh_detailed.aircrafts ........................... [RUN]
[0m12:43:42.684650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed, now model.dbtvault.aircrafts)
[0m12:43:42.684834 [debug] [Thread-1 (]: Began compiling node model.dbtvault.aircrafts
[0m12:43:42.689937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.aircrafts"
[0m12:43:42.690714 [debug] [Thread-1 (]: Began executing node model.dbtvault.aircrafts
[0m12:43:42.711212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.aircrafts"
[0m12:43:42.711619 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:43:42.711816 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: BEGIN
[0m12:43:42.711973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:42.715824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.716069 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:43:42.716250 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */

  
    

  create  table "postgres"."dwh_detailed"."aircrafts__dbt_tmp"
  
  
    as
  
  (
    SELECT aircraft_code, model::jsonb as model, range
FROM "postgres"."public"."postgres_public_aircrafts"
  );
  
[0m12:43:42.738142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m12:43:42.742662 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:43:42.742932 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts" rename to "aircrafts__dbt_backup"
[0m12:43:42.744642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.747053 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:43:42.747252 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts__dbt_tmp" rename to "aircrafts"
[0m12:43:42.748148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.759666 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:43:42.759927 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:43:42.760096 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:43:42.763794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:42.767656 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."aircrafts__dbt_backup"
[0m12:43:42.770183 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:43:42.770410 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
drop table if exists "postgres"."dwh_detailed"."aircrafts__dbt_backup" cascade
[0m12:43:42.775739 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:43:42.777408 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: Close
[0m12:43:42.779295 [info ] [Thread-1 (]: 1 of 36 OK created sql table model dwh_detailed.aircrafts ...................... [[32mSELECT 1[0m in 0.09s]
[0m12:43:42.779825 [debug] [Thread-1 (]: Finished running node model.dbtvault.aircrafts
[0m12:43:42.780060 [debug] [Thread-1 (]: Began running node model.dbtvault.airports
[0m12:43:42.780447 [info ] [Thread-1 (]: 2 of 36 START sql table model dwh_detailed.airports ............................ [RUN]
[0m12:43:42.780871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.aircrafts, now model.dbtvault.airports)
[0m12:43:42.781057 [debug] [Thread-1 (]: Began compiling node model.dbtvault.airports
[0m12:43:42.783045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.airports"
[0m12:43:42.783372 [debug] [Thread-1 (]: Began executing node model.dbtvault.airports
[0m12:43:42.785857 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.airports"
[0m12:43:42.786164 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:43:42.786342 [debug] [Thread-1 (]: On model.dbtvault.airports: BEGIN
[0m12:43:42.786498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:42.790404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.790702 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:43:42.790877 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */

  
    

  create  table "postgres"."dwh_detailed"."airports__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_airports"
  );
  
[0m12:43:42.809262 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m12:43:42.812357 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:43:42.812625 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports" rename to "airports__dbt_backup"
[0m12:43:42.814017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.816074 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:43:42.816284 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports__dbt_tmp" rename to "airports"
[0m12:43:42.817188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.818102 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:43:42.818308 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:43:42.818463 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:43:42.821848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:42.823589 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."airports__dbt_backup"
[0m12:43:42.824029 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:43:42.824225 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
drop table if exists "postgres"."dwh_detailed"."airports__dbt_backup" cascade
[0m12:43:42.829535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:43:42.830519 [debug] [Thread-1 (]: On model.dbtvault.airports: Close
[0m12:43:42.831081 [info ] [Thread-1 (]: 2 of 36 OK created sql table model dwh_detailed.airports ....................... [[32mSELECT 2[0m in 0.05s]
[0m12:43:42.831433 [debug] [Thread-1 (]: Finished running node model.dbtvault.airports
[0m12:43:42.831667 [debug] [Thread-1 (]: Began running node model.dbtvault.boarding_passes
[0m12:43:42.832189 [info ] [Thread-1 (]: 3 of 36 START sql table model dwh_detailed.boarding_passes ..................... [RUN]
[0m12:43:42.832499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.airports, now model.dbtvault.boarding_passes)
[0m12:43:42.832719 [debug] [Thread-1 (]: Began compiling node model.dbtvault.boarding_passes
[0m12:43:42.834657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.boarding_passes"
[0m12:43:42.834996 [debug] [Thread-1 (]: Began executing node model.dbtvault.boarding_passes
[0m12:43:42.837565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.boarding_passes"
[0m12:43:42.837918 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:43:42.838134 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: BEGIN
[0m12:43:42.838288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:42.842192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.842491 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:43:42.842662 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */

  
    

  create  table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_boarding_passes"
  );
  
[0m12:43:42.859510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:43:42.862641 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:43:42.862900 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes" rename to "boarding_passes__dbt_backup"
[0m12:43:42.864294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.866543 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:43:42.866746 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp" rename to "boarding_passes"
[0m12:43:42.867666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.868622 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:43:42.868828 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:43:42.868981 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:43:42.871999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:42.873658 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."boarding_passes__dbt_backup"
[0m12:43:42.874063 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:43:42.874241 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
drop table if exists "postgres"."dwh_detailed"."boarding_passes__dbt_backup" cascade
[0m12:43:42.878910 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:43:42.879751 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: Close
[0m12:43:42.880295 [info ] [Thread-1 (]: 3 of 36 OK created sql table model dwh_detailed.boarding_passes ................ [[32mSELECT 1[0m in 0.05s]
[0m12:43:42.880652 [debug] [Thread-1 (]: Finished running node model.dbtvault.boarding_passes
[0m12:43:42.880876 [debug] [Thread-1 (]: Began running node model.dbtvault.bookings
[0m12:43:42.881447 [info ] [Thread-1 (]: 4 of 36 START sql table model dwh_detailed.bookings ............................ [RUN]
[0m12:43:42.882074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.boarding_passes, now model.dbtvault.bookings)
[0m12:43:42.882288 [debug] [Thread-1 (]: Began compiling node model.dbtvault.bookings
[0m12:43:42.884297 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.bookings"
[0m12:43:42.884604 [debug] [Thread-1 (]: Began executing node model.dbtvault.bookings
[0m12:43:42.887559 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.bookings"
[0m12:43:42.887863 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:43:42.888035 [debug] [Thread-1 (]: On model.dbtvault.bookings: BEGIN
[0m12:43:42.888181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:42.891866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.892111 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:43:42.892279 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */

  
    

  create  table "postgres"."dwh_detailed"."bookings__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_bookings"
  );
  
[0m12:43:42.909952 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:43:42.912473 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:43:42.912750 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings" rename to "bookings__dbt_backup"
[0m12:43:42.914071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.916113 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:43:42.916314 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings__dbt_tmp" rename to "bookings"
[0m12:43:42.917169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.918036 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:43:42.918243 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:43:42.918404 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:43:42.921423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:42.923131 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."bookings__dbt_backup"
[0m12:43:42.923528 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:43:42.923706 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
drop table if exists "postgres"."dwh_detailed"."bookings__dbt_backup" cascade
[0m12:43:42.928223 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m12:43:42.929023 [debug] [Thread-1 (]: On model.dbtvault.bookings: Close
[0m12:43:42.929539 [info ] [Thread-1 (]: 4 of 36 OK created sql table model dwh_detailed.bookings ....................... [[32mSELECT 1[0m in 0.05s]
[0m12:43:42.929887 [debug] [Thread-1 (]: Finished running node model.dbtvault.bookings
[0m12:43:42.930107 [debug] [Thread-1 (]: Began running node model.dbtvault.flights
[0m12:43:42.930727 [info ] [Thread-1 (]: 5 of 36 START sql table model dwh_detailed.flights ............................. [RUN]
[0m12:43:42.931443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.bookings, now model.dbtvault.flights)
[0m12:43:42.931651 [debug] [Thread-1 (]: Began compiling node model.dbtvault.flights
[0m12:43:42.933606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.flights"
[0m12:43:42.933942 [debug] [Thread-1 (]: Began executing node model.dbtvault.flights
[0m12:43:42.936867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.flights"
[0m12:43:42.937196 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:43:42.937378 [debug] [Thread-1 (]: On model.dbtvault.flights: BEGIN
[0m12:43:42.937525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:42.942067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.942329 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:43:42.942535 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */

  
    

  create  table "postgres"."dwh_detailed"."flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_flights"
  );
  
[0m12:43:42.961240 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:43:42.963817 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:43:42.964077 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights" rename to "flights__dbt_backup"
[0m12:43:42.965465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.967782 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:43:42.967987 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights__dbt_tmp" rename to "flights"
[0m12:43:42.968855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:42.969749 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:43:42.969949 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:43:42.970103 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:43:42.972914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:42.974678 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."flights__dbt_backup"
[0m12:43:42.975057 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:43:42.975238 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
drop table if exists "postgres"."dwh_detailed"."flights__dbt_backup" cascade
[0m12:43:42.980137 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:43:42.980981 [debug] [Thread-1 (]: On model.dbtvault.flights: Close
[0m12:43:42.981511 [info ] [Thread-1 (]: 5 of 36 OK created sql table model dwh_detailed.flights ........................ [[32mSELECT 1[0m in 0.05s]
[0m12:43:42.981864 [debug] [Thread-1 (]: Finished running node model.dbtvault.flights
[0m12:43:42.982083 [debug] [Thread-1 (]: Began running node model.dbtvault.seats
[0m12:43:42.982660 [info ] [Thread-1 (]: 6 of 36 START sql table model dwh_detailed.seats ............................... [RUN]
[0m12:43:42.983397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.flights, now model.dbtvault.seats)
[0m12:43:42.983664 [debug] [Thread-1 (]: Began compiling node model.dbtvault.seats
[0m12:43:42.986073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.seats"
[0m12:43:42.986385 [debug] [Thread-1 (]: Began executing node model.dbtvault.seats
[0m12:43:42.988814 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.seats"
[0m12:43:42.989122 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:43:42.989324 [debug] [Thread-1 (]: On model.dbtvault.seats: BEGIN
[0m12:43:42.989475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:42.993449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:42.993685 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:43:42.993871 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */

  
    

  create  table "postgres"."dwh_detailed"."seats__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_seats"
  );
  
[0m12:43:43.011448 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:43:43.014011 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:43:43.014253 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats" rename to "seats__dbt_backup"
[0m12:43:43.015672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.018075 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:43:43.018275 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats__dbt_tmp" rename to "seats"
[0m12:43:43.019211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.020197 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:43:43.020399 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:43:43.020560 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:43:43.024065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.026209 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."seats__dbt_backup"
[0m12:43:43.026594 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:43:43.026770 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
drop table if exists "postgres"."dwh_detailed"."seats__dbt_backup" cascade
[0m12:43:43.031487 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:43:43.032282 [debug] [Thread-1 (]: On model.dbtvault.seats: Close
[0m12:43:43.032827 [info ] [Thread-1 (]: 6 of 36 OK created sql table model dwh_detailed.seats .......................... [[32mSELECT 1[0m in 0.05s]
[0m12:43:43.033200 [debug] [Thread-1 (]: Finished running node model.dbtvault.seats
[0m12:43:43.033419 [debug] [Thread-1 (]: Began running node model.dbtvault.ticket_flights
[0m12:43:43.033950 [info ] [Thread-1 (]: 7 of 36 START sql table model dwh_detailed.ticket_flights ...................... [RUN]
[0m12:43:43.034264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.seats, now model.dbtvault.ticket_flights)
[0m12:43:43.034490 [debug] [Thread-1 (]: Began compiling node model.dbtvault.ticket_flights
[0m12:43:43.036429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.ticket_flights"
[0m12:43:43.036757 [debug] [Thread-1 (]: Began executing node model.dbtvault.ticket_flights
[0m12:43:43.039187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.ticket_flights"
[0m12:43:43.039497 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:43:43.039686 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: BEGIN
[0m12:43:43.039866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.044298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.044580 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:43:43.044749 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */

  
    

  create  table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "postgres"."public"."postgres_public_ticket_flights"
  );
  
[0m12:43:43.062058 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:43:43.064606 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:43:43.064844 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights" rename to "ticket_flights__dbt_backup"
[0m12:43:43.066215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.068517 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:43:43.068723 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp" rename to "ticket_flights"
[0m12:43:43.069640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.070556 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:43:43.070759 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:43:43.070915 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:43:43.074500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.108581 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."ticket_flights__dbt_backup"
[0m12:43:43.109086 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:43:43.109280 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
drop table if exists "postgres"."dwh_detailed"."ticket_flights__dbt_backup" cascade
[0m12:43:43.114635 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:43:43.115550 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: Close
[0m12:43:43.116090 [info ] [Thread-1 (]: 7 of 36 OK created sql table model dwh_detailed.ticket_flights ................. [[32mSELECT 1[0m in 0.08s]
[0m12:43:43.116424 [debug] [Thread-1 (]: Finished running node model.dbtvault.ticket_flights
[0m12:43:43.116639 [debug] [Thread-1 (]: Began running node model.dbtvault.tickets
[0m12:43:43.117207 [info ] [Thread-1 (]: 8 of 36 START sql table model dwh_detailed.tickets ............................. [RUN]
[0m12:43:43.117828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.ticket_flights, now model.dbtvault.tickets)
[0m12:43:43.118038 [debug] [Thread-1 (]: Began compiling node model.dbtvault.tickets
[0m12:43:43.119934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.tickets"
[0m12:43:43.120250 [debug] [Thread-1 (]: Began executing node model.dbtvault.tickets
[0m12:43:43.122685 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.tickets"
[0m12:43:43.123121 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:43:43.123304 [debug] [Thread-1 (]: On model.dbtvault.tickets: BEGIN
[0m12:43:43.123452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.127390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.127632 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:43:43.127820 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */

  
    

  create  table "postgres"."dwh_detailed"."tickets__dbt_tmp"
  
  
    as
  
  (
    SELECT ticket_no, book_ref, passenger_id, passenger_name, contact_data::jsonb as contact_data
FROM "postgres"."public"."postgres_public_tickets"
  );
  
[0m12:43:43.145442 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:43:43.147982 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:43:43.148229 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets" rename to "tickets__dbt_backup"
[0m12:43:43.149419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.151859 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:43:43.152082 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets__dbt_tmp" rename to "tickets"
[0m12:43:43.152985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.153888 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:43:43.154089 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:43:43.154243 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:43:43.157567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.159290 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."tickets__dbt_backup"
[0m12:43:43.159672 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:43:43.159848 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
drop table if exists "postgres"."dwh_detailed"."tickets__dbt_backup" cascade
[0m12:43:43.164635 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:43:43.165492 [debug] [Thread-1 (]: On model.dbtvault.tickets: Close
[0m12:43:43.166026 [info ] [Thread-1 (]: 8 of 36 OK created sql table model dwh_detailed.tickets ........................ [[32mSELECT 1[0m in 0.05s]
[0m12:43:43.166656 [debug] [Thread-1 (]: Finished running node model.dbtvault.tickets
[0m12:43:43.167159 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_aircrafts
[0m12:43:43.167773 [info ] [Thread-1 (]: 9 of 36 START sql view model dwh_detailed.stg_aircrafts ........................ [RUN]
[0m12:43:43.168415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.tickets, now model.dbtvault.stg_aircrafts)
[0m12:43:43.168629 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_aircrafts
[0m12:43:43.191001 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:43:43.191272 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: BEGIN
[0m12:43:43.191444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.195507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.195779 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:43:43.195964 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.207302 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:43:43.237934 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:43:43.238243 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.245146 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m12:43:43.274047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_aircrafts"
[0m12:43:43.274480 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_aircrafts
[0m12:43:43.284649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_aircrafts"
[0m12:43:43.284996 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:43:43.285206 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

  create view "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed"."aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS AIRCRAFT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRCRAFT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    AIRCRAFT_PK,
    AIRCRAFT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.293365 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:43:43.295749 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:43:43.295986 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
alter table "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m12:43:43.297256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.298124 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:43:43.298332 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:43:43.298489 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:43:43.301579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.303702 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup"
[0m12:43:43.306113 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:43:43.306480 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m12:43:43.308382 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:43:43.309223 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: Close
[0m12:43:43.309791 [info ] [Thread-1 (]: 9 of 36 OK created sql view model dwh_detailed.stg_aircrafts ................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:43:43.310472 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_aircrafts
[0m12:43:43.310962 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_airports
[0m12:43:43.311757 [info ] [Thread-1 (]: 10 of 36 START sql view model dwh_detailed.stg_airports ........................ [RUN]
[0m12:43:43.312096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_aircrafts, now model.dbtvault.stg_airports)
[0m12:43:43.312286 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_airports
[0m12:43:43.317259 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:43:43.317477 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: BEGIN
[0m12:43:43.317639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.321605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.321872 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:43:43.322052 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.333349 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.011 seconds
[0m12:43:43.336761 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:43:43.337013 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.343255 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:43:43.347377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_airports"
[0m12:43:43.347736 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_airports
[0m12:43:43.350138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_airports"
[0m12:43:43.350478 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:43:43.350689 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

  create view "postgres"."dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed"."airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    AIRPORT_PK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.357694 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:43:43.360358 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:43:43.360591 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
alter table "postgres"."dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m12:43:43.361798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.362628 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:43:43.362862 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:43:43.363059 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:43:43.365780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.367356 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_airports__dbt_backup"
[0m12:43:43.367747 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:43:43.367925 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
drop view if exists "postgres"."dwh_detailed"."stg_airports__dbt_backup" cascade
[0m12:43:43.369180 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:43:43.369955 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: Close
[0m12:43:43.370469 [info ] [Thread-1 (]: 10 of 36 OK created sql view model dwh_detailed.stg_airports ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:43:43.370807 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_airports
[0m12:43:43.371019 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_boarding_passes
[0m12:43:43.371573 [info ] [Thread-1 (]: 11 of 36 START sql view model dwh_detailed.stg_boarding_passes ................. [RUN]
[0m12:43:43.372274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_airports, now model.dbtvault.stg_boarding_passes)
[0m12:43:43.372518 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_boarding_passes
[0m12:43:43.376841 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:43:43.377050 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: BEGIN
[0m12:43:43.377239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.380924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.381144 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:43:43.381327 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.392683 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:43:43.396468 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:43:43.396703 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.404564 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m12:43:43.408644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_boarding_passes"
[0m12:43:43.409072 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_boarding_passes
[0m12:43:43.411702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_boarding_passes"
[0m12:43:43.412026 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:43:43.412232 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed"."boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS TICKET_FLIGHTS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOARDING_PASSES_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    TICKET_FLIGHTS_PK,
    BOARDING_PASSES_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.419089 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:43:43.421371 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:43:43.421604 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m12:43:43.422741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.423619 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:43:43.423823 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:43:43.423993 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:43:43.426992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.429036 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m12:43:43.429449 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:43:43.429631 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m12:43:43.430888 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:43:43.431694 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: Close
[0m12:43:43.432228 [info ] [Thread-1 (]: 11 of 36 OK created sql view model dwh_detailed.stg_boarding_passes ............ [[32mCREATE VIEW[0m in 0.06s]
[0m12:43:43.432567 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_boarding_passes
[0m12:43:43.432778 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_bookings
[0m12:43:43.433077 [info ] [Thread-1 (]: 12 of 36 START sql view model dwh_detailed.stg_bookings ........................ [RUN]
[0m12:43:43.433694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_boarding_passes, now model.dbtvault.stg_bookings)
[0m12:43:43.434278 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_bookings
[0m12:43:43.438625 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:43:43.438858 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: BEGIN
[0m12:43:43.439019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.442694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.442967 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:43:43.443161 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.454387 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:43:43.457687 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:43:43.457921 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.464026 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:43:43.467132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_bookings"
[0m12:43:43.467528 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_bookings
[0m12:43:43.470438 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_bookings"
[0m12:43:43.470755 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:43:43.470951 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

  create view "postgres"."dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed"."bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS BOOK_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOOK_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    BOOK_PK,
    BOOK_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.477561 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:43:43.479700 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:43:43.479916 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
alter table "postgres"."dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m12:43:43.481023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.481827 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:43:43.482025 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:43:43.482201 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:43:43.485186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.486788 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_bookings__dbt_backup"
[0m12:43:43.487188 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:43:43.487376 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m12:43:43.488741 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:43:43.489513 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: Close
[0m12:43:43.490037 [info ] [Thread-1 (]: 12 of 36 OK created sql view model dwh_detailed.stg_bookings ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:43:43.490723 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_bookings
[0m12:43:43.491147 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_flights
[0m12:43:43.491867 [info ] [Thread-1 (]: 13 of 36 START sql view model dwh_detailed.stg_flights ......................... [RUN]
[0m12:43:43.492387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_bookings, now model.dbtvault.stg_flights)
[0m12:43:43.492652 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_flights
[0m12:43:43.497724 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:43:43.497952 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: BEGIN
[0m12:43:43.498115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.501863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.502112 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:43:43.502288 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.513751 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m12:43:43.517381 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:43:43.517617 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.524201 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:43:43.531587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_flights"
[0m12:43:43.531927 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_flights
[0m12:43:43.534759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_flights"
[0m12:43:43.535096 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:43:43.535343 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

  create view "postgres"."dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed"."flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS FLIGHT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS FLIGHT_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_AIRCRAFT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_ARRIVAL_AIRPORT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    FLIGHT_PK,
    FLIGHT_HASHDIFF,
    LINK_FLIGHT_AIRCRAFT_PK,
    LINK_FLIGHT_ARRIVAL_AIRPORT_PK,
    LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.545115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:43:43.547456 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:43:43.547699 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
alter table "postgres"."dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m12:43:43.549081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.549915 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:43:43.550117 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:43:43.550275 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:43:43.553648 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.555386 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_flights__dbt_backup"
[0m12:43:43.555765 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:43:43.555958 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_flights__dbt_backup" cascade
[0m12:43:43.557325 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:43:43.558145 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: Close
[0m12:43:43.558675 [info ] [Thread-1 (]: 13 of 36 OK created sql view model dwh_detailed.stg_flights .................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:43:43.559038 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_flights
[0m12:43:43.559256 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_seats
[0m12:43:43.559878 [info ] [Thread-1 (]: 14 of 36 START sql view model dwh_detailed.stg_seats ........................... [RUN]
[0m12:43:43.560716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_flights, now model.dbtvault.stg_seats)
[0m12:43:43.560913 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_seats
[0m12:43:43.565465 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:43:43.565686 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: BEGIN
[0m12:43:43.565845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.569442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.569689 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:43:43.569868 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.581113 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:43:43.584945 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:43:43.585172 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.591311 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:43:43.595678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_seats"
[0m12:43:43.596022 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_seats
[0m12:43:43.598558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_seats"
[0m12:43:43.598861 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:43:43.599122 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

  create view "postgres"."dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed"."seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS SEAT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_SEAT_AIRCRAFT_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')), 'hex') AS SEAT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    SEAT_PK,
    LINK_SEAT_AIRCRAFT_PK,
    SEAT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.605849 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:43:43.608049 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:43:43.608275 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
alter table "postgres"."dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m12:43:43.609358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.610252 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:43:43.610453 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:43:43.610612 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:43:43.613342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.649578 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_seats__dbt_backup"
[0m12:43:43.650126 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:43:43.650312 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
drop view if exists "postgres"."dwh_detailed"."stg_seats__dbt_backup" cascade
[0m12:43:43.652111 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:43:43.652990 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: Close
[0m12:43:43.653520 [info ] [Thread-1 (]: 14 of 36 OK created sql view model dwh_detailed.stg_seats ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:43:43.653862 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_seats
[0m12:43:43.654091 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_ticket_flights
[0m12:43:43.654374 [info ] [Thread-1 (]: 15 of 36 START sql view model dwh_detailed.stg_ticket_flights .................. [RUN]
[0m12:43:43.654660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_seats, now model.dbtvault.stg_ticket_flights)
[0m12:43:43.654843 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_ticket_flights
[0m12:43:43.659242 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:43:43.659640 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: BEGIN
[0m12:43:43.659922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.663798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.664027 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:43:43.664196 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.675229 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:43:43.678485 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:43:43.678719 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.684919 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:43:43.689424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_ticket_flights"
[0m12:43:43.689792 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_ticket_flights
[0m12:43:43.692225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_ticket_flights"
[0m12:43:43.692527 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:43:43.692733 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed"."ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKET_FLIGHTS_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    TICKET_FLIGHTS_HASHDIFF,
    LINK_TICKET_FLIGHTS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.700200 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:43:43.702463 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:43:43.702692 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m12:43:43.703988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.704817 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:43:43.705019 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:43:43.705176 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:43:43.708896 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:43:43.710531 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m12:43:43.710926 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:43:43.711103 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m12:43:43.712416 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:43:43.713237 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: Close
[0m12:43:43.713776 [info ] [Thread-1 (]: 15 of 36 OK created sql view model dwh_detailed.stg_ticket_flights ............. [[32mCREATE VIEW[0m in 0.06s]
[0m12:43:43.714113 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_ticket_flights
[0m12:43:43.714332 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_tickets
[0m12:43:43.714605 [info ] [Thread-1 (]: 16 of 36 START sql view model dwh_detailed.stg_tickets ......................... [RUN]
[0m12:43:43.715410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_ticket_flights, now model.dbtvault.stg_tickets)
[0m12:43:43.715649 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_tickets
[0m12:43:43.720731 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:43:43.720946 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: BEGIN
[0m12:43:43.721107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.724818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:43.725088 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:43:43.725256 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.736662 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m12:43:43.740117 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:43:43.740376 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.746894 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:43:43.751303 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_tickets"
[0m12:43:43.751686 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_tickets
[0m12:43:43.754628 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_tickets"
[0m12:43:43.754960 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:43:43.755198 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

  create view "postgres"."dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed"."tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS TICKET_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_BOOKING_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKETHASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    TICKET_PK,
    LINK_TICKET_BOOKING_PK,
    TICKETHASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:43:43.762366 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:43:43.765125 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:43:43.765349 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
alter table "postgres"."dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m12:43:43.766557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:43:43.767378 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:43:43.767573 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:43:43.767730 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:43:43.770453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.772046 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_tickets__dbt_backup"
[0m12:43:43.772436 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:43:43.772626 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m12:43:43.773900 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:43:43.774661 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: Close
[0m12:43:43.775176 [info ] [Thread-1 (]: 16 of 36 OK created sql view model dwh_detailed.stg_tickets .................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:43:43.775513 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_tickets
[0m12:43:43.775744 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_aircraft
[0m12:43:43.776259 [info ] [Thread-1 (]: 17 of 36 START sql incremental model dwh_detailed.hub_aircraft ................. [RUN]
[0m12:43:43.777030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_tickets, now model.dbtvault.hub_aircraft)
[0m12:43:43.777258 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_aircraft
[0m12:43:43.789038 [info ] [Thread-1 (]: 12:43:43 + Loading postgres.dwh_detailed.hub_aircraft from 1 source(s)
[0m12:43:43.820183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_aircraft"
[0m12:43:43.820602 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_aircraft
[0m12:43:43.836261 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:43:43.836531 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

    
  
    

  create temporary table "hub_aircraft__dbt_tmp124343832877"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRCRAFT_PK) rr.AIRCRAFT_PK, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.AIRCRAFT_PK IS NOT NULL
    ORDER BY rr.AIRCRAFT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRCRAFT_PK, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_aircraft" AS d
    ON a.AIRCRAFT_PK = d.AIRCRAFT_PK
    WHERE d.AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:43.836715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.855446 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m12:43:43.857786 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:43:43.858065 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: BEGIN
[0m12:43:43.858780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:43.859036 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:43:43.859210 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft__dbt_tmp124343832877'
        
      order by ordinal_position

  
[0m12:43:43.867302 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:43:43.869464 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:43:43.869685 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.875595 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:43:43.880691 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:43:43.880945 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:43.887071 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:43:43.893534 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_aircraft"
[0m12:43:43.893910 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:43:43.894102 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      insert into "postgres"."dwh_detailed"."hub_aircraft" ("aircraft_pk", "aircraft_code", "load_date", "record_source")
    (
        select "aircraft_pk", "aircraft_code", "load_date", "record_source"
        from "hub_aircraft__dbt_tmp124343832877"
    )


  
[0m12:43:43.896546 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:43:43.897403 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:43:43.897623 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:43:43.897779 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:43:43.901054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:43.901534 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: Close
[0m12:43:43.902084 [info ] [Thread-1 (]: 17 of 36 OK created sql incremental model dwh_detailed.hub_aircraft ............ [[32mINSERT 0 0[0m in 0.12s]
[0m12:43:43.902409 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_aircraft
[0m12:43:43.902644 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_aircraft_data
[0m12:43:43.902942 [info ] [Thread-1 (]: 18 of 36 START sql incremental model dwh_detailed.sat_aircraft_data ............ [RUN]
[0m12:43:43.903215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_aircraft, now model.dbtvault.sat_aircraft_data)
[0m12:43:43.903426 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_aircraft_data
[0m12:43:43.928644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_aircraft_data"
[0m12:43:43.929059 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_aircraft_data
[0m12:43:43.932323 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:43:43.932569 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

    
  
    

  create temporary table "sat_aircraft_data__dbt_tmp124343930704"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRCRAFT_PK, a.AIRCRAFT_HASHDIFF, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS a
    WHERE a.AIRCRAFT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.AIRCRAFT_PK, a.AIRCRAFT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.AIRCRAFT_PK, current_records.AIRCRAFT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.AIRCRAFT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_aircraft_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.AIRCRAFT_PK
                FROM source_data
            ) AS source_records
                ON current_records.AIRCRAFT_PK = source_records.AIRCRAFT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.AIRCRAFT_PK = stage.AIRCRAFT_PK
        AND latest_records.AIRCRAFT_HASHDIFF = stage.AIRCRAFT_HASHDIFF
    WHERE latest_records.AIRCRAFT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:43.932765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:43.973854 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m12:43:43.976220 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:43:43.976475 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: BEGIN
[0m12:43:43.977018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:43.977230 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:43:43.977394 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_aircraft_data__dbt_tmp124343930704'
        
      order by ordinal_position

  
[0m12:43:44.039491 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.062 seconds
[0m12:43:44.041972 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:43:44.042212 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_aircraft_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.048324 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:43:44.050609 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:43:44.050850 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_aircraft_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.056625 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:43:44.057964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_aircraft_data"
[0m12:43:44.058321 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:43:44.058515 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      insert into "postgres"."dwh_detailed"."sat_aircraft_data" ("aircraft_pk", "aircraft_hashdiff", "model", "range", "effective_from", "load_date", "record_source")
    (
        select "aircraft_pk", "aircraft_hashdiff", "model", "range", "effective_from", "load_date", "record_source"
        from "sat_aircraft_data__dbt_tmp124343930704"
    )


  
[0m12:43:44.062199 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:43:44.063179 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m12:43:44.063401 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:43:44.063573 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m12:43:44.066473 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:44.066989 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: Close
[0m12:43:44.067522 [info ] [Thread-1 (]: 18 of 36 OK created sql incremental model dwh_detailed.sat_aircraft_data ....... [[32mINSERT 0 0[0m in 0.16s]
[0m12:43:44.067840 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_aircraft_data
[0m12:43:44.068046 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_airport
[0m12:43:44.068465 [info ] [Thread-1 (]: 19 of 36 START sql incremental model dwh_detailed.hub_airport .................. [RUN]
[0m12:43:44.068739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_aircraft_data, now model.dbtvault.hub_airport)
[0m12:43:44.068918 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_airport
[0m12:43:44.075335 [info ] [Thread-1 (]: 12:43:44 + Loading postgres.dwh_detailed.hub_airport from 1 source(s)
[0m12:43:44.078603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_airport"
[0m12:43:44.079013 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_airport
[0m12:43:44.081855 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:43:44.082089 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

    
  
    

  create temporary table "hub_airport__dbt_tmp124344080717"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_PK) rr.AIRPORT_PK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS rr
    WHERE rr.AIRPORT_PK IS NOT NULL
    ORDER BY rr.AIRPORT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_PK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_airport" AS d
    ON a.AIRPORT_PK = d.AIRPORT_PK
    WHERE d.AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.082346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:44.105053 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.023 seconds
[0m12:43:44.107350 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:43:44.107624 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: BEGIN
[0m12:43:44.108186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:44.108394 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:43:44.108564 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport__dbt_tmp124344080717'
        
      order by ordinal_position

  
[0m12:43:44.183141 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.074 seconds
[0m12:43:44.185651 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:43:44.185870 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.191615 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:43:44.193733 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:43:44.193945 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.199660 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:43:44.201344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_airport"
[0m12:43:44.201696 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:43:44.201887 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      insert into "postgres"."dwh_detailed"."hub_airport" ("airport_pk", "airport_code", "load_date", "record_source")
    (
        select "airport_pk", "airport_code", "load_date", "record_source"
        from "hub_airport__dbt_tmp124344080717"
    )


  
[0m12:43:44.204386 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:43:44.205292 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:43:44.205495 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:43:44.205672 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:43:44.209306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:44.210284 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: Close
[0m12:43:44.210853 [info ] [Thread-1 (]: 19 of 36 OK created sql incremental model dwh_detailed.hub_airport ............. [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:44.211180 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_airport
[0m12:43:44.211389 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_airports_data
[0m12:43:44.211656 [info ] [Thread-1 (]: 20 of 36 START sql incremental model dwh_detailed.sat_airports_data ............ [RUN]
[0m12:43:44.212052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_airport, now model.dbtvault.sat_airports_data)
[0m12:43:44.212646 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_airports_data
[0m12:43:44.222228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_airports_data"
[0m12:43:44.222673 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_airports_data
[0m12:43:44.225486 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:43:44.225728 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

    
  
    

  create temporary table "sat_airports_data__dbt_tmp124344224318"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS a
    WHERE a.AIRPORT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.AIRPORT_PK, current_records.AIRPORT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.AIRPORT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_airports_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.AIRPORT_PK
                FROM source_data
            ) AS source_records
                ON current_records.AIRPORT_PK = source_records.AIRPORT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRPORT_PK, stage.AIRPORT_HASHDIFF, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.AIRPORT_PK = stage.AIRPORT_PK
        AND latest_records.AIRPORT_HASHDIFF = stage.AIRPORT_HASHDIFF
    WHERE latest_records.AIRPORT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.225929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:44.268330 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m12:43:44.270631 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:43:44.270884 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: BEGIN
[0m12:43:44.271492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:44.271742 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:43:44.271905 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data__dbt_tmp124344224318'
        
      order by ordinal_position

  
[0m12:43:44.322005 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.050 seconds
[0m12:43:44.325133 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:43:44.325383 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.331104 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m12:43:44.333259 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:43:44.333488 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.338996 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m12:43:44.340222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_airports_data"
[0m12:43:44.340657 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:43:44.340970 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      insert into "postgres"."dwh_detailed"."sat_airports_data" ("airport_pk", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_date", "record_source")
    (
        select "airport_pk", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_date", "record_source"
        from "sat_airports_data__dbt_tmp124344224318"
    )


  
[0m12:43:44.345787 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:44.346761 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:43:44.346983 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:43:44.347162 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:43:44.349964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:44.350523 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: Close
[0m12:43:44.351071 [info ] [Thread-1 (]: 20 of 36 OK created sql incremental model dwh_detailed.sat_airports_data ....... [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:44.351400 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_airports_data
[0m12:43:44.351612 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:43:44.351882 [info ] [Thread-1 (]: 21 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [RUN]
[0m12:43:44.352154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_airports_data, now model.dbtvault.sat_ticket_flights_boarding_passes)
[0m12:43:44.352348 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:43:44.360259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.360710 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:43:44.364372 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.364633 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

    
  
    

  create temporary table "sat_ticket_flights_boarding_passes__dbt_tmp124344363163"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.TICKET_FLIGHTS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.TICKET_FLIGHTS_PK, current_records.BOARDING_PASSES_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.TICKET_FLIGHTS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes" AS current_records
            JOIN (
                SELECT DISTINCT source_data.TICKET_FLIGHTS_PK
                FROM source_data
            ) AS source_records
                ON current_records.TICKET_FLIGHTS_PK = source_records.TICKET_FLIGHTS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_FLIGHTS_PK, stage.BOARDING_PASSES_HASHDIFF, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.TICKET_FLIGHTS_PK = stage.TICKET_FLIGHTS_PK
        AND latest_records.BOARDING_PASSES_HASHDIFF = stage.BOARDING_PASSES_HASHDIFF
    WHERE latest_records.BOARDING_PASSES_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.364856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:44.404853 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:43:44.407110 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.407368 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: BEGIN
[0m12:43:44.407975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:44.408232 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.408421 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes__dbt_tmp124344363163'
        
      order by ordinal_position

  
[0m12:43:44.467733 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.059 seconds
[0m12:43:44.470535 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.470795 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.476981 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:43:44.479232 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.479478 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.485161 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:43:44.486338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.486681 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.486864 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      insert into "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes" ("ticket_flights_pk", "boarding_passes_hashdiff", "boarding_no", "seat_no", "effective_from", "load_date", "record_source")
    (
        select "ticket_flights_pk", "boarding_passes_hashdiff", "boarding_no", "seat_no", "effective_from", "load_date", "record_source"
        from "sat_ticket_flights_boarding_passes__dbt_tmp124344363163"
    )


  
[0m12:43:44.490647 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:44.491515 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:43:44.491723 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:43:44.491879 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:43:44.494992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:44.495525 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: Close
[0m12:43:44.496115 [info ] [Thread-1 (]: 21 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:44.496440 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:43:44.496649 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_booking
[0m12:43:44.496930 [info ] [Thread-1 (]: 22 of 36 START sql incremental model dwh_detailed.hub_booking .................. [RUN]
[0m12:43:44.497518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_boarding_passes, now model.dbtvault.hub_booking)
[0m12:43:44.497956 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_booking
[0m12:43:44.504481 [info ] [Thread-1 (]: 12:43:44 + Loading postgres.dwh_detailed.hub_booking from 1 source(s)
[0m12:43:44.506968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_booking"
[0m12:43:44.507315 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_booking
[0m12:43:44.510095 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:43:44.510370 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

    
  
    

  create temporary table "hub_booking__dbt_tmp124344508981"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS rr
    WHERE rr.BOOK_PK IS NOT NULL
    ORDER BY rr.BOOK_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.BOOK_PK, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_booking" AS d
    ON a.BOOK_PK = d.BOOK_PK
    WHERE d.BOOK_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.510551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:44.529603 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m12:43:44.531977 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:43:44.532231 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: BEGIN
[0m12:43:44.532854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:44.533140 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:43:44.533320 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_booking__dbt_tmp124344508981'
        
      order by ordinal_position

  
[0m12:43:44.541586 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:43:44.543819 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:43:44.544045 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.549676 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:43:44.552256 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:43:44.552476 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.558131 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:43:44.559228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_booking"
[0m12:43:44.559558 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:43:44.559738 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      insert into "postgres"."dwh_detailed"."hub_booking" ("book_pk", "book_ref", "load_date", "record_source")
    (
        select "book_pk", "book_ref", "load_date", "record_source"
        from "hub_booking__dbt_tmp124344508981"
    )


  
[0m12:43:44.561908 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:43:44.562725 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:43:44.563050 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:43:44.563234 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:43:44.566045 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:44.566546 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: Close
[0m12:43:44.567074 [info ] [Thread-1 (]: 22 of 36 OK created sql incremental model dwh_detailed.hub_booking ............. [[32mINSERT 0 0[0m in 0.07s]
[0m12:43:44.567408 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_booking
[0m12:43:44.567620 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_booking_data
[0m12:43:44.567900 [info ] [Thread-1 (]: 23 of 36 START sql incremental model dwh_detailed.sat_booking_data ............. [RUN]
[0m12:43:44.568270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_booking, now model.dbtvault.sat_booking_data)
[0m12:43:44.568447 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_booking_data
[0m12:43:44.575888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_booking_data"
[0m12:43:44.576292 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_booking_data
[0m12:43:44.579246 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:43:44.579497 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

    
  
    

  create temporary table "sat_booking_data__dbt_tmp124344578104"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS a
    WHERE a.BOOK_PK IS NOT NULL
),

latest_records AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.BOOK_PK, current_records.BOOK_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.BOOK_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_booking_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.BOOK_PK
                FROM source_data
            ) AS source_records
                ON current_records.BOOK_PK = source_records.BOOK_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.BOOK_PK, stage.BOOK_HASHDIFF, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.BOOK_PK = stage.BOOK_PK
        AND latest_records.BOOK_HASHDIFF = stage.BOOK_HASHDIFF
    WHERE latest_records.BOOK_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.579722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:44.618694 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m12:43:44.621381 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:43:44.621639 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: BEGIN
[0m12:43:44.622225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:44.622480 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:43:44.622689 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data__dbt_tmp124344578104'
        
      order by ordinal_position

  
[0m12:43:44.693069 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.070 seconds
[0m12:43:44.695741 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:43:44.696031 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.701976 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:43:44.704307 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:43:44.704537 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_booking_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.710167 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.005 seconds
[0m12:43:44.711418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_booking_data"
[0m12:43:44.712041 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:43:44.712236 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      insert into "postgres"."dwh_detailed"."sat_booking_data" ("book_pk", "book_hashdiff", "book_date", "total_amount", "effective_from", "load_date", "record_source")
    (
        select "book_pk", "book_hashdiff", "book_date", "total_amount", "effective_from", "load_date", "record_source"
        from "sat_booking_data__dbt_tmp124344578104"
    )


  
[0m12:43:44.716093 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:44.716933 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:43:44.717137 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:43:44.717300 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:43:44.720999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:43:44.721496 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: Close
[0m12:43:44.722014 [info ] [Thread-1 (]: 23 of 36 OK created sql incremental model dwh_detailed.sat_booking_data ........ [[32mINSERT 0 0[0m in 0.15s]
[0m12:43:44.722343 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_booking_data
[0m12:43:44.722553 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_flight
[0m12:43:44.722917 [info ] [Thread-1 (]: 24 of 36 START sql incremental model dwh_detailed.hub_flight ................... [RUN]
[0m12:43:44.723222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_booking_data, now model.dbtvault.hub_flight)
[0m12:43:44.723407 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_flight
[0m12:43:44.727688 [info ] [Thread-1 (]: 12:43:44 + Loading postgres.dwh_detailed.hub_flight from 1 source(s)
[0m12:43:44.731062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_flight"
[0m12:43:44.731409 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_flight
[0m12:43:44.772280 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:43:44.772594 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

    
  
    

  create temporary table "hub_flight__dbt_tmp124344771119"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.FLIGHT_PK) rr.FLIGHT_PK, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.FLIGHT_PK IS NOT NULL
    ORDER BY rr.FLIGHT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.FLIGHT_PK, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_flight" AS d
    ON a.FLIGHT_PK = d.FLIGHT_PK
    WHERE d.FLIGHT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.772792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:44.790416 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.018 seconds
[0m12:43:44.792733 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:43:44.793038 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: BEGIN
[0m12:43:44.793624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:44.793857 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:43:44.794014 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight__dbt_tmp124344771119'
        
      order by ordinal_position

  
[0m12:43:44.802127 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:43:44.804457 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:43:44.804685 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.810488 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:43:44.812571 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:43:44.812802 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flight'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.818415 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:43:44.819616 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_flight"
[0m12:43:44.819951 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:43:44.820128 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      insert into "postgres"."dwh_detailed"."hub_flight" ("flight_pk", "flight_id", "load_date", "record_source")
    (
        select "flight_pk", "flight_id", "load_date", "record_source"
        from "hub_flight__dbt_tmp124344771119"
    )


  
[0m12:43:44.822862 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:43:44.823779 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:43:44.823998 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:43:44.824153 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:43:44.827175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:44.827669 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: Close
[0m12:43:44.828213 [info ] [Thread-1 (]: 24 of 36 OK created sql incremental model dwh_detailed.hub_flight .............. [[32mINSERT 0 0[0m in 0.10s]
[0m12:43:44.828544 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_flight
[0m12:43:44.828762 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_aircraft
[0m12:43:44.829024 [info ] [Thread-1 (]: 25 of 36 START sql incremental model dwh_detailed.link_flight_aircraft ......... [RUN]
[0m12:43:44.829325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_flight, now model.dbtvault.link_flight_aircraft)
[0m12:43:44.829533 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_aircraft
[0m12:43:44.835159 [info ] [Thread-1 (]: 12:43:44 + Loading postgres.dwh_detailed.link_flight_aircraft from 1 source(s)
[0m12:43:44.845287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_aircraft"
[0m12:43:44.845690 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_aircraft
[0m12:43:44.848505 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:43:44.848769 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

    
  
    

  create temporary table "link_flight_aircraft__dbt_tmp124344847347"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_AIRCRAFT_PK, rr.flight_id, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_AIRCRAFT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_AIRCRAFT_PK, a.flight_id, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_aircraft" AS d
    ON a.LINK_FLIGHT_AIRCRAFT_PK = d.LINK_FLIGHT_AIRCRAFT_PK
    WHERE d.LINK_FLIGHT_AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.848966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:44.884708 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m12:43:44.886996 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:43:44.887339 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: BEGIN
[0m12:43:44.887878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:44.888087 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:43:44.888268 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft__dbt_tmp124344847347'
        
      order by ordinal_position

  
[0m12:43:44.940525 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.052 seconds
[0m12:43:44.943084 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:43:44.943361 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.949271 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:43:44.952019 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:43:44.952253 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:44.957974 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:44.959138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_aircraft"
[0m12:43:44.959475 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:43:44.959713 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      insert into "postgres"."dwh_detailed"."link_flight_aircraft" ("link_flight_aircraft_pk", "flight_id", "aircraft_code", "load_date", "record_source")
    (
        select "link_flight_aircraft_pk", "flight_id", "aircraft_code", "load_date", "record_source"
        from "link_flight_aircraft__dbt_tmp124344847347"
    )


  
[0m12:43:44.963407 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:43:44.964351 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:43:44.964598 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:43:44.964762 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:43:44.967915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:44.968544 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: Close
[0m12:43:44.969099 [info ] [Thread-1 (]: 25 of 36 OK created sql incremental model dwh_detailed.link_flight_aircraft .... [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:44.969457 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_aircraft
[0m12:43:44.969674 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_arrival_airport
[0m12:43:44.969942 [info ] [Thread-1 (]: 26 of 36 START sql incremental model dwh_detailed.link_flight_arrival_airport .. [RUN]
[0m12:43:44.970660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_aircraft, now model.dbtvault.link_flight_arrival_airport)
[0m12:43:44.971696 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_arrival_airport
[0m12:43:44.976354 [info ] [Thread-1 (]: 12:43:44 + Loading postgres.dwh_detailed.link_flight_arrival_airport from 1 source(s)
[0m12:43:44.978868 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_arrival_airport"
[0m12:43:44.979200 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_arrival_airport
[0m12:43:44.982226 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:43:44.982474 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

    
  
    

  create temporary table "link_flight_arrival_airport__dbt_tmp124344981102"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, rr.flight_id, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, a.flight_id, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_arrival_airport" AS d
    ON a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK = d.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
    WHERE d.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:44.982674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.018784 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m12:43:45.021589 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:43:45.021862 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: BEGIN
[0m12:43:45.022445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.022742 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:43:45.022935 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport__dbt_tmp124344981102'
        
      order by ordinal_position

  
[0m12:43:45.092234 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.069 seconds
[0m12:43:45.094748 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:43:45.095014 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.100780 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:43:45.102893 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:43:45.103131 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_arrival_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.108681 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.109844 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_arrival_airport"
[0m12:43:45.110175 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:43:45.110354 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      insert into "postgres"."dwh_detailed"."link_flight_arrival_airport" ("link_flight_arrival_airport_pk", "flight_id", "arrival_airport", "load_date", "record_source")
    (
        select "link_flight_arrival_airport_pk", "flight_id", "arrival_airport", "load_date", "record_source"
        from "link_flight_arrival_airport__dbt_tmp124344981102"
    )


  
[0m12:43:45.113935 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m12:43:45.114776 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:43:45.114986 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:43:45.115148 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:43:45.118078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:45.118553 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: Close
[0m12:43:45.119110 [info ] [Thread-1 (]: 26 of 36 OK created sql incremental model dwh_detailed.link_flight_arrival_airport  [[32mINSERT 0 0[0m in 0.15s]
[0m12:43:45.119433 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_arrival_airport
[0m12:43:45.119643 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_departure_airport
[0m12:43:45.119929 [info ] [Thread-1 (]: 27 of 36 START sql incremental model dwh_detailed.link_flight_departure_airport  [RUN]
[0m12:43:45.120211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_arrival_airport, now model.dbtvault.link_flight_departure_airport)
[0m12:43:45.120411 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_departure_airport
[0m12:43:45.129468 [info ] [Thread-1 (]: 12:43:45 + Loading postgres.dwh_detailed.link_flight_departure_airport from 1 source(s)
[0m12:43:45.132109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.132451 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_departure_airport
[0m12:43:45.135999 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.136235 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

    
  
    

  create temporary table "link_flight_departure_airport__dbt_tmp124345134845"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, rr.flight_id, rr.departure_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, a.flight_id, a.departure_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_flight_departure_airport" AS d
    ON a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK = d.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
    WHERE d.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:45.136432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.171932 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m12:43:45.174246 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.174501 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: BEGIN
[0m12:43:45.175016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.175234 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.175395 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport__dbt_tmp124345134845'
        
      order by ordinal_position

  
[0m12:43:45.231113 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.055 seconds
[0m12:43:45.233737 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.233971 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.239694 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.241831 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.242041 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flight_departure_airport'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.247711 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.248876 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.249239 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.249432 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      insert into "postgres"."dwh_detailed"."link_flight_departure_airport" ("link_flight_departure_airport_pk", "flight_id", "departure_airport", "load_date", "record_source")
    (
        select "link_flight_departure_airport_pk", "flight_id", "departure_airport", "load_date", "record_source"
        from "link_flight_departure_airport__dbt_tmp124345134845"
    )


  
[0m12:43:45.253230 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:45.254121 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:43:45.254367 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:43:45.254582 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:43:45.257429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:45.257921 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: Close
[0m12:43:45.258476 [info ] [Thread-1 (]: 27 of 36 OK created sql incremental model dwh_detailed.link_flight_departure_airport  [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:45.258799 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_departure_airport
[0m12:43:45.259011 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_flight_data
[0m12:43:45.259421 [info ] [Thread-1 (]: 28 of 36 START sql incremental model dwh_detailed.sat_flight_data .............. [RUN]
[0m12:43:45.259746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_departure_airport, now model.dbtvault.sat_flight_data)
[0m12:43:45.259943 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_flight_data
[0m12:43:45.269970 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_flight_data"
[0m12:43:45.270431 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_flight_data
[0m12:43:45.273459 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:43:45.273746 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

    
  
    

  create temporary table "sat_flight_data__dbt_tmp124345272296"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.status, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS a
    WHERE a.FLIGHT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.FLIGHT_PK, current_records.FLIGHT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.FLIGHT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_flight_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.FLIGHT_PK
                FROM source_data
            ) AS source_records
                ON current_records.FLIGHT_PK = source_records.FLIGHT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.FLIGHT_PK, stage.FLIGHT_HASHDIFF, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.status, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.FLIGHT_PK = stage.FLIGHT_PK
        AND latest_records.FLIGHT_HASHDIFF = stage.FLIGHT_HASHDIFF
    WHERE latest_records.FLIGHT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:45.273955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.317367 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m12:43:45.319733 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:43:45.319984 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: BEGIN
[0m12:43:45.320512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.320707 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:43:45.320862 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data__dbt_tmp124345272296'
        
      order by ordinal_position

  
[0m12:43:45.371392 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.050 seconds
[0m12:43:45.374122 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:43:45.374363 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.380348 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m12:43:45.383180 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:43:45.383429 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flight_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.389192 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m12:43:45.390416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_flight_data"
[0m12:43:45.390786 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:43:45.390973 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      insert into "postgres"."dwh_detailed"."sat_flight_data" ("flight_pk", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "status", "actual_departure", "actual_arrival", "effective_from", "load_date", "record_source")
    (
        select "flight_pk", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "status", "actual_departure", "actual_arrival", "effective_from", "load_date", "record_source"
        from "sat_flight_data__dbt_tmp124345272296"
    )


  
[0m12:43:45.394860 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:45.395870 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:43:45.396140 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:43:45.396340 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:43:45.399797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:45.400350 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: Close
[0m12:43:45.400873 [info ] [Thread-1 (]: 28 of 36 OK created sql incremental model dwh_detailed.sat_flight_data ......... [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:45.401202 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_flight_data
[0m12:43:45.401427 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_seat
[0m12:43:45.401936 [info ] [Thread-1 (]: 29 of 36 START sql incremental model dwh_detailed.hub_seat ..................... [RUN]
[0m12:43:45.402260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_flight_data, now model.dbtvault.hub_seat)
[0m12:43:45.402462 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_seat
[0m12:43:45.405794 [info ] [Thread-1 (]: 12:43:45 + Loading postgres.dwh_detailed.hub_seat from 1 source(s)
[0m12:43:45.408349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_seat"
[0m12:43:45.408696 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_seat
[0m12:43:45.411511 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:43:45.411744 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

    
  
    

  create temporary table "hub_seat__dbt_tmp124345410333"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.SEAT_PK) rr.SEAT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.SEAT_PK IS NOT NULL
    ORDER BY rr.SEAT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.SEAT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_seat" AS d
    ON a.SEAT_PK = d.SEAT_PK
    WHERE d.SEAT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:45.411938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.431422 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m12:43:45.434309 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:43:45.434567 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: BEGIN
[0m12:43:45.435135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.435367 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:43:45.435534 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat__dbt_tmp124345410333'
        
      order by ordinal_position

  
[0m12:43:45.444309 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.009 seconds
[0m12:43:45.446418 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:43:45.446634 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.452270 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.454345 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:43:45.454624 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seat'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.460249 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.461310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_seat"
[0m12:43:45.461668 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:43:45.461853 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      insert into "postgres"."dwh_detailed"."hub_seat" ("seat_pk", "aircraft_code", "seat_no", "load_date", "record_source")
    (
        select "seat_pk", "aircraft_code", "seat_no", "load_date", "record_source"
        from "hub_seat__dbt_tmp124345410333"
    )


  
[0m12:43:45.464445 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:43:45.465281 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:43:45.465482 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:43:45.465638 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:43:45.468955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:45.469435 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: Close
[0m12:43:45.469997 [info ] [Thread-1 (]: 29 of 36 OK created sql incremental model dwh_detailed.hub_seat ................ [[32mINSERT 0 0[0m in 0.07s]
[0m12:43:45.470335 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_seat
[0m12:43:45.470555 [debug] [Thread-1 (]: Began running node model.dbtvault.link_seat_aircraft
[0m12:43:45.470897 [info ] [Thread-1 (]: 30 of 36 START sql incremental model dwh_detailed.link_seat_aircraft ........... [RUN]
[0m12:43:45.471176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_seat, now model.dbtvault.link_seat_aircraft)
[0m12:43:45.471361 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_seat_aircraft
[0m12:43:45.474455 [info ] [Thread-1 (]: 12:43:45 + Loading postgres.dwh_detailed.link_seat_aircraft from 1 source(s)
[0m12:43:45.477049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_seat_aircraft"
[0m12:43:45.477371 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_seat_aircraft
[0m12:43:45.480920 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:43:45.481213 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

    
  
    

  create temporary table "link_seat_aircraft__dbt_tmp124345479769"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_SEAT_AIRCRAFT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SEAT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.LINK_SEAT_AIRCRAFT_PK IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SEAT_AIRCRAFT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_seat_aircraft" AS d
    ON a.LINK_SEAT_AIRCRAFT_PK = d.LINK_SEAT_AIRCRAFT_PK
    WHERE d.LINK_SEAT_AIRCRAFT_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:45.481399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.513329 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m12:43:45.516352 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:43:45.516598 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: BEGIN
[0m12:43:45.517246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.517514 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:43:45.517692 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft__dbt_tmp124345479769'
        
      order by ordinal_position

  
[0m12:43:45.581698 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.064 seconds
[0m12:43:45.584239 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:43:45.584491 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.590236 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.592478 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:43:45.592746 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_seat_aircraft'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.598432 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.599556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_seat_aircraft"
[0m12:43:45.599911 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:43:45.600096 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      insert into "postgres"."dwh_detailed"."link_seat_aircraft" ("link_seat_aircraft_pk", "aircraft_code", "seat_no", "load_date", "record_source")
    (
        select "link_seat_aircraft_pk", "aircraft_code", "seat_no", "load_date", "record_source"
        from "link_seat_aircraft__dbt_tmp124345479769"
    )


  
[0m12:43:45.604516 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:45.605480 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:43:45.605692 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:43:45.605846 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:43:45.608806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:45.609338 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: Close
[0m12:43:45.609877 [info ] [Thread-1 (]: 30 of 36 OK created sql incremental model dwh_detailed.link_seat_aircraft ...... [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:45.610236 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_seat_aircraft
[0m12:43:45.610461 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_seat_data
[0m12:43:45.610735 [info ] [Thread-1 (]: 31 of 36 START sql incremental model dwh_detailed.sat_seat_data ................ [RUN]
[0m12:43:45.611163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_seat_aircraft, now model.dbtvault.sat_seat_data)
[0m12:43:45.611391 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_seat_data
[0m12:43:45.619378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_seat_data"
[0m12:43:45.619824 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_seat_data
[0m12:43:45.622753 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:43:45.623121 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

    
  
    

  create temporary table "sat_seat_data__dbt_tmp124345621602"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS a
    WHERE a.SEAT_PK IS NOT NULL
),

latest_records AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.SEAT_PK, current_records.SEAT_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.SEAT_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_seat_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.SEAT_PK
                FROM source_data
            ) AS source_records
                ON current_records.SEAT_PK = source_records.SEAT_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.SEAT_PK, stage.SEAT_HASHDIFF, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.SEAT_PK = stage.SEAT_PK
        AND latest_records.SEAT_HASHDIFF = stage.SEAT_HASHDIFF
    WHERE latest_records.SEAT_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:45.623390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.663962 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:43:45.666370 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:43:45.666622 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: BEGIN
[0m12:43:45.667213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.667440 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:43:45.667611 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data__dbt_tmp124345621602'
        
      order by ordinal_position

  
[0m12:43:45.722604 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.055 seconds
[0m12:43:45.725003 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:43:45.725262 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.731209 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:43:45.733963 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:43:45.734180 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_seat_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.739855 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m12:43:45.741034 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_seat_data"
[0m12:43:45.741404 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:43:45.741593 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      insert into "postgres"."dwh_detailed"."sat_seat_data" ("seat_pk", "seat_hashdiff", "fare_conditions", "effective_from", "load_date", "record_source")
    (
        select "seat_pk", "seat_hashdiff", "fare_conditions", "effective_from", "load_date", "record_source"
        from "sat_seat_data__dbt_tmp124345621602"
    )


  
[0m12:43:45.745844 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:45.746846 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:43:45.747051 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:43:45.747207 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:43:45.750197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:45.750745 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: Close
[0m12:43:45.751286 [info ] [Thread-1 (]: 31 of 36 OK created sql incremental model dwh_detailed.sat_seat_data ........... [[32mINSERT 0 0[0m in 0.14s]
[0m12:43:45.751611 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_seat_data
[0m12:43:45.751839 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_flights
[0m12:43:45.752218 [info ] [Thread-1 (]: 32 of 36 START sql incremental model dwh_detailed.link_ticket_flights .......... [RUN]
[0m12:43:45.752494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_seat_data, now model.dbtvault.link_ticket_flights)
[0m12:43:45.752705 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_flights
[0m12:43:45.756427 [info ] [Thread-1 (]: 12:43:45 + Loading postgres.dwh_detailed.link_ticket_flights from 1 source(s)
[0m12:43:45.759207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_flights"
[0m12:43:45.759605 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_flights
[0m12:43:45.762503 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:43:45.762737 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp124345761338"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_FLIGHTS_PK, rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_FLIGHTS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.LINK_TICKET_FLIGHTS_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_ticket_flights" AS d
    ON a.LINK_TICKET_FLIGHTS_PK = d.LINK_TICKET_FLIGHTS_PK
    WHERE d.LINK_TICKET_FLIGHTS_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:45.762953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.795220 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m12:43:45.797999 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:43:45.798242 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: BEGIN
[0m12:43:45.798847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.799103 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:43:45.799271 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp124345761338'
        
      order by ordinal_position

  
[0m12:43:45.839737 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.040 seconds
[0m12:43:45.842096 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:43:45.842321 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.848002 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m12:43:45.850085 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:43:45.850310 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:45.856046 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:43:45.857230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_flights"
[0m12:43:45.857578 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:43:45.857798 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed"."link_ticket_flights" ("link_ticket_flights_pk", "ticket_no", "flight_id", "load_date", "record_source")
    (
        select "link_ticket_flights_pk", "ticket_no", "flight_id", "load_date", "record_source"
        from "link_ticket_flights__dbt_tmp124345761338"
    )


  
[0m12:43:45.861682 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:45.862609 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:43:45.862871 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:43:45.863067 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:43:45.865852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:45.866373 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: Close
[0m12:43:45.866899 [info ] [Thread-1 (]: 32 of 36 OK created sql incremental model dwh_detailed.link_ticket_flights ..... [[32mINSERT 0 0[0m in 0.11s]
[0m12:43:45.867243 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_flights
[0m12:43:45.867466 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_data
[0m12:43:45.867745 [info ] [Thread-1 (]: 33 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_data ...... [RUN]
[0m12:43:45.868072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_flights, now model.dbtvault.sat_ticket_flights_data)
[0m12:43:45.868260 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_data
[0m12:43:45.877529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_data"
[0m12:43:45.877973 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_data
[0m12:43:45.880959 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:43:45.881214 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

    
  
    

  create temporary table "sat_ticket_flights_data__dbt_tmp124345879750"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.LINK_TICKET_FLIGHTS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.LINK_TICKET_FLIGHTS_PK, current_records.TICKET_FLIGHTS_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.LINK_TICKET_FLIGHTS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed"."sat_ticket_flights_data" AS current_records
            JOIN (
                SELECT DISTINCT source_data.LINK_TICKET_FLIGHTS_PK
                FROM source_data
            ) AS source_records
                ON current_records.LINK_TICKET_FLIGHTS_PK = source_records.LINK_TICKET_FLIGHTS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_PK, stage.TICKET_FLIGHTS_HASHDIFF, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.LINK_TICKET_FLIGHTS_PK = stage.LINK_TICKET_FLIGHTS_PK
        AND latest_records.TICKET_FLIGHTS_HASHDIFF = stage.TICKET_FLIGHTS_HASHDIFF
    WHERE latest_records.TICKET_FLIGHTS_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:45.881412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.921891 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m12:43:45.924203 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:43:45.924464 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: BEGIN
[0m12:43:45.925060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:45.925310 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:43:45.925506 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data__dbt_tmp124345879750'
        
      order by ordinal_position

  
[0m12:43:46.000684 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.075 seconds
[0m12:43:46.003207 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:43:46.003487 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:46.009518 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:43:46.011708 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:43:46.011940 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_ticket_flights_data'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:46.017834 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m12:43:46.019108 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_data"
[0m12:43:46.019514 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:43:46.019738 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      insert into "postgres"."dwh_detailed"."sat_ticket_flights_data" ("link_ticket_flights_pk", "ticket_flights_hashdiff", "fare_conditions", "amount", "effective_from", "load_date", "record_source")
    (
        select "link_ticket_flights_pk", "ticket_flights_hashdiff", "fare_conditions", "amount", "effective_from", "load_date", "record_source"
        from "sat_ticket_flights_data__dbt_tmp124345879750"
    )


  
[0m12:43:46.023673 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:46.024603 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:43:46.024839 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:43:46.024996 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:43:46.027952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:46.028469 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: Close
[0m12:43:46.029006 [info ] [Thread-1 (]: 33 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_data . [[32mINSERT 0 0[0m in 0.16s]
[0m12:43:46.029338 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_data
[0m12:43:46.029553 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_ticket
[0m12:43:46.029980 [info ] [Thread-1 (]: 34 of 36 START sql incremental model dwh_detailed.hub_ticket ................... [RUN]
[0m12:43:46.030278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_data, now model.dbtvault.hub_ticket)
[0m12:43:46.030469 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_ticket
[0m12:43:46.035614 [info ] [Thread-1 (]: 12:43:46 + Loading postgres.dwh_detailed.hub_ticket from 1 source(s)
[0m12:43:46.038081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_ticket"
[0m12:43:46.038405 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_ticket
[0m12:43:46.041371 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:43:46.041602 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

    
  
    

  create temporary table "hub_ticket__dbt_tmp124346040159"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.TICKET_PK IS NOT NULL
    ORDER BY rr.TICKET_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.TICKET_PK, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."hub_ticket" AS d
    ON a.TICKET_PK = d.TICKET_PK
    WHERE d.TICKET_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:46.041777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:46.060667 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.019 seconds
[0m12:43:46.063011 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:43:46.063284 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: BEGIN
[0m12:43:46.063872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:46.064115 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:43:46.064279 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_ticket__dbt_tmp124346040159'
        
      order by ordinal_position

  
[0m12:43:46.072513 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.008 seconds
[0m12:43:46.075229 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:43:46.075458 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_ticket'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:46.081064 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m12:43:46.120108 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:43:46.120424 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_ticket'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:46.126887 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:43:46.128211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_ticket"
[0m12:43:46.128604 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:43:46.128788 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      insert into "postgres"."dwh_detailed"."hub_ticket" ("ticket_pk", "ticket_no", "load_date", "record_source")
    (
        select "ticket_pk", "ticket_no", "load_date", "record_source"
        from "hub_ticket__dbt_tmp124346040159"
    )


  
[0m12:43:46.131028 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m12:43:46.131856 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:43:46.132055 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:43:46.132211 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:43:46.135288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:46.135789 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: Close
[0m12:43:46.136312 [info ] [Thread-1 (]: 34 of 36 OK created sql incremental model dwh_detailed.hub_ticket .............. [[32mINSERT 0 0[0m in 0.11s]
[0m12:43:46.136643 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_ticket
[0m12:43:46.136859 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_booking
[0m12:43:46.137357 [info ] [Thread-1 (]: 35 of 36 START sql incremental model dwh_detailed.link_ticket_booking .......... [RUN]
[0m12:43:46.137675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_ticket, now model.dbtvault.link_ticket_booking)
[0m12:43:46.137872 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_booking
[0m12:43:46.141709 [info ] [Thread-1 (]: 12:43:46 + Loading postgres.dwh_detailed.link_ticket_booking from 1 source(s)
[0m12:43:46.144230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_booking"
[0m12:43:46.144541 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_booking
[0m12:43:46.147369 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:43:46.147595 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

    
  
    

  create temporary table "link_ticket_booking__dbt_tmp124346146258"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_BOOKING_PK, rr.ticket_no, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_BOOKING_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.LINK_TICKET_BOOKING_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_BOOKING_PK, a.ticket_no, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed"."link_ticket_booking" AS d
    ON a.LINK_TICKET_BOOKING_PK = d.LINK_TICKET_BOOKING_PK
    WHERE d.LINK_TICKET_BOOKING_PK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:46.147777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:46.179943 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m12:43:46.182663 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:43:46.182954 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: BEGIN
[0m12:43:46.183557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m12:43:46.183796 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:43:46.183971 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking__dbt_tmp124346146258'
        
      order by ordinal_position

  
[0m12:43:46.243430 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.059 seconds
[0m12:43:46.245922 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:43:46.246201 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:46.252066 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:43:46.254343 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:43:46.254580 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_booking'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:43:46.260489 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:43:46.261846 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_booking"
[0m12:43:46.262225 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:43:46.262412 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      insert into "postgres"."dwh_detailed"."link_ticket_booking" ("link_ticket_booking_pk", "ticket_no", "book_ref", "load_date", "record_source")
    (
        select "link_ticket_booking_pk", "ticket_no", "book_ref", "load_date", "record_source"
        from "link_ticket_booking__dbt_tmp124346146258"
    )


  
[0m12:43:46.266137 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m12:43:46.266975 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:43:46.267177 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:43:46.267392 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:43:46.270280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:46.270775 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: Close
[0m12:43:46.271301 [info ] [Thread-1 (]: 35 of 36 OK created sql incremental model dwh_detailed.link_ticket_booking ..... [[32mINSERT 0 0[0m in 0.13s]
[0m12:43:46.271624 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_booking
[0m12:43:46.271834 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_data
[0m12:43:46.272104 [info ] [Thread-1 (]: 36 of 36 START sql incremental model dwh_detailed.sat_ticket_data .............. [RUN]
[0m12:43:46.272595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_booking, now model.dbtvault.sat_ticket_data)
[0m12:43:46.273053 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_data
[0m12:43:46.282468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_data"
[0m12:43:46.282940 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_data
[0m12:43:46.286379 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_data"
[0m12:43:46.286708 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:43:46.286885 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: BEGIN
[0m12:43:46.287042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:46.290624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:43:46.290918 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:43:46.291099 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_PK, a.TICKETHASHDIFF, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS a
    WHERE a.TICKET_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_PK, stage.TICKETHASHDIFF, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:43:46.317349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m12:43:46.318480 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: COMMIT
[0m12:43:46.318733 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:43:46.318890 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: COMMIT
[0m12:43:46.322331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:43:46.322975 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: Close
[0m12:43:46.323544 [info ] [Thread-1 (]: 36 of 36 OK created sql incremental model dwh_detailed.sat_ticket_data ......... [[32mSELECT 1[0m in 0.05s]
[0m12:43:46.323883 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_data
[0m12:43:46.326418 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:46.326670 [debug] [MainThread]: On master: BEGIN
[0m12:43:46.326816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:46.330297 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:43:46.330547 [debug] [MainThread]: On master: COMMIT
[0m12:43:46.330703 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:46.330841 [debug] [MainThread]: On master: COMMIT
[0m12:43:46.331279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:46.331498 [debug] [MainThread]: On master: Close
[0m12:43:46.331772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:46.331910 [debug] [MainThread]: Connection 'model.dbtvault.sat_ticket_data' was properly closed.
[0m12:43:46.332160 [info ] [MainThread]: 
[0m12:43:46.332356 [info ] [MainThread]: Finished running 20 incremental models, 8 table models, 8 view models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m12:43:46.334983 [debug] [MainThread]: Command end result
[0m12:43:46.356580 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:43:46.357734 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:43:46.362108 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/user/dwh/dbt/target/run_results.json
[0m12:43:46.362323 [info ] [MainThread]: 
[0m12:43:46.362557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:46.362748 [info ] [MainThread]: 
[0m12:43:46.362974 [info ] [MainThread]: Done. PASS=36 WARN=0 ERROR=0 SKIP=0 TOTAL=36
[0m12:43:46.364097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.379702, "process_in_blocks": "69416", "process_kernel_time": 0.158031, "process_mem_max_rss": "121484", "process_out_blocks": "7432", "process_user_time": 2.342585}
[0m12:43:46.364364 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:46.364310 after 4.38 seconds
[0m12:43:46.364549 [debug] [MainThread]: Flushing usage events


============================== 12:52:21.894986 | b51d9152-a34a-413f-b6e8-03b1a6d1a81d ==============================
[0m12:52:21.894986 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:52:21.897420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/user/dwh/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:52:21.897687 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:52:22.059956 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:52:22.104013 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:52:22.168725 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:52:23.638743 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m12:52:23.729908 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:52:23.731447 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:52:23.746551 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m12:52:23.748151 [info ] [MainThread]: 
[0m12:52:23.748409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:23.748578 [info ] [MainThread]: 
[0m12:52:23.748865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:23.752415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:52:23.767241 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:52:23.767478 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:52:23.767619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:23.776422 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m12:52:23.777222 [debug] [ThreadPool]: On list_postgres: Close
[0m12:52:23.777940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_dwh_detailed)
[0m12:52:23.778274 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "dwh_detailed"
"
[0m12:52:23.781617 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m12:52:23.781802 [debug] [ThreadPool]: On create_postgres_dwh_detailed: BEGIN
[0m12:52:23.781937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:23.785812 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:52:23.786066 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m12:52:23.786221 [debug] [ThreadPool]: On create_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "create_postgres_dwh_detailed"} */
create schema if not exists "dwh_detailed"
[0m12:52:23.797474 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m12:52:23.798189 [debug] [ThreadPool]: On create_postgres_dwh_detailed: COMMIT
[0m12:52:23.798434 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m12:52:23.798576 [debug] [ThreadPool]: On create_postgres_dwh_detailed: COMMIT
[0m12:52:23.801481 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m12:52:23.801725 [debug] [ThreadPool]: On create_postgres_dwh_detailed: Close
[0m12:52:23.804356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_dwh_detailed, now list_postgres_dwh_detailed)
[0m12:52:23.808540 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:52:23.808772 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m12:52:23.808921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:23.812591 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:52:23.812802 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m12:52:23.812959 [debug] [ThreadPool]: On list_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed'
  
[0m12:52:23.824612 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m12:52:23.825352 [debug] [ThreadPool]: On list_postgres_dwh_detailed: ROLLBACK
[0m12:52:23.825890 [debug] [ThreadPool]: On list_postgres_dwh_detailed: Close
[0m12:52:23.829949 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:23.830141 [debug] [MainThread]: On master: BEGIN
[0m12:52:23.830277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:23.833747 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:52:23.833953 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:23.834157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:23.843527 [debug] [MainThread]: SQL status: SELECT 53 in 0.009 seconds
[0m12:52:23.844925 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:23.845473 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:23.845650 [debug] [MainThread]: On master: BEGIN
[0m12:52:23.846492 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:52:23.846664 [debug] [MainThread]: On master: COMMIT
[0m12:52:23.846807 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:23.846935 [debug] [MainThread]: On master: COMMIT
[0m12:52:23.847357 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:23.847550 [debug] [MainThread]: On master: Close
[0m12:52:23.849505 [debug] [Thread-1 (]: Began running node model.dbtvault.aircrafts
[0m12:52:23.849828 [info ] [Thread-1 (]: 1 of 36 START sql view model dwh_detailed.aircrafts ............................ [RUN]
[0m12:52:23.850124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed, now model.dbtvault.aircrafts)
[0m12:52:23.850310 [debug] [Thread-1 (]: Began compiling node model.dbtvault.aircrafts
[0m12:52:23.854908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.aircrafts"
[0m12:52:23.855718 [debug] [Thread-1 (]: Began executing node model.dbtvault.aircrafts
[0m12:52:23.874750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.aircrafts"
[0m12:52:23.875156 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:52:23.875349 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: BEGIN
[0m12:52:23.875501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:23.879388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:23.879629 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:52:23.879796 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */

  create view "postgres"."dwh_detailed"."aircrafts__dbt_tmp"
    
    
  as (
    SELECT aircraft_code, model::jsonb as model, range
FROM "postgres"."public"."postgres_public_aircrafts"
  );
[0m12:52:23.896660 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m12:52:23.900944 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:52:23.901218 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts__dbt_tmp" rename to "aircrafts"
[0m12:52:23.902495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:23.910505 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:52:23.910725 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:52:23.910895 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m12:52:23.913933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:23.917624 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."aircrafts__dbt_backup"
[0m12:52:23.920003 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m12:52:23.920216 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."aircrafts__dbt_backup" cascade
[0m12:52:23.921722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:23.923198 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: Close
[0m12:52:23.925159 [info ] [Thread-1 (]: 1 of 36 OK created sql view model dwh_detailed.aircrafts ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:52:23.925725 [debug] [Thread-1 (]: Finished running node model.dbtvault.aircrafts
[0m12:52:23.925983 [debug] [Thread-1 (]: Began running node model.dbtvault.airports
[0m12:52:23.926271 [info ] [Thread-1 (]: 2 of 36 START sql view model dwh_detailed.airports ............................. [RUN]
[0m12:52:23.926678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.aircrafts, now model.dbtvault.airports)
[0m12:52:23.926924 [debug] [Thread-1 (]: Began compiling node model.dbtvault.airports
[0m12:52:23.929072 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.airports"
[0m12:52:23.929748 [debug] [Thread-1 (]: Began executing node model.dbtvault.airports
[0m12:52:23.932847 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.airports"
[0m12:52:23.933175 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:52:23.933359 [debug] [Thread-1 (]: On model.dbtvault.airports: BEGIN
[0m12:52:23.933508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:23.937474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:23.937722 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:52:23.937961 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */

  create view "postgres"."dwh_detailed"."airports__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_airports"
  );
[0m12:52:23.944230 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:23.946600 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:52:23.946900 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports__dbt_tmp" rename to "airports"
[0m12:52:23.947846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:23.948709 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:52:23.948918 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:52:23.949097 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m12:52:23.951942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:23.953611 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."airports__dbt_backup"
[0m12:52:23.954042 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m12:52:23.954225 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
drop view if exists "postgres"."dwh_detailed"."airports__dbt_backup" cascade
[0m12:52:23.955496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:23.956230 [debug] [Thread-1 (]: On model.dbtvault.airports: Close
[0m12:52:23.956753 [info ] [Thread-1 (]: 2 of 36 OK created sql view model dwh_detailed.airports ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m12:52:23.957470 [debug] [Thread-1 (]: Finished running node model.dbtvault.airports
[0m12:52:23.958012 [debug] [Thread-1 (]: Began running node model.dbtvault.boarding_passes
[0m12:52:23.958663 [info ] [Thread-1 (]: 3 of 36 START sql view model dwh_detailed.boarding_passes ...................... [RUN]
[0m12:52:23.959092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.airports, now model.dbtvault.boarding_passes)
[0m12:52:23.959284 [debug] [Thread-1 (]: Began compiling node model.dbtvault.boarding_passes
[0m12:52:23.961203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.boarding_passes"
[0m12:52:23.961506 [debug] [Thread-1 (]: Began executing node model.dbtvault.boarding_passes
[0m12:52:23.963676 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.boarding_passes"
[0m12:52:23.964001 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:52:23.964182 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: BEGIN
[0m12:52:23.964351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:23.968411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:23.968659 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:52:23.968824 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */

  create view "postgres"."dwh_detailed"."boarding_passes__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_boarding_passes"
  );
[0m12:52:23.975293 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:23.978458 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:52:23.978716 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp" rename to "boarding_passes"
[0m12:52:23.979675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:23.980473 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:52:23.980690 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:52:23.980850 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m12:52:23.983679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:23.985454 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."boarding_passes__dbt_backup"
[0m12:52:23.985829 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m12:52:23.986041 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."boarding_passes__dbt_backup" cascade
[0m12:52:23.987308 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:23.988145 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: Close
[0m12:52:23.988661 [info ] [Thread-1 (]: 3 of 36 OK created sql view model dwh_detailed.boarding_passes ................. [[32mCREATE VIEW[0m in 0.03s]
[0m12:52:23.988992 [debug] [Thread-1 (]: Finished running node model.dbtvault.boarding_passes
[0m12:52:23.989216 [debug] [Thread-1 (]: Began running node model.dbtvault.bookings
[0m12:52:23.989634 [info ] [Thread-1 (]: 4 of 36 START sql view model dwh_detailed.bookings ............................. [RUN]
[0m12:52:23.990110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.boarding_passes, now model.dbtvault.bookings)
[0m12:52:23.990324 [debug] [Thread-1 (]: Began compiling node model.dbtvault.bookings
[0m12:52:23.992313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.bookings"
[0m12:52:23.992625 [debug] [Thread-1 (]: Began executing node model.dbtvault.bookings
[0m12:52:23.994896 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.bookings"
[0m12:52:23.995206 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:52:23.995398 [debug] [Thread-1 (]: On model.dbtvault.bookings: BEGIN
[0m12:52:23.995555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:23.999635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:23.999899 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:52:24.000071 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */

  create view "postgres"."dwh_detailed"."bookings__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_bookings"
  );
[0m12:52:24.005980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:24.009102 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:52:24.009332 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings__dbt_tmp" rename to "bookings"
[0m12:52:24.010315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.011192 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:52:24.011400 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:52:24.011555 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m12:52:24.014339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.016003 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."bookings__dbt_backup"
[0m12:52:24.016375 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m12:52:24.016578 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
drop view if exists "postgres"."dwh_detailed"."bookings__dbt_backup" cascade
[0m12:52:24.017799 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.018613 [debug] [Thread-1 (]: On model.dbtvault.bookings: Close
[0m12:52:24.019141 [info ] [Thread-1 (]: 4 of 36 OK created sql view model dwh_detailed.bookings ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m12:52:24.019816 [debug] [Thread-1 (]: Finished running node model.dbtvault.bookings
[0m12:52:24.020260 [debug] [Thread-1 (]: Began running node model.dbtvault.flights
[0m12:52:24.020927 [info ] [Thread-1 (]: 5 of 36 START sql view model dwh_detailed.flights .............................. [RUN]
[0m12:52:24.021249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.bookings, now model.dbtvault.flights)
[0m12:52:24.021431 [debug] [Thread-1 (]: Began compiling node model.dbtvault.flights
[0m12:52:24.023387 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.flights"
[0m12:52:24.023700 [debug] [Thread-1 (]: Began executing node model.dbtvault.flights
[0m12:52:24.025952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.flights"
[0m12:52:24.026271 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:52:24.026449 [debug] [Thread-1 (]: On model.dbtvault.flights: BEGIN
[0m12:52:24.026624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.030452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.030694 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:52:24.030867 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */

  create view "postgres"."dwh_detailed"."flights__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_flights"
  );
[0m12:52:24.036551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:52:24.039807 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:52:24.040055 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights__dbt_tmp" rename to "flights"
[0m12:52:24.041084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.041941 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:52:24.042137 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:52:24.042290 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m12:52:24.045142 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.046846 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."flights__dbt_backup"
[0m12:52:24.047255 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m12:52:24.047433 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
drop view if exists "postgres"."dwh_detailed"."flights__dbt_backup" cascade
[0m12:52:24.048786 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.049539 [debug] [Thread-1 (]: On model.dbtvault.flights: Close
[0m12:52:24.050051 [info ] [Thread-1 (]: 5 of 36 OK created sql view model dwh_detailed.flights ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m12:52:24.050397 [debug] [Thread-1 (]: Finished running node model.dbtvault.flights
[0m12:52:24.050610 [debug] [Thread-1 (]: Began running node model.dbtvault.seats
[0m12:52:24.051206 [info ] [Thread-1 (]: 6 of 36 START sql view model dwh_detailed.seats ................................ [RUN]
[0m12:52:24.051891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.flights, now model.dbtvault.seats)
[0m12:52:24.052106 [debug] [Thread-1 (]: Began compiling node model.dbtvault.seats
[0m12:52:24.054120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.seats"
[0m12:52:24.054429 [debug] [Thread-1 (]: Began executing node model.dbtvault.seats
[0m12:52:24.056720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.seats"
[0m12:52:24.057094 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:52:24.057325 [debug] [Thread-1 (]: On model.dbtvault.seats: BEGIN
[0m12:52:24.057495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.061303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.061523 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:52:24.061686 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */

  create view "postgres"."dwh_detailed"."seats__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_seats"
  );
[0m12:52:24.067838 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:24.070299 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:52:24.070524 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats__dbt_tmp" rename to "seats"
[0m12:52:24.071518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.072339 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:52:24.072542 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:52:24.072701 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m12:52:24.075378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:24.077627 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."seats__dbt_backup"
[0m12:52:24.078016 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m12:52:24.078313 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
drop view if exists "postgres"."dwh_detailed"."seats__dbt_backup" cascade
[0m12:52:24.079596 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.080320 [debug] [Thread-1 (]: On model.dbtvault.seats: Close
[0m12:52:24.080825 [info ] [Thread-1 (]: 6 of 36 OK created sql view model dwh_detailed.seats ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m12:52:24.081145 [debug] [Thread-1 (]: Finished running node model.dbtvault.seats
[0m12:52:24.081377 [debug] [Thread-1 (]: Began running node model.dbtvault.ticket_flights
[0m12:52:24.081929 [info ] [Thread-1 (]: 7 of 36 START sql view model dwh_detailed.ticket_flights ....................... [RUN]
[0m12:52:24.082694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.seats, now model.dbtvault.ticket_flights)
[0m12:52:24.082915 [debug] [Thread-1 (]: Began compiling node model.dbtvault.ticket_flights
[0m12:52:24.084882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.ticket_flights"
[0m12:52:24.085199 [debug] [Thread-1 (]: Began executing node model.dbtvault.ticket_flights
[0m12:52:24.087474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.ticket_flights"
[0m12:52:24.087812 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:52:24.087996 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: BEGIN
[0m12:52:24.088147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.092752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:52:24.093012 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:52:24.093191 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */

  create view "postgres"."dwh_detailed"."ticket_flights__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_ticket_flights"
  );
[0m12:52:24.099289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:24.101616 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:52:24.101841 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp" rename to "ticket_flights"
[0m12:52:24.102789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.103630 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:52:24.103832 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:52:24.103987 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m12:52:24.106876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.140901 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."ticket_flights__dbt_backup"
[0m12:52:24.141400 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m12:52:24.141581 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."ticket_flights__dbt_backup" cascade
[0m12:52:24.143475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:52:24.144289 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: Close
[0m12:52:24.144808 [info ] [Thread-1 (]: 7 of 36 OK created sql view model dwh_detailed.ticket_flights .................. [[32mCREATE VIEW[0m in 0.06s]
[0m12:52:24.145160 [debug] [Thread-1 (]: Finished running node model.dbtvault.ticket_flights
[0m12:52:24.145376 [debug] [Thread-1 (]: Began running node model.dbtvault.tickets
[0m12:52:24.145773 [info ] [Thread-1 (]: 8 of 36 START sql view model dwh_detailed.tickets .............................. [RUN]
[0m12:52:24.146079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.ticket_flights, now model.dbtvault.tickets)
[0m12:52:24.146607 [debug] [Thread-1 (]: Began compiling node model.dbtvault.tickets
[0m12:52:24.148742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.tickets"
[0m12:52:24.149057 [debug] [Thread-1 (]: Began executing node model.dbtvault.tickets
[0m12:52:24.151244 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.tickets"
[0m12:52:24.151565 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:52:24.151747 [debug] [Thread-1 (]: On model.dbtvault.tickets: BEGIN
[0m12:52:24.151898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.155795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.156036 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:52:24.156213 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */

  create view "postgres"."dwh_detailed"."tickets__dbt_tmp"
    
    
  as (
    SELECT ticket_no, book_ref, passenger_id, passenger_name, contact_data::jsonb as contact_data
FROM "postgres"."public"."postgres_public_tickets"
  );
[0m12:52:24.161665 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:52:24.163931 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:52:24.164196 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets__dbt_tmp" rename to "tickets"
[0m12:52:24.165288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.166200 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:52:24.166414 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:52:24.166591 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m12:52:24.169459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.171118 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."tickets__dbt_backup"
[0m12:52:24.172066 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m12:52:24.172273 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
drop view if exists "postgres"."dwh_detailed"."tickets__dbt_backup" cascade
[0m12:52:24.173663 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.174521 [debug] [Thread-1 (]: On model.dbtvault.tickets: Close
[0m12:52:24.175027 [info ] [Thread-1 (]: 8 of 36 OK created sql view model dwh_detailed.tickets ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m12:52:24.175412 [debug] [Thread-1 (]: Finished running node model.dbtvault.tickets
[0m12:52:24.175627 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_aircrafts
[0m12:52:24.176382 [info ] [Thread-1 (]: 9 of 36 START sql view model dwh_detailed.stg_aircrafts ........................ [RUN]
[0m12:52:24.177349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.tickets, now model.dbtvault.stg_aircrafts)
[0m12:52:24.177686 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_aircrafts
[0m12:52:24.188444 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:52:24.188735 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: BEGIN
[0m12:52:24.188925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.192869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.193164 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:52:24.193347 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.213458 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.020 seconds
[0m12:52:24.218021 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:52:24.218326 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.225257 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m12:52:24.228487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_aircrafts"
[0m12:52:24.228848 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_aircrafts
[0m12:52:24.231709 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_aircrafts"
[0m12:52:24.232028 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:52:24.232235 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

  create view "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed"."aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS AIRCRAFT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRCRAFT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    AIRCRAFT_PK,
    AIRCRAFT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.239494 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:52:24.241927 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:52:24.242165 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
alter table "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m12:52:24.243353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.244242 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:52:24.244471 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:52:24.244648 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m12:52:24.247622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.249341 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup"
[0m12:52:24.249764 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m12:52:24.249962 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m12:52:24.251210 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.251968 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: Close
[0m12:52:24.252525 [info ] [Thread-1 (]: 9 of 36 OK created sql view model dwh_detailed.stg_aircrafts ................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:52:24.253228 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_aircrafts
[0m12:52:24.253673 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_airports
[0m12:52:24.254271 [info ] [Thread-1 (]: 10 of 36 START sql view model dwh_detailed.stg_airports ........................ [RUN]
[0m12:52:24.254826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_aircrafts, now model.dbtvault.stg_airports)
[0m12:52:24.255070 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_airports
[0m12:52:24.260417 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:52:24.260733 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: BEGIN
[0m12:52:24.260899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.264930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.265177 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:52:24.265381 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.276442 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.011 seconds
[0m12:52:24.280010 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:52:24.280259 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.286256 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m12:52:24.290418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_airports"
[0m12:52:24.290770 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_airports
[0m12:52:24.293089 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_airports"
[0m12:52:24.293392 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:52:24.293601 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

  create view "postgres"."dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed"."airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    AIRPORT_PK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.300808 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:52:24.303566 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:52:24.303791 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
alter table "postgres"."dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m12:52:24.304981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.305828 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:52:24.306028 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:52:24.306198 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m12:52:24.309149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.310781 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_airports__dbt_backup"
[0m12:52:24.311201 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m12:52:24.311381 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
drop view if exists "postgres"."dwh_detailed"."stg_airports__dbt_backup" cascade
[0m12:52:24.312645 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.313375 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: Close
[0m12:52:24.313890 [info ] [Thread-1 (]: 10 of 36 OK created sql view model dwh_detailed.stg_airports ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:52:24.314205 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_airports
[0m12:52:24.314409 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_boarding_passes
[0m12:52:24.315019 [info ] [Thread-1 (]: 11 of 36 START sql view model dwh_detailed.stg_boarding_passes ................. [RUN]
[0m12:52:24.315796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_airports, now model.dbtvault.stg_boarding_passes)
[0m12:52:24.316018 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_boarding_passes
[0m12:52:24.320522 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:52:24.320737 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: BEGIN
[0m12:52:24.320897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.324796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.325034 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:52:24.325203 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.336502 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:52:24.340562 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:52:24.340819 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.346778 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:52:24.354499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_boarding_passes"
[0m12:52:24.354994 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_boarding_passes
[0m12:52:24.357667 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_boarding_passes"
[0m12:52:24.358056 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:52:24.358332 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed"."boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS TICKET_FLIGHTS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOARDING_PASSES_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    TICKET_FLIGHTS_PK,
    BOARDING_PASSES_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.367967 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:52:24.370364 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:52:24.370613 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m12:52:24.371911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.372722 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:52:24.372926 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:52:24.373086 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m12:52:24.376243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.377917 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m12:52:24.378303 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m12:52:24.378527 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m12:52:24.379936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.380699 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: Close
[0m12:52:24.381227 [info ] [Thread-1 (]: 11 of 36 OK created sql view model dwh_detailed.stg_boarding_passes ............ [[32mCREATE VIEW[0m in 0.07s]
[0m12:52:24.381574 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_boarding_passes
[0m12:52:24.381788 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_bookings
[0m12:52:24.382372 [info ] [Thread-1 (]: 12 of 36 START sql view model dwh_detailed.stg_bookings ........................ [RUN]
[0m12:52:24.383115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_boarding_passes, now model.dbtvault.stg_bookings)
[0m12:52:24.383324 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_bookings
[0m12:52:24.389419 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:52:24.389738 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: BEGIN
[0m12:52:24.389905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.393950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.394284 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:52:24.394474 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.405675 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:52:24.409281 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:52:24.409517 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.415494 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:52:24.418620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_bookings"
[0m12:52:24.418998 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_bookings
[0m12:52:24.421729 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_bookings"
[0m12:52:24.422046 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:52:24.422287 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

  create view "postgres"."dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed"."bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS BOOK_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOOK_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    BOOK_PK,
    BOOK_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.427899 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:52:24.430252 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:52:24.430468 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
alter table "postgres"."dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m12:52:24.431679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.432547 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:52:24.432787 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:52:24.432950 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m12:52:24.435724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.437456 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_bookings__dbt_backup"
[0m12:52:24.437903 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m12:52:24.438101 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m12:52:24.439564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.440298 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: Close
[0m12:52:24.440814 [info ] [Thread-1 (]: 12 of 36 OK created sql view model dwh_detailed.stg_bookings ................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:52:24.441160 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_bookings
[0m12:52:24.441371 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_flights
[0m12:52:24.441627 [info ] [Thread-1 (]: 13 of 36 START sql view model dwh_detailed.stg_flights ......................... [RUN]
[0m12:52:24.442216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_bookings, now model.dbtvault.stg_flights)
[0m12:52:24.442636 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_flights
[0m12:52:24.447856 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:52:24.448105 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: BEGIN
[0m12:52:24.448285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.452620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.452938 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:52:24.453115 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.464240 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m12:52:24.467956 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:52:24.468196 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.474352 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m12:52:24.481976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_flights"
[0m12:52:24.482341 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_flights
[0m12:52:24.484748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_flights"
[0m12:52:24.485057 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:52:24.485289 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

  create view "postgres"."dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed"."flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS FLIGHT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS FLIGHT_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_AIRCRAFT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_ARRIVAL_AIRPORT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    FLIGHT_PK,
    FLIGHT_HASHDIFF,
    LINK_FLIGHT_AIRCRAFT_PK,
    LINK_FLIGHT_ARRIVAL_AIRPORT_PK,
    LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.504557 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m12:52:24.507286 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:52:24.507529 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
alter table "postgres"."dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m12:52:24.508906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.509770 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:52:24.509992 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:52:24.510165 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m12:52:24.513387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.515152 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_flights__dbt_backup"
[0m12:52:24.515555 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m12:52:24.515743 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_flights__dbt_backup" cascade
[0m12:52:24.516990 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.517750 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: Close
[0m12:52:24.518279 [info ] [Thread-1 (]: 13 of 36 OK created sql view model dwh_detailed.stg_flights .................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:52:24.518808 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_flights
[0m12:52:24.519267 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_seats
[0m12:52:24.519795 [info ] [Thread-1 (]: 14 of 36 START sql view model dwh_detailed.stg_seats ........................... [RUN]
[0m12:52:24.520435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_flights, now model.dbtvault.stg_seats)
[0m12:52:24.520669 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_seats
[0m12:52:24.525439 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:52:24.525799 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: BEGIN
[0m12:52:24.525991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.529798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.530065 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:52:24.530264 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.541465 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m12:52:24.545284 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:52:24.545524 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.551548 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m12:52:24.555830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_seats"
[0m12:52:24.556161 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_seats
[0m12:52:24.558481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_seats"
[0m12:52:24.558802 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:52:24.559008 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

  create view "postgres"."dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed"."seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS SEAT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_SEAT_AIRCRAFT_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')), 'hex') AS SEAT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    SEAT_PK,
    LINK_SEAT_AIRCRAFT_PK,
    SEAT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.564828 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:24.567012 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:52:24.567257 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
alter table "postgres"."dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m12:52:24.568460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.569267 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:52:24.569462 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:52:24.569621 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m12:52:24.572384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.574345 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_seats__dbt_backup"
[0m12:52:24.574742 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m12:52:24.574922 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
drop view if exists "postgres"."dwh_detailed"."stg_seats__dbt_backup" cascade
[0m12:52:24.576250 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.577012 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: Close
[0m12:52:24.577552 [info ] [Thread-1 (]: 14 of 36 OK created sql view model dwh_detailed.stg_seats ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:52:24.577887 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_seats
[0m12:52:24.578103 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_ticket_flights
[0m12:52:24.578397 [info ] [Thread-1 (]: 15 of 36 START sql view model dwh_detailed.stg_ticket_flights .................. [RUN]
[0m12:52:24.578707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_seats, now model.dbtvault.stg_ticket_flights)
[0m12:52:24.579389 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_ticket_flights
[0m12:52:24.584201 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:52:24.584424 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: BEGIN
[0m12:52:24.584583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.588351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.588596 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:52:24.588766 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.600100 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m12:52:24.603583 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:52:24.603836 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.609769 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:52:24.648538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_ticket_flights"
[0m12:52:24.648959 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_ticket_flights
[0m12:52:24.651250 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_ticket_flights"
[0m12:52:24.651585 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:52:24.651821 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed"."ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKET_FLIGHTS_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    TICKET_FLIGHTS_HASHDIFF,
    LINK_TICKET_FLIGHTS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.658439 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:24.660680 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:52:24.660914 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m12:52:24.662098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.662913 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:52:24.663155 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:52:24.663318 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m12:52:24.666302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.667975 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m12:52:24.668382 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m12:52:24.668561 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m12:52:24.669936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.670672 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: Close
[0m12:52:24.671178 [info ] [Thread-1 (]: 15 of 36 OK created sql view model dwh_detailed.stg_ticket_flights ............. [[32mCREATE VIEW[0m in 0.09s]
[0m12:52:24.671495 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_ticket_flights
[0m12:52:24.671707 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_tickets
[0m12:52:24.671959 [info ] [Thread-1 (]: 16 of 36 START sql view model dwh_detailed.stg_tickets ......................... [RUN]
[0m12:52:24.672250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_ticket_flights, now model.dbtvault.stg_tickets)
[0m12:52:24.672456 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_tickets
[0m12:52:24.677292 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:52:24.677621 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: BEGIN
[0m12:52:24.677904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.681769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.682086 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:52:24.682263 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.693443 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m12:52:24.696741 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:52:24.696970 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m12:52:24.703088 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:52:24.707492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_tickets"
[0m12:52:24.707849 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_tickets
[0m12:52:24.710234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_tickets"
[0m12:52:24.710547 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:52:24.710770 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

  create view "postgres"."dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed"."tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS TICKET_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_BOOKING_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKETHASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    TICKET_PK,
    LINK_TICKET_BOOKING_PK,
    TICKETHASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m12:52:24.717631 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:52:24.721576 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:52:24.721838 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
alter table "postgres"."dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m12:52:24.723197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:24.724005 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:52:24.724227 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:52:24.724384 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m12:52:24.727216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.728910 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_tickets__dbt_backup"
[0m12:52:24.729331 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m12:52:24.729530 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m12:52:24.730741 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:52:24.731510 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: Close
[0m12:52:24.732040 [info ] [Thread-1 (]: 16 of 36 OK created sql view model dwh_detailed.stg_tickets .................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:52:24.732365 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_tickets
[0m12:52:24.732596 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_aircraft
[0m12:52:24.733179 [info ] [Thread-1 (]: 17 of 36 START sql incremental model dwh_detailed.hub_aircraft ................. [RUN]
[0m12:52:24.733641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_tickets, now model.dbtvault.hub_aircraft)
[0m12:52:24.734005 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_aircraft
[0m12:52:24.740968 [info ] [Thread-1 (]: 12:52:24 + Loading postgres.dwh_detailed.hub_aircraft from 1 source(s)
[0m12:52:24.742744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_aircraft"
[0m12:52:24.743091 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_aircraft
[0m12:52:24.763776 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_aircraft"
[0m12:52:24.764160 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:52:24.764366 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: BEGIN
[0m12:52:24.764525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.768363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.768617 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:52:24.768805 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRCRAFT_PK) rr.AIRCRAFT_PK, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.AIRCRAFT_PK IS NOT NULL
    ORDER BY rr.AIRCRAFT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRCRAFT_PK, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:24.787249 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:52:24.790520 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:52:24.790806 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m12:52:24.790980 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m12:52:24.793638 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:24.794233 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: Close
[0m12:52:24.794763 [info ] [Thread-1 (]: 17 of 36 OK created sql incremental model dwh_detailed.hub_aircraft ............ [[32mSELECT 1[0m in 0.06s]
[0m12:52:24.795104 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_aircraft
[0m12:52:24.795331 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_aircraft_data
[0m12:52:24.795596 [info ] [Thread-1 (]: 18 of 36 START sql incremental model dwh_detailed.sat_aircraft_data ............ [RUN]
[0m12:52:24.795908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_aircraft, now model.dbtvault.sat_aircraft_data)
[0m12:52:24.796115 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_aircraft_data
[0m12:52:24.801984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_aircraft_data"
[0m12:52:24.802341 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_aircraft_data
[0m12:52:24.805112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_aircraft_data"
[0m12:52:24.805478 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:52:24.805659 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: BEGIN
[0m12:52:24.805807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.809895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.810139 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:52:24.810322 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_aircraft_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRCRAFT_PK, a.AIRCRAFT_HASHDIFF, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS a
    WHERE a.AIRCRAFT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:24.836309 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m12:52:24.837434 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m12:52:24.837672 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m12:52:24.837837 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m12:52:24.840843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.841385 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: Close
[0m12:52:24.841930 [info ] [Thread-1 (]: 18 of 36 OK created sql incremental model dwh_detailed.sat_aircraft_data ....... [[32mSELECT 1[0m in 0.05s]
[0m12:52:24.842280 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_aircraft_data
[0m12:52:24.842490 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_airport
[0m12:52:24.842759 [info ] [Thread-1 (]: 19 of 36 START sql incremental model dwh_detailed.hub_airport .................. [RUN]
[0m12:52:24.843035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_aircraft_data, now model.dbtvault.hub_airport)
[0m12:52:24.843212 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_airport
[0m12:52:24.847027 [info ] [Thread-1 (]: 12:52:24 + Loading postgres.dwh_detailed.hub_airport from 1 source(s)
[0m12:52:24.848930 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_airport"
[0m12:52:24.849242 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_airport
[0m12:52:24.851885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_airport"
[0m12:52:24.852208 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:52:24.852386 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: BEGIN
[0m12:52:24.852533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.856770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.857041 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:52:24.857220 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_PK) rr.AIRPORT_PK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS rr
    WHERE rr.AIRPORT_PK IS NOT NULL
    ORDER BY rr.AIRPORT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_PK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:24.875528 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m12:52:24.876625 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:52:24.876857 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m12:52:24.877044 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m12:52:24.879848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.880357 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: Close
[0m12:52:24.880867 [info ] [Thread-1 (]: 19 of 36 OK created sql incremental model dwh_detailed.hub_airport ............. [[32mSELECT 2[0m in 0.04s]
[0m12:52:24.881201 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_airport
[0m12:52:24.881417 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_airports_data
[0m12:52:24.881663 [info ] [Thread-1 (]: 20 of 36 START sql incremental model dwh_detailed.sat_airports_data ............ [RUN]
[0m12:52:24.881921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_airport, now model.dbtvault.sat_airports_data)
[0m12:52:24.882094 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_airports_data
[0m12:52:24.889209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_airports_data"
[0m12:52:24.889587 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_airports_data
[0m12:52:24.892768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_airports_data"
[0m12:52:24.893103 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:52:24.893283 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: BEGIN
[0m12:52:24.893432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.897349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.897603 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:52:24.897796 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_airports_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS a
    WHERE a.AIRPORT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRPORT_PK, stage.AIRPORT_HASHDIFF, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:24.925220 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.027 seconds
[0m12:52:24.926379 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:52:24.926625 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m12:52:24.926795 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m12:52:24.929551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:24.930093 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: Close
[0m12:52:24.930647 [info ] [Thread-1 (]: 20 of 36 OK created sql incremental model dwh_detailed.sat_airports_data ....... [[32mSELECT 2[0m in 0.05s]
[0m12:52:24.931491 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_airports_data
[0m12:52:24.932516 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:52:24.933220 [info ] [Thread-1 (]: 21 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [RUN]
[0m12:52:24.933585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_airports_data, now model.dbtvault.sat_ticket_flights_boarding_passes)
[0m12:52:24.933783 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:52:24.939569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:52:24.939970 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:52:24.942622 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:52:24.942962 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:52:24.943155 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: BEGIN
[0m12:52:24.943310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.947104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.947328 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:52:24.947510 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.TICKET_FLIGHTS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_FLIGHTS_PK, stage.BOARDING_PASSES_HASHDIFF, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:24.973460 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m12:52:24.974580 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:52:24.974831 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m12:52:24.975004 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m12:52:24.977717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:24.978299 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: Close
[0m12:52:24.978858 [info ] [Thread-1 (]: 21 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [[32mSELECT 1[0m in 0.05s]
[0m12:52:24.979175 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m12:52:24.979394 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_booking
[0m12:52:24.979659 [info ] [Thread-1 (]: 22 of 36 START sql incremental model dwh_detailed.hub_booking .................. [RUN]
[0m12:52:24.980019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_boarding_passes, now model.dbtvault.hub_booking)
[0m12:52:24.980220 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_booking
[0m12:52:24.984113 [info ] [Thread-1 (]: 12:52:24 + Loading postgres.dwh_detailed.hub_booking from 1 source(s)
[0m12:52:24.985843 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_booking"
[0m12:52:24.986187 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_booking
[0m12:52:24.988868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_booking"
[0m12:52:24.989181 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:52:24.989375 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: BEGIN
[0m12:52:24.989528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:24.993140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:24.993371 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:52:24.993627 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_booking"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS rr
    WHERE rr.BOOK_PK IS NOT NULL
    ORDER BY rr.BOOK_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.BOOK_PK, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.010876 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:52:25.012001 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:52:25.012254 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m12:52:25.012415 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m12:52:25.015165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.015691 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: Close
[0m12:52:25.016216 [info ] [Thread-1 (]: 22 of 36 OK created sql incremental model dwh_detailed.hub_booking ............. [[32mSELECT 1[0m in 0.04s]
[0m12:52:25.016535 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_booking
[0m12:52:25.016745 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_booking_data
[0m12:52:25.017013 [info ] [Thread-1 (]: 23 of 36 START sql incremental model dwh_detailed.sat_booking_data ............. [RUN]
[0m12:52:25.017294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_booking, now model.dbtvault.sat_booking_data)
[0m12:52:25.017473 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_booking_data
[0m12:52:25.023331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_booking_data"
[0m12:52:25.023677 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_booking_data
[0m12:52:25.026981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_booking_data"
[0m12:52:25.027334 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:52:25.027530 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: BEGIN
[0m12:52:25.027684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.031466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.031711 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:52:25.031899 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_booking_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS a
    WHERE a.BOOK_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.BOOK_PK, stage.BOOK_HASHDIFF, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.057468 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:52:25.058720 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:52:25.058968 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m12:52:25.059130 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m12:52:25.061971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.062494 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: Close
[0m12:52:25.063081 [info ] [Thread-1 (]: 23 of 36 OK created sql incremental model dwh_detailed.sat_booking_data ........ [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.063420 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_booking_data
[0m12:52:25.063901 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_flight
[0m12:52:25.064181 [info ] [Thread-1 (]: 24 of 36 START sql incremental model dwh_detailed.hub_flight ................... [RUN]
[0m12:52:25.064459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_booking_data, now model.dbtvault.hub_flight)
[0m12:52:25.064814 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_flight
[0m12:52:25.067893 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.hub_flight from 1 source(s)
[0m12:52:25.069671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_flight"
[0m12:52:25.069995 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_flight
[0m12:52:25.072727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_flight"
[0m12:52:25.073029 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:52:25.073231 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: BEGIN
[0m12:52:25.073381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.077092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.077364 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:52:25.077542 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_flight"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.FLIGHT_PK) rr.FLIGHT_PK, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.FLIGHT_PK IS NOT NULL
    ORDER BY rr.FLIGHT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.FLIGHT_PK, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.094117 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m12:52:25.095241 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:52:25.095477 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m12:52:25.095641 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m12:52:25.098199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:25.098736 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: Close
[0m12:52:25.099266 [info ] [Thread-1 (]: 24 of 36 OK created sql incremental model dwh_detailed.hub_flight .............. [[32mSELECT 1[0m in 0.03s]
[0m12:52:25.099622 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_flight
[0m12:52:25.099838 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_aircraft
[0m12:52:25.100120 [info ] [Thread-1 (]: 25 of 36 START sql incremental model dwh_detailed.link_flight_aircraft ......... [RUN]
[0m12:52:25.100402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_flight, now model.dbtvault.link_flight_aircraft)
[0m12:52:25.100899 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_aircraft
[0m12:52:25.104081 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.link_flight_aircraft from 1 source(s)
[0m12:52:25.106637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_aircraft"
[0m12:52:25.106987 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_aircraft
[0m12:52:25.109743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_aircraft"
[0m12:52:25.110065 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:52:25.110245 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: BEGIN
[0m12:52:25.110396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.114627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.114881 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:52:25.115078 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_AIRCRAFT_PK, rr.flight_id, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_AIRCRAFT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_AIRCRAFT_PK, a.flight_id, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.147144 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m12:52:25.148276 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:52:25.148550 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m12:52:25.148709 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m12:52:25.151434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.151963 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: Close
[0m12:52:25.152500 [info ] [Thread-1 (]: 25 of 36 OK created sql incremental model dwh_detailed.link_flight_aircraft .... [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.152847 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_aircraft
[0m12:52:25.153056 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_arrival_airport
[0m12:52:25.153304 [info ] [Thread-1 (]: 26 of 36 START sql incremental model dwh_detailed.link_flight_arrival_airport .. [RUN]
[0m12:52:25.153586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_aircraft, now model.dbtvault.link_flight_arrival_airport)
[0m12:52:25.153779 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_arrival_airport
[0m12:52:25.156900 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.link_flight_arrival_airport from 1 source(s)
[0m12:52:25.159033 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_arrival_airport"
[0m12:52:25.159369 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_arrival_airport
[0m12:52:25.162104 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_arrival_airport"
[0m12:52:25.162436 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:52:25.162617 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: BEGIN
[0m12:52:25.162766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.166574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.166822 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:52:25.167004 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_arrival_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, rr.flight_id, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, a.flight_id, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.198857 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m12:52:25.200041 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:52:25.200309 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m12:52:25.200473 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m12:52:25.203440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.203999 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: Close
[0m12:52:25.204598 [info ] [Thread-1 (]: 26 of 36 OK created sql incremental model dwh_detailed.link_flight_arrival_airport  [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.204937 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_arrival_airport
[0m12:52:25.205175 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_departure_airport
[0m12:52:25.205515 [info ] [Thread-1 (]: 27 of 36 START sql incremental model dwh_detailed.link_flight_departure_airport  [RUN]
[0m12:52:25.205817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_arrival_airport, now model.dbtvault.link_flight_departure_airport)
[0m12:52:25.206014 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_departure_airport
[0m12:52:25.210674 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.link_flight_departure_airport from 1 source(s)
[0m12:52:25.212768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_departure_airport"
[0m12:52:25.213163 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_departure_airport
[0m12:52:25.215839 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_departure_airport"
[0m12:52:25.216189 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:52:25.216384 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: BEGIN
[0m12:52:25.216545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.220384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.220635 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:52:25.220820 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_departure_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, rr.flight_id, rr.departure_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, a.flight_id, a.departure_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.253703 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.033 seconds
[0m12:52:25.254806 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:52:25.255082 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m12:52:25.255249 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m12:52:25.258244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.258761 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: Close
[0m12:52:25.259312 [info ] [Thread-1 (]: 27 of 36 OK created sql incremental model dwh_detailed.link_flight_departure_airport  [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.259641 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_departure_airport
[0m12:52:25.259854 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_flight_data
[0m12:52:25.260122 [info ] [Thread-1 (]: 28 of 36 START sql incremental model dwh_detailed.sat_flight_data .............. [RUN]
[0m12:52:25.260413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_departure_airport, now model.dbtvault.sat_flight_data)
[0m12:52:25.260603 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_flight_data
[0m12:52:25.267611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_flight_data"
[0m12:52:25.267996 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_flight_data
[0m12:52:25.271277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_flight_data"
[0m12:52:25.271604 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:52:25.271798 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: BEGIN
[0m12:52:25.271954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.275485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m12:52:25.275712 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:52:25.275897 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_flight_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.status, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS a
    WHERE a.FLIGHT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.FLIGHT_PK, stage.FLIGHT_HASHDIFF, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.status, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.306874 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.031 seconds
[0m12:52:25.308063 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:52:25.308313 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m12:52:25.308474 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m12:52:25.311176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:25.311691 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: Close
[0m12:52:25.312246 [info ] [Thread-1 (]: 28 of 36 OK created sql incremental model dwh_detailed.sat_flight_data ......... [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.312589 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_flight_data
[0m12:52:25.312841 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_seat
[0m12:52:25.313121 [info ] [Thread-1 (]: 29 of 36 START sql incremental model dwh_detailed.hub_seat ..................... [RUN]
[0m12:52:25.313377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_flight_data, now model.dbtvault.hub_seat)
[0m12:52:25.313564 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_seat
[0m12:52:25.316851 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.hub_seat from 1 source(s)
[0m12:52:25.319097 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_seat"
[0m12:52:25.319421 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_seat
[0m12:52:25.322309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_seat"
[0m12:52:25.322626 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:52:25.322799 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: BEGIN
[0m12:52:25.322961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.326852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.327112 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:52:25.327297 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_seat"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.SEAT_PK) rr.SEAT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.SEAT_PK IS NOT NULL
    ORDER BY rr.SEAT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.SEAT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.344715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:52:25.345822 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:52:25.346075 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m12:52:25.346231 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m12:52:25.349041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.349561 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: Close
[0m12:52:25.350118 [info ] [Thread-1 (]: 29 of 36 OK created sql incremental model dwh_detailed.hub_seat ................ [[32mSELECT 1[0m in 0.04s]
[0m12:52:25.350452 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_seat
[0m12:52:25.350667 [debug] [Thread-1 (]: Began running node model.dbtvault.link_seat_aircraft
[0m12:52:25.350939 [info ] [Thread-1 (]: 30 of 36 START sql incremental model dwh_detailed.link_seat_aircraft ........... [RUN]
[0m12:52:25.351227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_seat, now model.dbtvault.link_seat_aircraft)
[0m12:52:25.351811 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_seat_aircraft
[0m12:52:25.355714 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.link_seat_aircraft from 1 source(s)
[0m12:52:25.357702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_seat_aircraft"
[0m12:52:25.358103 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_seat_aircraft
[0m12:52:25.360990 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_seat_aircraft"
[0m12:52:25.361298 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:52:25.361508 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: BEGIN
[0m12:52:25.361680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.365544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.365820 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:52:25.366005 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_seat_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_SEAT_AIRCRAFT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SEAT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.LINK_SEAT_AIRCRAFT_PK IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SEAT_AIRCRAFT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.392944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m12:52:25.394033 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:52:25.394265 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m12:52:25.394453 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m12:52:25.397015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:25.397538 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: Close
[0m12:52:25.398069 [info ] [Thread-1 (]: 30 of 36 OK created sql incremental model dwh_detailed.link_seat_aircraft ...... [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.398407 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_seat_aircraft
[0m12:52:25.398621 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_seat_data
[0m12:52:25.398869 [info ] [Thread-1 (]: 31 of 36 START sql incremental model dwh_detailed.sat_seat_data ................ [RUN]
[0m12:52:25.399137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_seat_aircraft, now model.dbtvault.sat_seat_data)
[0m12:52:25.399330 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_seat_data
[0m12:52:25.405574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_seat_data"
[0m12:52:25.405971 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_seat_data
[0m12:52:25.409510 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_seat_data"
[0m12:52:25.409841 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:52:25.410031 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: BEGIN
[0m12:52:25.410213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.414355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.414584 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:52:25.414769 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_seat_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS a
    WHERE a.SEAT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SEAT_PK, stage.SEAT_HASHDIFF, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.440389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:52:25.441495 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:52:25.441754 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m12:52:25.441925 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m12:52:25.444500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:25.445019 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: Close
[0m12:52:25.445550 [info ] [Thread-1 (]: 31 of 36 OK created sql incremental model dwh_detailed.sat_seat_data ........... [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.445869 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_seat_data
[0m12:52:25.446094 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_flights
[0m12:52:25.446520 [info ] [Thread-1 (]: 32 of 36 START sql incremental model dwh_detailed.link_ticket_flights .......... [RUN]
[0m12:52:25.447073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_seat_data, now model.dbtvault.link_ticket_flights)
[0m12:52:25.447657 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_flights
[0m12:52:25.451042 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.link_ticket_flights from 1 source(s)
[0m12:52:25.453128 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_flights"
[0m12:52:25.453495 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_flights
[0m12:52:25.456317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_flights"
[0m12:52:25.456648 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:52:25.456825 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: BEGIN
[0m12:52:25.456971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.461165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.461458 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:52:25.461637 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_FLIGHTS_PK, rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_FLIGHTS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.LINK_TICKET_FLIGHTS_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.488470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m12:52:25.489649 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:52:25.489893 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m12:52:25.490052 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m12:52:25.492604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:25.493122 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: Close
[0m12:52:25.493679 [info ] [Thread-1 (]: 32 of 36 OK created sql incremental model dwh_detailed.link_ticket_flights ..... [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.493995 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_flights
[0m12:52:25.494206 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_data
[0m12:52:25.494491 [info ] [Thread-1 (]: 33 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_data ...... [RUN]
[0m12:52:25.494758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_flights, now model.dbtvault.sat_ticket_flights_data)
[0m12:52:25.494960 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_data
[0m12:52:25.502020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_data"
[0m12:52:25.502387 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_data
[0m12:52:25.505216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_data"
[0m12:52:25.505566 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:52:25.505747 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: BEGIN
[0m12:52:25.505896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.509747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.510005 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:52:25.510187 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_flights_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.LINK_TICKET_FLIGHTS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_PK, stage.TICKET_FLIGHTS_HASHDIFF, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.535922 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:52:25.537031 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:52:25.537350 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m12:52:25.537519 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m12:52:25.540112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:25.540670 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: Close
[0m12:52:25.541215 [info ] [Thread-1 (]: 33 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_data . [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.541567 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_data
[0m12:52:25.541802 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_ticket
[0m12:52:25.542066 [info ] [Thread-1 (]: 34 of 36 START sql incremental model dwh_detailed.hub_ticket ................... [RUN]
[0m12:52:25.542321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_data, now model.dbtvault.hub_ticket)
[0m12:52:25.542564 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_ticket
[0m12:52:25.545794 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.hub_ticket from 1 source(s)
[0m12:52:25.547956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_ticket"
[0m12:52:25.549065 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_ticket
[0m12:52:25.551981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_ticket"
[0m12:52:25.552351 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:52:25.552532 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: BEGIN
[0m12:52:25.552685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.556494 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.556740 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:52:25.556929 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_ticket"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.TICKET_PK IS NOT NULL
    ORDER BY rr.TICKET_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.TICKET_PK, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.574997 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m12:52:25.576204 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:52:25.576546 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m12:52:25.576706 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m12:52:25.580339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.580988 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: Close
[0m12:52:25.581557 [info ] [Thread-1 (]: 34 of 36 OK created sql incremental model dwh_detailed.hub_ticket .............. [[32mSELECT 1[0m in 0.04s]
[0m12:52:25.581880 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_ticket
[0m12:52:25.582085 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_booking
[0m12:52:25.582441 [info ] [Thread-1 (]: 35 of 36 START sql incremental model dwh_detailed.link_ticket_booking .......... [RUN]
[0m12:52:25.582719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_ticket, now model.dbtvault.link_ticket_booking)
[0m12:52:25.582932 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_booking
[0m12:52:25.587442 [info ] [Thread-1 (]: 12:52:25 + Loading postgres.dwh_detailed.link_ticket_booking from 1 source(s)
[0m12:52:25.589632 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_booking"
[0m12:52:25.590006 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_booking
[0m12:52:25.592791 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_booking"
[0m12:52:25.593140 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:52:25.593321 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: BEGIN
[0m12:52:25.593471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.597180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.597407 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:52:25.597603 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_ticket_booking"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_BOOKING_PK, rr.ticket_no, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_BOOKING_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.LINK_TICKET_BOOKING_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_BOOKING_PK, a.ticket_no, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.626476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m12:52:25.627674 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:52:25.627919 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m12:52:25.628095 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m12:52:25.630812 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.631355 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: Close
[0m12:52:25.631921 [info ] [Thread-1 (]: 35 of 36 OK created sql incremental model dwh_detailed.link_ticket_booking ..... [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.632296 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_booking
[0m12:52:25.632524 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_data
[0m12:52:25.632789 [info ] [Thread-1 (]: 36 of 36 START sql incremental model dwh_detailed.sat_ticket_data .............. [RUN]
[0m12:52:25.633059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_booking, now model.dbtvault.sat_ticket_data)
[0m12:52:25.633267 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_data
[0m12:52:25.640208 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_data"
[0m12:52:25.640615 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_data
[0m12:52:25.644130 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_data"
[0m12:52:25.644491 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:52:25.644670 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: BEGIN
[0m12:52:25.644832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:25.648763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.649015 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:52:25.649195 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_PK, a.TICKETHASHDIFF, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS a
    WHERE a.TICKET_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_PK, stage.TICKETHASHDIFF, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m12:52:25.676292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m12:52:25.677395 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: COMMIT
[0m12:52:25.677670 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m12:52:25.677832 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: COMMIT
[0m12:52:25.680683 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:52:25.681259 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: Close
[0m12:52:25.681845 [info ] [Thread-1 (]: 36 of 36 OK created sql incremental model dwh_detailed.sat_ticket_data ......... [[32mSELECT 1[0m in 0.05s]
[0m12:52:25.682180 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_data
[0m12:52:25.684484 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:25.684883 [debug] [MainThread]: On master: BEGIN
[0m12:52:25.685035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:25.689030 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:52:25.689265 [debug] [MainThread]: On master: COMMIT
[0m12:52:25.689428 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:25.689575 [debug] [MainThread]: On master: COMMIT
[0m12:52:25.690007 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:25.690247 [debug] [MainThread]: On master: Close
[0m12:52:25.690492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:25.690644 [debug] [MainThread]: Connection 'model.dbtvault.sat_ticket_data' was properly closed.
[0m12:52:25.690882 [info ] [MainThread]: 
[0m12:52:25.691066 [info ] [MainThread]: Finished running 20 incremental models, 16 view models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m12:52:25.693681 [debug] [MainThread]: Command end result
[0m12:52:25.750423 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m12:52:25.751476 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m12:52:25.755764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/user/dwh/dbt/target/run_results.json
[0m12:52:25.755974 [info ] [MainThread]: 
[0m12:52:25.756212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:25.756416 [info ] [MainThread]: 
[0m12:52:25.756591 [info ] [MainThread]: Done. PASS=36 WARN=0 ERROR=0 SKIP=0 TOTAL=36
[0m12:52:25.757583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8936346, "process_in_blocks": "53248", "process_kernel_time": 0.154329, "process_mem_max_rss": "124252", "process_out_blocks": "7240", "process_user_time": 3.122912}
[0m12:52:25.757842 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:25.757773 after 3.89 seconds
[0m12:52:25.758016 [debug] [MainThread]: Flushing usage events


============================== 13:24:09.969859 | 2ff4996f-d115-458f-a3e6-e683c6b6df41 ==============================
[0m13:24:09.969859 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:24:09.972481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/user/dwh/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m13:24:09.972730 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:24:10.144817 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:10.189494 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:24:10.331831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:10.332137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:10.336448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m13:24:10.408876 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m13:24:10.410800 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m13:24:10.425502 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m13:24:10.427264 [info ] [MainThread]: 
[0m13:24:10.427525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:10.427689 [info ] [MainThread]: 
[0m13:24:10.427985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:10.431788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:24:10.475885 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:24:10.476161 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:24:10.476338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:10.485120 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m13:24:10.485938 [debug] [ThreadPool]: On list_postgres: Close
[0m13:24:10.486564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_dwh_detailed)
[0m13:24:10.486890 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "dwh_detailed"
"
[0m13:24:10.490399 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m13:24:10.490623 [debug] [ThreadPool]: On create_postgres_dwh_detailed: BEGIN
[0m13:24:10.490763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:10.494693 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.494924 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m13:24:10.495066 [debug] [ThreadPool]: On create_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "create_postgres_dwh_detailed"} */
create schema if not exists "dwh_detailed"
[0m13:24:10.507519 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.012 seconds
[0m13:24:10.508207 [debug] [ThreadPool]: On create_postgres_dwh_detailed: COMMIT
[0m13:24:10.508450 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed"
[0m13:24:10.508594 [debug] [ThreadPool]: On create_postgres_dwh_detailed: COMMIT
[0m13:24:10.511828 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.512068 [debug] [ThreadPool]: On create_postgres_dwh_detailed: Close
[0m13:24:10.515194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_dwh_detailed, now list_postgres_dwh_detailed)
[0m13:24:10.520048 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m13:24:10.520315 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m13:24:10.520463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:10.525034 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:24:10.525339 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m13:24:10.525521 [debug] [ThreadPool]: On list_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed'
  
[0m13:24:10.536588 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m13:24:10.537390 [debug] [ThreadPool]: On list_postgres_dwh_detailed: ROLLBACK
[0m13:24:10.537976 [debug] [ThreadPool]: On list_postgres_dwh_detailed: Close
[0m13:24:10.541966 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:10.542164 [debug] [MainThread]: On master: BEGIN
[0m13:24:10.542298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:10.546197 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.546408 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:10.546610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:10.557589 [debug] [MainThread]: SQL status: SELECT 53 in 0.011 seconds
[0m13:24:10.559036 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:10.559609 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:10.559800 [debug] [MainThread]: On master: BEGIN
[0m13:24:10.560506 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:24:10.560724 [debug] [MainThread]: On master: COMMIT
[0m13:24:10.560879 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:10.561010 [debug] [MainThread]: On master: COMMIT
[0m13:24:10.561526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:10.561746 [debug] [MainThread]: On master: Close
[0m13:24:10.563795 [debug] [Thread-1 (]: Began running node model.dbtvault.aircrafts
[0m13:24:10.564130 [info ] [Thread-1 (]: 1 of 36 START sql view model dwh_detailed.aircrafts ............................ [RUN]
[0m13:24:10.564411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed, now model.dbtvault.aircrafts)
[0m13:24:10.564589 [debug] [Thread-1 (]: Began compiling node model.dbtvault.aircrafts
[0m13:24:10.569196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.aircrafts"
[0m13:24:10.569529 [debug] [Thread-1 (]: Began executing node model.dbtvault.aircrafts
[0m13:24:10.589146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.aircrafts"
[0m13:24:10.589658 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m13:24:10.589876 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: BEGIN
[0m13:24:10.590047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.594242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.594521 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m13:24:10.594693 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */

  create view "postgres"."dwh_detailed"."aircrafts__dbt_tmp"
    
    
  as (
    SELECT aircraft_code, model::jsonb as model, range
FROM "postgres"."public"."postgres_public_aircrafts"
  );
[0m13:24:10.611752 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m13:24:10.615992 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m13:24:10.616342 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
alter table "postgres"."dwh_detailed"."aircrafts__dbt_tmp" rename to "aircrafts"
[0m13:24:10.617637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.625368 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m13:24:10.625629 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m13:24:10.625815 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: COMMIT
[0m13:24:10.628778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.632731 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."aircrafts__dbt_backup"
[0m13:24:10.635289 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.aircrafts"
[0m13:24:10.635513 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."aircrafts__dbt_backup" cascade
[0m13:24:10.637197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:10.638735 [debug] [Thread-1 (]: On model.dbtvault.aircrafts: Close
[0m13:24:10.641474 [info ] [Thread-1 (]: 1 of 36 OK created sql view model dwh_detailed.aircrafts ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:24:10.641957 [debug] [Thread-1 (]: Finished running node model.dbtvault.aircrafts
[0m13:24:10.642205 [debug] [Thread-1 (]: Began running node model.dbtvault.airports
[0m13:24:10.642481 [info ] [Thread-1 (]: 2 of 36 START sql view model dwh_detailed.airports ............................. [RUN]
[0m13:24:10.642952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.aircrafts, now model.dbtvault.airports)
[0m13:24:10.643259 [debug] [Thread-1 (]: Began compiling node model.dbtvault.airports
[0m13:24:10.645280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.airports"
[0m13:24:10.645601 [debug] [Thread-1 (]: Began executing node model.dbtvault.airports
[0m13:24:10.648324 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.airports"
[0m13:24:10.648671 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m13:24:10.648852 [debug] [Thread-1 (]: On model.dbtvault.airports: BEGIN
[0m13:24:10.649025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.653194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.653507 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m13:24:10.653743 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */

  create view "postgres"."dwh_detailed"."airports__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_airports"
  );
[0m13:24:10.659717 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:10.662020 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m13:24:10.662247 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
alter table "postgres"."dwh_detailed"."airports__dbt_tmp" rename to "airports"
[0m13:24:10.663327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.664189 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m13:24:10.664436 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m13:24:10.664594 [debug] [Thread-1 (]: On model.dbtvault.airports: COMMIT
[0m13:24:10.667485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.669259 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."airports__dbt_backup"
[0m13:24:10.669648 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.airports"
[0m13:24:10.669822 [debug] [Thread-1 (]: On model.dbtvault.airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.airports"} */
drop view if exists "postgres"."dwh_detailed"."airports__dbt_backup" cascade
[0m13:24:10.671091 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:10.671876 [debug] [Thread-1 (]: On model.dbtvault.airports: Close
[0m13:24:10.672401 [info ] [Thread-1 (]: 2 of 36 OK created sql view model dwh_detailed.airports ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m13:24:10.672795 [debug] [Thread-1 (]: Finished running node model.dbtvault.airports
[0m13:24:10.673057 [debug] [Thread-1 (]: Began running node model.dbtvault.boarding_passes
[0m13:24:10.673711 [info ] [Thread-1 (]: 3 of 36 START sql view model dwh_detailed.boarding_passes ...................... [RUN]
[0m13:24:10.674410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.airports, now model.dbtvault.boarding_passes)
[0m13:24:10.674608 [debug] [Thread-1 (]: Began compiling node model.dbtvault.boarding_passes
[0m13:24:10.676469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.boarding_passes"
[0m13:24:10.676819 [debug] [Thread-1 (]: Began executing node model.dbtvault.boarding_passes
[0m13:24:10.679017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.boarding_passes"
[0m13:24:10.679348 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m13:24:10.679541 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: BEGIN
[0m13:24:10.679692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.683746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.684034 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m13:24:10.684209 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */

  create view "postgres"."dwh_detailed"."boarding_passes__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_boarding_passes"
  );
[0m13:24:10.691000 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:24:10.694001 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m13:24:10.694265 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
alter table "postgres"."dwh_detailed"."boarding_passes__dbt_tmp" rename to "boarding_passes"
[0m13:24:10.695380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.696229 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m13:24:10.696450 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m13:24:10.696620 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: COMMIT
[0m13:24:10.699625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.701294 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."boarding_passes__dbt_backup"
[0m13:24:10.701690 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.boarding_passes"
[0m13:24:10.701879 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."boarding_passes__dbt_backup" cascade
[0m13:24:10.703375 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:10.704255 [debug] [Thread-1 (]: On model.dbtvault.boarding_passes: Close
[0m13:24:10.704815 [info ] [Thread-1 (]: 3 of 36 OK created sql view model dwh_detailed.boarding_passes ................. [[32mCREATE VIEW[0m in 0.03s]
[0m13:24:10.705482 [debug] [Thread-1 (]: Finished running node model.dbtvault.boarding_passes
[0m13:24:10.706073 [debug] [Thread-1 (]: Began running node model.dbtvault.bookings
[0m13:24:10.706708 [info ] [Thread-1 (]: 4 of 36 START sql view model dwh_detailed.bookings ............................. [RUN]
[0m13:24:10.707181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.boarding_passes, now model.dbtvault.bookings)
[0m13:24:10.707414 [debug] [Thread-1 (]: Began compiling node model.dbtvault.bookings
[0m13:24:10.709361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.bookings"
[0m13:24:10.709691 [debug] [Thread-1 (]: Began executing node model.dbtvault.bookings
[0m13:24:10.711842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.bookings"
[0m13:24:10.712181 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m13:24:10.712360 [debug] [Thread-1 (]: On model.dbtvault.bookings: BEGIN
[0m13:24:10.712511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.716667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.716939 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m13:24:10.717109 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */

  create view "postgres"."dwh_detailed"."bookings__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_bookings"
  );
[0m13:24:10.723043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:10.725914 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m13:24:10.726137 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
alter table "postgres"."dwh_detailed"."bookings__dbt_tmp" rename to "bookings"
[0m13:24:10.727323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.728105 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m13:24:10.728306 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m13:24:10.728483 [debug] [Thread-1 (]: On model.dbtvault.bookings: COMMIT
[0m13:24:10.731617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.733367 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."bookings__dbt_backup"
[0m13:24:10.733822 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.bookings"
[0m13:24:10.734011 [debug] [Thread-1 (]: On model.dbtvault.bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.bookings"} */
drop view if exists "postgres"."dwh_detailed"."bookings__dbt_backup" cascade
[0m13:24:10.735559 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:10.736506 [debug] [Thread-1 (]: On model.dbtvault.bookings: Close
[0m13:24:10.737462 [info ] [Thread-1 (]: 4 of 36 OK created sql view model dwh_detailed.bookings ........................ [[32mCREATE VIEW[0m in 0.03s]
[0m13:24:10.738693 [debug] [Thread-1 (]: Finished running node model.dbtvault.bookings
[0m13:24:10.739140 [debug] [Thread-1 (]: Began running node model.dbtvault.flights
[0m13:24:10.739462 [info ] [Thread-1 (]: 5 of 36 START sql view model dwh_detailed.flights .............................. [RUN]
[0m13:24:10.740025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.bookings, now model.dbtvault.flights)
[0m13:24:10.740236 [debug] [Thread-1 (]: Began compiling node model.dbtvault.flights
[0m13:24:10.742197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.flights"
[0m13:24:10.742519 [debug] [Thread-1 (]: Began executing node model.dbtvault.flights
[0m13:24:10.744869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.flights"
[0m13:24:10.745189 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m13:24:10.745370 [debug] [Thread-1 (]: On model.dbtvault.flights: BEGIN
[0m13:24:10.745524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.749591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.749830 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m13:24:10.750002 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */

  create view "postgres"."dwh_detailed"."flights__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_flights"
  );
[0m13:24:10.756078 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:10.758947 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m13:24:10.759181 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
alter table "postgres"."dwh_detailed"."flights__dbt_tmp" rename to "flights"
[0m13:24:10.760150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.760980 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m13:24:10.761184 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m13:24:10.761340 [debug] [Thread-1 (]: On model.dbtvault.flights: COMMIT
[0m13:24:10.764215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.765869 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."flights__dbt_backup"
[0m13:24:10.766257 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.flights"
[0m13:24:10.766452 [debug] [Thread-1 (]: On model.dbtvault.flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.flights"} */
drop view if exists "postgres"."dwh_detailed"."flights__dbt_backup" cascade
[0m13:24:10.767942 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:10.768867 [debug] [Thread-1 (]: On model.dbtvault.flights: Close
[0m13:24:10.769409 [info ] [Thread-1 (]: 5 of 36 OK created sql view model dwh_detailed.flights ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:24:10.769746 [debug] [Thread-1 (]: Finished running node model.dbtvault.flights
[0m13:24:10.769961 [debug] [Thread-1 (]: Began running node model.dbtvault.seats
[0m13:24:10.770242 [info ] [Thread-1 (]: 6 of 36 START sql view model dwh_detailed.seats ................................ [RUN]
[0m13:24:10.770879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.flights, now model.dbtvault.seats)
[0m13:24:10.771369 [debug] [Thread-1 (]: Began compiling node model.dbtvault.seats
[0m13:24:10.773293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.seats"
[0m13:24:10.773676 [debug] [Thread-1 (]: Began executing node model.dbtvault.seats
[0m13:24:10.775910 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.seats"
[0m13:24:10.776247 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m13:24:10.776425 [debug] [Thread-1 (]: On model.dbtvault.seats: BEGIN
[0m13:24:10.776571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.780815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.781100 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m13:24:10.781271 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */

  create view "postgres"."dwh_detailed"."seats__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_seats"
  );
[0m13:24:10.787371 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:10.789647 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m13:24:10.789875 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
alter table "postgres"."dwh_detailed"."seats__dbt_tmp" rename to "seats"
[0m13:24:10.790821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.791678 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m13:24:10.791879 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m13:24:10.792029 [debug] [Thread-1 (]: On model.dbtvault.seats: COMMIT
[0m13:24:10.795212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.797461 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."seats__dbt_backup"
[0m13:24:10.798051 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.seats"
[0m13:24:10.798256 [debug] [Thread-1 (]: On model.dbtvault.seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.seats"} */
drop view if exists "postgres"."dwh_detailed"."seats__dbt_backup" cascade
[0m13:24:10.799641 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:10.800457 [debug] [Thread-1 (]: On model.dbtvault.seats: Close
[0m13:24:10.801174 [info ] [Thread-1 (]: 6 of 36 OK created sql view model dwh_detailed.seats ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:24:10.802018 [debug] [Thread-1 (]: Finished running node model.dbtvault.seats
[0m13:24:10.802606 [debug] [Thread-1 (]: Began running node model.dbtvault.ticket_flights
[0m13:24:10.803037 [info ] [Thread-1 (]: 7 of 36 START sql view model dwh_detailed.ticket_flights ....................... [RUN]
[0m13:24:10.803528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.seats, now model.dbtvault.ticket_flights)
[0m13:24:10.803791 [debug] [Thread-1 (]: Began compiling node model.dbtvault.ticket_flights
[0m13:24:10.805700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.ticket_flights"
[0m13:24:10.806005 [debug] [Thread-1 (]: Began executing node model.dbtvault.ticket_flights
[0m13:24:10.808186 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.ticket_flights"
[0m13:24:10.808551 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m13:24:10.808735 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: BEGIN
[0m13:24:10.808891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.812868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.813128 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m13:24:10.813319 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */

  create view "postgres"."dwh_detailed"."ticket_flights__dbt_tmp"
    
    
  as (
    SELECT * FROM "postgres"."public"."postgres_public_ticket_flights"
  );
[0m13:24:10.819902 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:10.822239 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m13:24:10.822478 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
alter table "postgres"."dwh_detailed"."ticket_flights__dbt_tmp" rename to "ticket_flights"
[0m13:24:10.823509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.824605 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m13:24:10.824825 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m13:24:10.824990 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: COMMIT
[0m13:24:10.827921 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:10.830049 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."ticket_flights__dbt_backup"
[0m13:24:10.830431 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.ticket_flights"
[0m13:24:10.830604 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."ticket_flights__dbt_backup" cascade
[0m13:24:10.832034 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:10.832917 [debug] [Thread-1 (]: On model.dbtvault.ticket_flights: Close
[0m13:24:10.833495 [info ] [Thread-1 (]: 7 of 36 OK created sql view model dwh_detailed.ticket_flights .................. [[32mCREATE VIEW[0m in 0.03s]
[0m13:24:10.833938 [debug] [Thread-1 (]: Finished running node model.dbtvault.ticket_flights
[0m13:24:10.834189 [debug] [Thread-1 (]: Began running node model.dbtvault.tickets
[0m13:24:10.834887 [info ] [Thread-1 (]: 8 of 36 START sql view model dwh_detailed.tickets .............................. [RUN]
[0m13:24:10.835822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.ticket_flights, now model.dbtvault.tickets)
[0m13:24:10.836056 [debug] [Thread-1 (]: Began compiling node model.dbtvault.tickets
[0m13:24:10.837993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.tickets"
[0m13:24:10.838359 [debug] [Thread-1 (]: Began executing node model.dbtvault.tickets
[0m13:24:10.840735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.tickets"
[0m13:24:10.841092 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m13:24:10.841275 [debug] [Thread-1 (]: On model.dbtvault.tickets: BEGIN
[0m13:24:10.841445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.846655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:24:10.846992 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m13:24:10.847203 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */

  create view "postgres"."dwh_detailed"."tickets__dbt_tmp"
    
    
  as (
    SELECT ticket_no, book_ref, passenger_id, passenger_name, contact_data::jsonb as contact_data
FROM "postgres"."public"."postgres_public_tickets"
  );
[0m13:24:10.853894 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:10.856282 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m13:24:10.856517 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
alter table "postgres"."dwh_detailed"."tickets__dbt_tmp" rename to "tickets"
[0m13:24:10.857740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:10.858602 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m13:24:10.858809 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m13:24:10.858993 [debug] [Thread-1 (]: On model.dbtvault.tickets: COMMIT
[0m13:24:10.866006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:24:10.868653 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."tickets__dbt_backup"
[0m13:24:10.869134 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.tickets"
[0m13:24:10.869319 [debug] [Thread-1 (]: On model.dbtvault.tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.tickets"} */
drop view if exists "postgres"."dwh_detailed"."tickets__dbt_backup" cascade
[0m13:24:10.872191 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:24:10.873150 [debug] [Thread-1 (]: On model.dbtvault.tickets: Close
[0m13:24:10.873826 [info ] [Thread-1 (]: 8 of 36 OK created sql view model dwh_detailed.tickets ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m13:24:10.874926 [debug] [Thread-1 (]: Finished running node model.dbtvault.tickets
[0m13:24:10.875182 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_aircrafts
[0m13:24:10.875916 [info ] [Thread-1 (]: 9 of 36 START sql view model dwh_detailed.stg_aircrafts ........................ [RUN]
[0m13:24:10.876354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.tickets, now model.dbtvault.stg_aircrafts)
[0m13:24:10.876562 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_aircrafts
[0m13:24:10.899352 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m13:24:10.899679 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: BEGIN
[0m13:24:10.899844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:10.903781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:10.904057 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m13:24:10.904234 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:10.924883 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.020 seconds
[0m13:24:10.956096 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m13:24:10.956403 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:10.963565 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m13:24:10.992859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_aircrafts"
[0m13:24:10.993295 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_aircrafts
[0m13:24:10.995647 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_aircrafts"
[0m13:24:10.995967 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m13:24:10.996180 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

  create view "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed"."aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS AIRCRAFT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRCRAFT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    AIRCRAFT_PK,
    AIRCRAFT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.002303 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:11.005018 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m13:24:11.005265 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
alter table "postgres"."dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m13:24:11.006396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.007244 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m13:24:11.007459 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m13:24:11.007614 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: COMMIT
[0m13:24:11.010731 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.051171 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup"
[0m13:24:11.051737 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m13:24:11.051931 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m13:24:11.053613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:11.054533 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: Close
[0m13:24:11.055103 [info ] [Thread-1 (]: 9 of 36 OK created sql view model dwh_detailed.stg_aircrafts ................... [[32mCREATE VIEW[0m in 0.18s]
[0m13:24:11.055448 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_aircrafts
[0m13:24:11.055762 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_airports
[0m13:24:11.056379 [info ] [Thread-1 (]: 10 of 36 START sql view model dwh_detailed.stg_airports ........................ [RUN]
[0m13:24:11.056854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_aircrafts, now model.dbtvault.stg_airports)
[0m13:24:11.057107 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_airports
[0m13:24:11.061695 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m13:24:11.062128 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: BEGIN
[0m13:24:11.062334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.066608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.066949 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m13:24:11.067125 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.079108 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.012 seconds
[0m13:24:11.083114 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m13:24:11.083366 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.090021 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m13:24:11.094216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_airports"
[0m13:24:11.094650 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_airports
[0m13:24:11.097013 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_airports"
[0m13:24:11.097347 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m13:24:11.097612 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

  create view "postgres"."dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed"."airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    AIRPORT_PK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.103549 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:11.105803 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m13:24:11.106049 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
alter table "postgres"."dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m13:24:11.107130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.107982 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m13:24:11.108246 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m13:24:11.108414 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: COMMIT
[0m13:24:11.111086 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:11.112725 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_airports__dbt_backup"
[0m13:24:11.113150 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m13:24:11.113347 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */
drop view if exists "postgres"."dwh_detailed"."stg_airports__dbt_backup" cascade
[0m13:24:11.114778 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:11.115583 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: Close
[0m13:24:11.116131 [info ] [Thread-1 (]: 10 of 36 OK created sql view model dwh_detailed.stg_airports ................... [[32mCREATE VIEW[0m in 0.06s]
[0m13:24:11.116498 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_airports
[0m13:24:11.116725 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_boarding_passes
[0m13:24:11.117261 [info ] [Thread-1 (]: 11 of 36 START sql view model dwh_detailed.stg_boarding_passes ................. [RUN]
[0m13:24:11.117887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_airports, now model.dbtvault.stg_boarding_passes)
[0m13:24:11.118076 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_boarding_passes
[0m13:24:11.122917 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m13:24:11.123136 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: BEGIN
[0m13:24:11.123297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.127195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.127454 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m13:24:11.127652 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.138898 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m13:24:11.142488 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m13:24:11.142758 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.149433 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m13:24:11.153359 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_boarding_passes"
[0m13:24:11.153813 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_boarding_passes
[0m13:24:11.156614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_boarding_passes"
[0m13:24:11.156945 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m13:24:11.157192 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed"."boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS TICKET_FLIGHTS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOARDING_PASSES_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    TICKET_FLIGHTS_PK,
    BOARDING_PASSES_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.162878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:24:11.165152 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m13:24:11.165392 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m13:24:11.166476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.167379 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m13:24:11.167594 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m13:24:11.167753 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: COMMIT
[0m13:24:11.170441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.172095 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m13:24:11.172589 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m13:24:11.172783 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m13:24:11.174500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:11.175487 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: Close
[0m13:24:11.176030 [info ] [Thread-1 (]: 11 of 36 OK created sql view model dwh_detailed.stg_boarding_passes ............ [[32mCREATE VIEW[0m in 0.06s]
[0m13:24:11.176366 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_boarding_passes
[0m13:24:11.176603 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_bookings
[0m13:24:11.176869 [info ] [Thread-1 (]: 12 of 36 START sql view model dwh_detailed.stg_bookings ........................ [RUN]
[0m13:24:11.177171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_boarding_passes, now model.dbtvault.stg_bookings)
[0m13:24:11.177399 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_bookings
[0m13:24:11.182008 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m13:24:11.182482 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: BEGIN
[0m13:24:11.182659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.186298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.186535 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m13:24:11.186714 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.198160 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m13:24:11.202086 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m13:24:11.202343 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.208715 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m13:24:11.211874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_bookings"
[0m13:24:11.212221 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_bookings
[0m13:24:11.214548 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_bookings"
[0m13:24:11.214876 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m13:24:11.215080 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

  create view "postgres"."dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed"."bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS BOOK_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS BOOK_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    BOOK_PK,
    BOOK_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.220476 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:24:11.222669 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m13:24:11.222893 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
alter table "postgres"."dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m13:24:11.223890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.224710 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m13:24:11.224906 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m13:24:11.225065 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: COMMIT
[0m13:24:11.227750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:11.229989 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_bookings__dbt_backup"
[0m13:24:11.230529 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m13:24:11.230726 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m13:24:11.232168 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:11.233078 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: Close
[0m13:24:11.233628 [info ] [Thread-1 (]: 12 of 36 OK created sql view model dwh_detailed.stg_bookings ................... [[32mCREATE VIEW[0m in 0.06s]
[0m13:24:11.233987 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_bookings
[0m13:24:11.234209 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_flights
[0m13:24:11.234474 [info ] [Thread-1 (]: 13 of 36 START sql view model dwh_detailed.stg_flights ......................... [RUN]
[0m13:24:11.234776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_bookings, now model.dbtvault.stg_flights)
[0m13:24:11.235014 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_flights
[0m13:24:11.239645 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m13:24:11.240067 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: BEGIN
[0m13:24:11.240374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.243984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.244224 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m13:24:11.244437 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.255787 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m13:24:11.259403 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m13:24:11.259641 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.266155 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m13:24:11.274489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_flights"
[0m13:24:11.274900 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_flights
[0m13:24:11.277216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_flights"
[0m13:24:11.277522 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m13:24:11.277754 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

  create view "postgres"."dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed"."flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS FLIGHT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS FLIGHT_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_AIRCRAFT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_ARRIVAL_AIRPORT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    FLIGHT_PK,
    FLIGHT_HASHDIFF,
    LINK_FLIGHT_AIRCRAFT_PK,
    LINK_FLIGHT_ARRIVAL_AIRPORT_PK,
    LINK_FLIGHT_DEPARTURE_AIRPORT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.298457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m13:24:11.300755 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m13:24:11.300983 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
alter table "postgres"."dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m13:24:11.302335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.303159 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m13:24:11.303419 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m13:24:11.303578 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: COMMIT
[0m13:24:11.306231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:11.308294 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_flights__dbt_backup"
[0m13:24:11.308733 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m13:24:11.308915 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_flights__dbt_backup" cascade
[0m13:24:11.310994 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:24:11.311884 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: Close
[0m13:24:11.312401 [info ] [Thread-1 (]: 13 of 36 OK created sql view model dwh_detailed.stg_flights .................... [[32mCREATE VIEW[0m in 0.08s]
[0m13:24:11.312768 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_flights
[0m13:24:11.313002 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_seats
[0m13:24:11.313288 [info ] [Thread-1 (]: 14 of 36 START sql view model dwh_detailed.stg_seats ........................... [RUN]
[0m13:24:11.313996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_flights, now model.dbtvault.stg_seats)
[0m13:24:11.314461 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_seats
[0m13:24:11.319018 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m13:24:11.319235 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: BEGIN
[0m13:24:11.319396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.322864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m13:24:11.323089 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m13:24:11.323309 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.334731 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m13:24:11.337992 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m13:24:11.338236 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.344358 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m13:24:11.349247 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_seats"
[0m13:24:11.349614 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_seats
[0m13:24:11.351865 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_seats"
[0m13:24:11.352193 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m13:24:11.352431 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

  create view "postgres"."dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed"."seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS SEAT_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_SEAT_AIRCRAFT_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')), 'hex') AS SEAT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    SEAT_PK,
    LINK_SEAT_AIRCRAFT_PK,
    SEAT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.358092 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:24:11.360299 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m13:24:11.360546 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
alter table "postgres"."dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m13:24:11.361583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.362345 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m13:24:11.362534 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m13:24:11.362715 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: COMMIT
[0m13:24:11.365374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:11.366955 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_seats__dbt_backup"
[0m13:24:11.367367 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m13:24:11.367563 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */
drop view if exists "postgres"."dwh_detailed"."stg_seats__dbt_backup" cascade
[0m13:24:11.368830 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:11.369648 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: Close
[0m13:24:11.370191 [info ] [Thread-1 (]: 14 of 36 OK created sql view model dwh_detailed.stg_seats ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m13:24:11.370536 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_seats
[0m13:24:11.370757 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_ticket_flights
[0m13:24:11.371070 [info ] [Thread-1 (]: 15 of 36 START sql view model dwh_detailed.stg_ticket_flights .................. [RUN]
[0m13:24:11.371622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_seats, now model.dbtvault.stg_ticket_flights)
[0m13:24:11.372024 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_ticket_flights
[0m13:24:11.376995 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m13:24:11.377258 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: BEGIN
[0m13:24:11.377558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.381462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.381787 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m13:24:11.381963 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.393373 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m13:24:11.396818 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m13:24:11.397051 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.403491 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m13:24:11.407251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_ticket_flights"
[0m13:24:11.407626 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_ticket_flights
[0m13:24:11.410048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_ticket_flights"
[0m13:24:11.410360 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m13:24:11.410566 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed"."ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKET_FLIGHTS_HASHDIFF,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    TICKET_FLIGHTS_HASHDIFF,
    LINK_TICKET_FLIGHTS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.416480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:11.419133 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m13:24:11.419382 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m13:24:11.420515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.421359 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m13:24:11.421585 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m13:24:11.421747 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: COMMIT
[0m13:24:11.425383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.427356 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m13:24:11.427781 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m13:24:11.427985 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m13:24:11.429434 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:11.430325 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: Close
[0m13:24:11.430868 [info ] [Thread-1 (]: 15 of 36 OK created sql view model dwh_detailed.stg_ticket_flights ............. [[32mCREATE VIEW[0m in 0.06s]
[0m13:24:11.431329 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_ticket_flights
[0m13:24:11.431560 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_tickets
[0m13:24:11.431840 [info ] [Thread-1 (]: 16 of 36 START sql view model dwh_detailed.stg_tickets ......................... [RUN]
[0m13:24:11.432369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_ticket_flights, now model.dbtvault.stg_tickets)
[0m13:24:11.432591 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_tickets
[0m13:24:11.437160 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m13:24:11.437469 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: BEGIN
[0m13:24:11.437640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.441578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.441864 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m13:24:11.442031 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.453547 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m13:24:11.457389 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m13:24:11.457642 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m13:24:11.464175 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m13:24:11.468723 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_tickets"
[0m13:24:11.469100 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_tickets
[0m13:24:11.471477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.stg_tickets"
[0m13:24:11.471792 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m13:24:11.472025 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

  create view "postgres"."dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed"."tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS TICKET_PK,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_TICKET_BOOKING_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS TICKETHASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    TICKET_PK,
    LINK_TICKET_BOOKING_PK,
    TICKETHASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       ('1992-01-01')::DATE AS LOAD_DATE,
       ('1992-01-01')::DATE AS EFFECTIVE_FROM
FROM staging
  );
[0m13:24:11.477936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:24:11.480241 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m13:24:11.480471 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
alter table "postgres"."dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m13:24:11.481622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:11.482590 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m13:24:11.482801 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m13:24:11.483075 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: COMMIT
[0m13:24:11.485641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:11.487563 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed"."stg_tickets__dbt_backup"
[0m13:24:11.487958 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m13:24:11.488148 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m13:24:11.489375 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:24:11.490163 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: Close
[0m13:24:11.490695 [info ] [Thread-1 (]: 16 of 36 OK created sql view model dwh_detailed.stg_tickets .................... [[32mCREATE VIEW[0m in 0.06s]
[0m13:24:11.491022 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_tickets
[0m13:24:11.491248 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_aircraft
[0m13:24:11.491505 [info ] [Thread-1 (]: 17 of 36 START sql incremental model dwh_detailed.hub_aircraft ................. [RUN]
[0m13:24:11.491822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_tickets, now model.dbtvault.hub_aircraft)
[0m13:24:11.492098 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_aircraft
[0m13:24:11.539876 [info ] [Thread-1 (]: 13:24:11 + Loading postgres.dwh_detailed.hub_aircraft from 1 source(s)
[0m13:24:11.570228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_aircraft"
[0m13:24:11.570676 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_aircraft
[0m13:24:11.592246 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_aircraft"
[0m13:24:11.592764 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m13:24:11.592966 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: BEGIN
[0m13:24:11.593251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.597202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.597511 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m13:24:11.597706 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRCRAFT_PK) rr.AIRCRAFT_PK, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.AIRCRAFT_PK IS NOT NULL
    ORDER BY rr.AIRCRAFT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRCRAFT_PK, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.616502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m13:24:11.619844 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m13:24:11.620132 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_aircraft"
[0m13:24:11.620300 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: COMMIT
[0m13:24:11.622961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:11.623542 [debug] [Thread-1 (]: On model.dbtvault.hub_aircraft: Close
[0m13:24:11.624145 [info ] [Thread-1 (]: 17 of 36 OK created sql incremental model dwh_detailed.hub_aircraft ............ [[32mSELECT 1[0m in 0.13s]
[0m13:24:11.624495 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_aircraft
[0m13:24:11.624856 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_aircraft_data
[0m13:24:11.625198 [info ] [Thread-1 (]: 18 of 36 START sql incremental model dwh_detailed.sat_aircraft_data ............ [RUN]
[0m13:24:11.625814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_aircraft, now model.dbtvault.sat_aircraft_data)
[0m13:24:11.626134 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_aircraft_data
[0m13:24:11.649495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_aircraft_data"
[0m13:24:11.649954 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_aircraft_data
[0m13:24:11.652635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_aircraft_data"
[0m13:24:11.652996 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m13:24:11.653214 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: BEGIN
[0m13:24:11.653381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.657382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.657673 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m13:24:11.657854 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_aircraft_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_aircraft_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRCRAFT_PK, a.AIRCRAFT_HASHDIFF, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_aircrafts" AS a
    WHERE a.AIRCRAFT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRCRAFT_PK, stage.AIRCRAFT_HASHDIFF, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.685078 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m13:24:11.686293 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m13:24:11.686541 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_aircraft_data"
[0m13:24:11.686735 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: COMMIT
[0m13:24:11.689694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.690268 [debug] [Thread-1 (]: On model.dbtvault.sat_aircraft_data: Close
[0m13:24:11.690819 [info ] [Thread-1 (]: 18 of 36 OK created sql incremental model dwh_detailed.sat_aircraft_data ....... [[32mSELECT 1[0m in 0.06s]
[0m13:24:11.691178 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_aircraft_data
[0m13:24:11.691390 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_airport
[0m13:24:11.691643 [info ] [Thread-1 (]: 19 of 36 START sql incremental model dwh_detailed.hub_airport .................. [RUN]
[0m13:24:11.691931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_aircraft_data, now model.dbtvault.hub_airport)
[0m13:24:11.692153 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_airport
[0m13:24:11.695915 [info ] [Thread-1 (]: 13:24:11 + Loading postgres.dwh_detailed.hub_airport from 1 source(s)
[0m13:24:11.697869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_airport"
[0m13:24:11.698193 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_airport
[0m13:24:11.700784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_airport"
[0m13:24:11.701128 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m13:24:11.701311 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: BEGIN
[0m13:24:11.701458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.705380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.705623 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m13:24:11.705845 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_PK) rr.AIRPORT_PK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS rr
    WHERE rr.AIRPORT_PK IS NOT NULL
    ORDER BY rr.AIRPORT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_PK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.725105 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.019 seconds
[0m13:24:11.726225 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m13:24:11.726477 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_airport"
[0m13:24:11.726640 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: COMMIT
[0m13:24:11.729503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.730112 [debug] [Thread-1 (]: On model.dbtvault.hub_airport: Close
[0m13:24:11.730657 [info ] [Thread-1 (]: 19 of 36 OK created sql incremental model dwh_detailed.hub_airport ............. [[32mSELECT 2[0m in 0.04s]
[0m13:24:11.732262 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_airport
[0m13:24:11.732681 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_airports_data
[0m13:24:11.733019 [info ] [Thread-1 (]: 20 of 36 START sql incremental model dwh_detailed.sat_airports_data ............ [RUN]
[0m13:24:11.733478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_airport, now model.dbtvault.sat_airports_data)
[0m13:24:11.733686 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_airports_data
[0m13:24:11.739916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_airports_data"
[0m13:24:11.740303 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_airports_data
[0m13:24:11.743588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_airports_data"
[0m13:24:11.743974 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m13:24:11.744195 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: BEGIN
[0m13:24:11.744362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.749148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:24:11.749447 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m13:24:11.749630 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_airports_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_airports_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.AIRPORT_PK, a.AIRPORT_HASHDIFF, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_airports" AS a
    WHERE a.AIRPORT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.AIRPORT_PK, stage.AIRPORT_HASHDIFF, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.777842 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.028 seconds
[0m13:24:11.779011 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m13:24:11.779247 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_airports_data"
[0m13:24:11.779416 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: COMMIT
[0m13:24:11.782151 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.782679 [debug] [Thread-1 (]: On model.dbtvault.sat_airports_data: Close
[0m13:24:11.783204 [info ] [Thread-1 (]: 20 of 36 OK created sql incremental model dwh_detailed.sat_airports_data ....... [[32mSELECT 2[0m in 0.05s]
[0m13:24:11.783536 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_airports_data
[0m13:24:11.783775 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m13:24:11.784039 [info ] [Thread-1 (]: 21 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [RUN]
[0m13:24:11.784307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_airports_data, now model.dbtvault.sat_ticket_flights_boarding_passes)
[0m13:24:11.784490 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_boarding_passes
[0m13:24:11.790257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m13:24:11.790713 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_boarding_passes
[0m13:24:11.793361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m13:24:11.793743 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m13:24:11.793931 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: BEGIN
[0m13:24:11.794086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.798198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.798474 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m13:24:11.798659 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_flights_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_FLIGHTS_PK, a.BOARDING_PASSES_HASHDIFF, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.TICKET_FLIGHTS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_FLIGHTS_PK, stage.BOARDING_PASSES_HASHDIFF, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.826046 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m13:24:11.827204 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m13:24:11.827456 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m13:24:11.827620 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: COMMIT
[0m13:24:11.830393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.830937 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_boarding_passes: Close
[0m13:24:11.831496 [info ] [Thread-1 (]: 21 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_boarding_passes  [[32mSELECT 1[0m in 0.05s]
[0m13:24:11.831813 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m13:24:11.832038 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_booking
[0m13:24:11.832302 [info ] [Thread-1 (]: 22 of 36 START sql incremental model dwh_detailed.hub_booking .................. [RUN]
[0m13:24:11.832569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_boarding_passes, now model.dbtvault.hub_booking)
[0m13:24:11.832762 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_booking
[0m13:24:11.836548 [info ] [Thread-1 (]: 13:24:11 + Loading postgres.dwh_detailed.hub_booking from 1 source(s)
[0m13:24:11.838617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_booking"
[0m13:24:11.838984 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_booking
[0m13:24:11.841738 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_booking"
[0m13:24:11.842061 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m13:24:11.842237 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: BEGIN
[0m13:24:11.842391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.846538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.846794 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m13:24:11.846979 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_booking"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_booking"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.BOOK_PK) rr.BOOK_PK, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS rr
    WHERE rr.BOOK_PK IS NOT NULL
    ORDER BY rr.BOOK_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.BOOK_PK, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.864343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m13:24:11.865457 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m13:24:11.865710 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_booking"
[0m13:24:11.865881 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: COMMIT
[0m13:24:11.868908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.869591 [debug] [Thread-1 (]: On model.dbtvault.hub_booking: Close
[0m13:24:11.870179 [info ] [Thread-1 (]: 22 of 36 OK created sql incremental model dwh_detailed.hub_booking ............. [[32mSELECT 1[0m in 0.04s]
[0m13:24:11.870523 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_booking
[0m13:24:11.870736 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_booking_data
[0m13:24:11.871055 [info ] [Thread-1 (]: 23 of 36 START sql incremental model dwh_detailed.sat_booking_data ............. [RUN]
[0m13:24:11.871406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_booking, now model.dbtvault.sat_booking_data)
[0m13:24:11.872237 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_booking_data
[0m13:24:11.878070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_booking_data"
[0m13:24:11.878428 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_booking_data
[0m13:24:11.881653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_booking_data"
[0m13:24:11.881979 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m13:24:11.882160 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: BEGIN
[0m13:24:11.882422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.886390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.886637 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m13:24:11.886830 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_booking_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_booking_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.BOOK_PK, a.BOOK_HASHDIFF, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_bookings" AS a
    WHERE a.BOOK_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.BOOK_PK, stage.BOOK_HASHDIFF, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.913276 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m13:24:11.914470 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m13:24:11.914733 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_booking_data"
[0m13:24:11.914899 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: COMMIT
[0m13:24:11.917531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:11.918086 [debug] [Thread-1 (]: On model.dbtvault.sat_booking_data: Close
[0m13:24:11.918610 [info ] [Thread-1 (]: 23 of 36 OK created sql incremental model dwh_detailed.sat_booking_data ........ [[32mSELECT 1[0m in 0.05s]
[0m13:24:11.920388 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_booking_data
[0m13:24:11.921097 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_flight
[0m13:24:11.921616 [info ] [Thread-1 (]: 24 of 36 START sql incremental model dwh_detailed.hub_flight ................... [RUN]
[0m13:24:11.921932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_booking_data, now model.dbtvault.hub_flight)
[0m13:24:11.922127 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_flight
[0m13:24:11.925430 [info ] [Thread-1 (]: 13:24:11 + Loading postgres.dwh_detailed.hub_flight from 1 source(s)
[0m13:24:11.927215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_flight"
[0m13:24:11.927550 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_flight
[0m13:24:11.930316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_flight"
[0m13:24:11.930682 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m13:24:11.930883 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: BEGIN
[0m13:24:11.931037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.935549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.935873 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m13:24:11.936061 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_flight"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_flight"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.FLIGHT_PK) rr.FLIGHT_PK, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.FLIGHT_PK IS NOT NULL
    ORDER BY rr.FLIGHT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.FLIGHT_PK, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:11.954920 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m13:24:11.956097 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m13:24:11.956377 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_flight"
[0m13:24:11.956547 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: COMMIT
[0m13:24:11.959900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:11.960517 [debug] [Thread-1 (]: On model.dbtvault.hub_flight: Close
[0m13:24:11.961077 [info ] [Thread-1 (]: 24 of 36 OK created sql incremental model dwh_detailed.hub_flight .............. [[32mSELECT 1[0m in 0.04s]
[0m13:24:11.961691 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_flight
[0m13:24:11.962226 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_aircraft
[0m13:24:11.962838 [info ] [Thread-1 (]: 25 of 36 START sql incremental model dwh_detailed.link_flight_aircraft ......... [RUN]
[0m13:24:11.963591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_flight, now model.dbtvault.link_flight_aircraft)
[0m13:24:11.963811 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_aircraft
[0m13:24:11.968668 [info ] [Thread-1 (]: 13:24:11 + Loading postgres.dwh_detailed.link_flight_aircraft from 1 source(s)
[0m13:24:11.980475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_aircraft"
[0m13:24:11.980922 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_aircraft
[0m13:24:11.984109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_aircraft"
[0m13:24:11.984494 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m13:24:11.984681 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: BEGIN
[0m13:24:11.984844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:11.989176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:11.989530 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m13:24:11.989750 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_AIRCRAFT_PK, rr.flight_id, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_AIRCRAFT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_AIRCRAFT_PK, a.flight_id, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.022311 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m13:24:12.023474 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m13:24:12.023773 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_aircraft"
[0m13:24:12.023942 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: COMMIT
[0m13:24:12.026561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:12.027079 [debug] [Thread-1 (]: On model.dbtvault.link_flight_aircraft: Close
[0m13:24:12.027620 [info ] [Thread-1 (]: 25 of 36 OK created sql incremental model dwh_detailed.link_flight_aircraft .... [[32mSELECT 1[0m in 0.06s]
[0m13:24:12.027943 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_aircraft
[0m13:24:12.028165 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_arrival_airport
[0m13:24:12.028436 [info ] [Thread-1 (]: 26 of 36 START sql incremental model dwh_detailed.link_flight_arrival_airport .. [RUN]
[0m13:24:12.028721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_aircraft, now model.dbtvault.link_flight_arrival_airport)
[0m13:24:12.028899 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_arrival_airport
[0m13:24:12.031977 [info ] [Thread-1 (]: 13:24:12 + Loading postgres.dwh_detailed.link_flight_arrival_airport from 1 source(s)
[0m13:24:12.034214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_arrival_airport"
[0m13:24:12.034529 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_arrival_airport
[0m13:24:12.037059 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_arrival_airport"
[0m13:24:12.037372 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m13:24:12.037546 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: BEGIN
[0m13:24:12.037700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.042351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:24:12.042653 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m13:24:12.042840 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_arrival_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_arrival_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, rr.flight_id, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_ARRIVAL_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_ARRIVAL_AIRPORT_PK, a.flight_id, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.072686 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m13:24:12.073833 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m13:24:12.074081 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_arrival_airport"
[0m13:24:12.074252 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: COMMIT
[0m13:24:12.077165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.077753 [debug] [Thread-1 (]: On model.dbtvault.link_flight_arrival_airport: Close
[0m13:24:12.078311 [info ] [Thread-1 (]: 26 of 36 OK created sql incremental model dwh_detailed.link_flight_arrival_airport  [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.078658 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_arrival_airport
[0m13:24:12.078888 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flight_departure_airport
[0m13:24:12.079142 [info ] [Thread-1 (]: 27 of 36 START sql incremental model dwh_detailed.link_flight_departure_airport  [RUN]
[0m13:24:12.079398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_arrival_airport, now model.dbtvault.link_flight_departure_airport)
[0m13:24:12.079599 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flight_departure_airport
[0m13:24:12.084779 [info ] [Thread-1 (]: 13:24:12 + Loading postgres.dwh_detailed.link_flight_departure_airport from 1 source(s)
[0m13:24:12.087076 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flight_departure_airport"
[0m13:24:12.087481 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flight_departure_airport
[0m13:24:12.090213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_flight_departure_airport"
[0m13:24:12.090562 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m13:24:12.090746 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: BEGIN
[0m13:24:12.090897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.095081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.095324 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m13:24:12.095508 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_flight_departure_airport"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_flight_departure_airport"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, rr.flight_id, rr.departure_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_flights" AS rr
    WHERE rr.LINK_FLIGHT_DEPARTURE_AIRPORT_PK IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_FLIGHT_DEPARTURE_AIRPORT_PK, a.flight_id, a.departure_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.125693 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m13:24:12.126807 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m13:24:12.127052 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_flight_departure_airport"
[0m13:24:12.127231 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: COMMIT
[0m13:24:12.129848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:12.130386 [debug] [Thread-1 (]: On model.dbtvault.link_flight_departure_airport: Close
[0m13:24:12.130920 [info ] [Thread-1 (]: 27 of 36 OK created sql incremental model dwh_detailed.link_flight_departure_airport  [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.131254 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flight_departure_airport
[0m13:24:12.131480 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_flight_data
[0m13:24:12.132255 [info ] [Thread-1 (]: 28 of 36 START sql incremental model dwh_detailed.sat_flight_data .............. [RUN]
[0m13:24:12.133120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flight_departure_airport, now model.dbtvault.sat_flight_data)
[0m13:24:12.133395 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_flight_data
[0m13:24:12.140236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_flight_data"
[0m13:24:12.140643 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_flight_data
[0m13:24:12.143942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_flight_data"
[0m13:24:12.144343 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m13:24:12.144554 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: BEGIN
[0m13:24:12.144708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.148619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.148899 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m13:24:12.149083 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_flight_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_flight_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.FLIGHT_PK, a.FLIGHT_HASHDIFF, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.status, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_flights" AS a
    WHERE a.FLIGHT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.FLIGHT_PK, stage.FLIGHT_HASHDIFF, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.status, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.179575 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m13:24:12.180815 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m13:24:12.181088 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_flight_data"
[0m13:24:12.181254 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: COMMIT
[0m13:24:12.184127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.184633 [debug] [Thread-1 (]: On model.dbtvault.sat_flight_data: Close
[0m13:24:12.185170 [info ] [Thread-1 (]: 28 of 36 OK created sql incremental model dwh_detailed.sat_flight_data ......... [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.185508 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_flight_data
[0m13:24:12.185722 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_seat
[0m13:24:12.185973 [info ] [Thread-1 (]: 29 of 36 START sql incremental model dwh_detailed.hub_seat ..................... [RUN]
[0m13:24:12.186326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_flight_data, now model.dbtvault.hub_seat)
[0m13:24:12.186559 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_seat
[0m13:24:12.189705 [info ] [Thread-1 (]: 13:24:12 + Loading postgres.dwh_detailed.hub_seat from 1 source(s)
[0m13:24:12.191762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_seat"
[0m13:24:12.192071 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_seat
[0m13:24:12.194794 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_seat"
[0m13:24:12.195118 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m13:24:12.195300 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: BEGIN
[0m13:24:12.195447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.199398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.199679 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m13:24:12.199902 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_seat"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_seat"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.SEAT_PK) rr.SEAT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.SEAT_PK IS NOT NULL
    ORDER BY rr.SEAT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.SEAT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.216712 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m13:24:12.217851 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m13:24:12.218097 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_seat"
[0m13:24:12.218256 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: COMMIT
[0m13:24:12.221304 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.221885 [debug] [Thread-1 (]: On model.dbtvault.hub_seat: Close
[0m13:24:12.222423 [info ] [Thread-1 (]: 29 of 36 OK created sql incremental model dwh_detailed.hub_seat ................ [[32mSELECT 1[0m in 0.04s]
[0m13:24:12.222740 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_seat
[0m13:24:12.222966 [debug] [Thread-1 (]: Began running node model.dbtvault.link_seat_aircraft
[0m13:24:12.223564 [info ] [Thread-1 (]: 30 of 36 START sql incremental model dwh_detailed.link_seat_aircraft ........... [RUN]
[0m13:24:12.224404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_seat, now model.dbtvault.link_seat_aircraft)
[0m13:24:12.224689 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_seat_aircraft
[0m13:24:12.228337 [info ] [Thread-1 (]: 13:24:12 + Loading postgres.dwh_detailed.link_seat_aircraft from 1 source(s)
[0m13:24:12.230349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_seat_aircraft"
[0m13:24:12.230681 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_seat_aircraft
[0m13:24:12.233258 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_seat_aircraft"
[0m13:24:12.233620 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m13:24:12.233847 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: BEGIN
[0m13:24:12.234001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.237918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.238183 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m13:24:12.238368 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_seat_aircraft"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_seat_aircraft"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_SEAT_AIRCRAFT_PK, rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SEAT_AIRCRAFT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_seats" AS rr
    WHERE rr.LINK_SEAT_AIRCRAFT_PK IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SEAT_AIRCRAFT_PK, a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.263607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m13:24:12.264798 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m13:24:12.265052 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_seat_aircraft"
[0m13:24:12.265218 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: COMMIT
[0m13:24:12.268328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.268855 [debug] [Thread-1 (]: On model.dbtvault.link_seat_aircraft: Close
[0m13:24:12.269394 [info ] [Thread-1 (]: 30 of 36 OK created sql incremental model dwh_detailed.link_seat_aircraft ...... [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.269724 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_seat_aircraft
[0m13:24:12.269933 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_seat_data
[0m13:24:12.270171 [info ] [Thread-1 (]: 31 of 36 START sql incremental model dwh_detailed.sat_seat_data ................ [RUN]
[0m13:24:12.270445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_seat_aircraft, now model.dbtvault.sat_seat_data)
[0m13:24:12.270645 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_seat_data
[0m13:24:12.276754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_seat_data"
[0m13:24:12.277130 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_seat_data
[0m13:24:12.280388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_seat_data"
[0m13:24:12.280732 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m13:24:12.280911 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: BEGIN
[0m13:24:12.281060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.285381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.285713 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m13:24:12.285891 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_seat_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_seat_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.SEAT_PK, a.SEAT_HASHDIFF, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_seats" AS a
    WHERE a.SEAT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SEAT_PK, stage.SEAT_HASHDIFF, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.310874 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m13:24:12.312072 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m13:24:12.312317 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_seat_data"
[0m13:24:12.312479 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: COMMIT
[0m13:24:12.315396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.315968 [debug] [Thread-1 (]: On model.dbtvault.sat_seat_data: Close
[0m13:24:12.316493 [info ] [Thread-1 (]: 31 of 36 OK created sql incremental model dwh_detailed.sat_seat_data ........... [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.316812 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_seat_data
[0m13:24:12.317026 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_flights
[0m13:24:12.317263 [info ] [Thread-1 (]: 32 of 36 START sql incremental model dwh_detailed.link_ticket_flights .......... [RUN]
[0m13:24:12.317514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_seat_data, now model.dbtvault.link_ticket_flights)
[0m13:24:12.317796 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_flights
[0m13:24:12.320989 [info ] [Thread-1 (]: 13:24:12 + Loading postgres.dwh_detailed.link_ticket_flights from 1 source(s)
[0m13:24:12.323249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_flights"
[0m13:24:12.323591 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_flights
[0m13:24:12.326616 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_flights"
[0m13:24:12.326939 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m13:24:12.327115 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: BEGIN
[0m13:24:12.327268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.331812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.332121 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m13:24:12.332298 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_FLIGHTS_PK, rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_FLIGHTS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.LINK_TICKET_FLIGHTS_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.359705 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m13:24:12.360797 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m13:24:12.361035 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_flights"
[0m13:24:12.361215 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: COMMIT
[0m13:24:12.363878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:24:12.364412 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_flights: Close
[0m13:24:12.364941 [info ] [Thread-1 (]: 32 of 36 OK created sql incremental model dwh_detailed.link_ticket_flights ..... [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.365271 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_flights
[0m13:24:12.365494 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_data
[0m13:24:12.365730 [info ] [Thread-1 (]: 33 of 36 START sql incremental model dwh_detailed.sat_ticket_flights_data ...... [RUN]
[0m13:24:12.365988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_flights, now model.dbtvault.sat_ticket_flights_data)
[0m13:24:12.366460 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_data
[0m13:24:12.373364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_data"
[0m13:24:12.373767 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_data
[0m13:24:12.376389 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_flights_data"
[0m13:24:12.376707 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m13:24:12.376899 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: BEGIN
[0m13:24:12.377053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.380701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.380933 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m13:24:12.381122 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_flights_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_flights_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.LINK_TICKET_FLIGHTS_PK, a.TICKET_FLIGHTS_HASHDIFF, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.LINK_TICKET_FLIGHTS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_PK, stage.TICKET_FLIGHTS_HASHDIFF, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.407080 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m13:24:12.408197 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m13:24:12.408456 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_flights_data"
[0m13:24:12.408620 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: COMMIT
[0m13:24:12.411439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.412033 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_flights_data: Close
[0m13:24:12.412648 [info ] [Thread-1 (]: 33 of 36 OK created sql incremental model dwh_detailed.sat_ticket_flights_data . [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.413011 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_data
[0m13:24:12.413296 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_ticket
[0m13:24:12.413580 [info ] [Thread-1 (]: 34 of 36 START sql incremental model dwh_detailed.hub_ticket ................... [RUN]
[0m13:24:12.414328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_data, now model.dbtvault.hub_ticket)
[0m13:24:12.414729 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_ticket
[0m13:24:12.417815 [info ] [Thread-1 (]: 13:24:12 + Loading postgres.dwh_detailed.hub_ticket from 1 source(s)
[0m13:24:12.419912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_ticket"
[0m13:24:12.420237 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_ticket
[0m13:24:12.422982 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.hub_ticket"
[0m13:24:12.423331 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m13:24:12.423515 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: BEGIN
[0m13:24:12.423822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.428521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:24:12.428834 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m13:24:12.429010 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.hub_ticket"} */

      
  
    

  create  table "postgres"."dwh_detailed"."hub_ticket"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.TICKET_PK) rr.TICKET_PK, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.TICKET_PK IS NOT NULL
    ORDER BY rr.TICKET_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.TICKET_PK, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.446867 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m13:24:12.448009 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m13:24:12.448271 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.hub_ticket"
[0m13:24:12.448447 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: COMMIT
[0m13:24:12.451208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.451756 [debug] [Thread-1 (]: On model.dbtvault.hub_ticket: Close
[0m13:24:12.452302 [info ] [Thread-1 (]: 34 of 36 OK created sql incremental model dwh_detailed.hub_ticket .............. [[32mSELECT 1[0m in 0.04s]
[0m13:24:12.452652 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_ticket
[0m13:24:12.452879 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_booking
[0m13:24:12.453154 [info ] [Thread-1 (]: 35 of 36 START sql incremental model dwh_detailed.link_ticket_booking .......... [RUN]
[0m13:24:12.453863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_ticket, now model.dbtvault.link_ticket_booking)
[0m13:24:12.454205 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_booking
[0m13:24:12.457774 [info ] [Thread-1 (]: 13:24:12 + Loading postgres.dwh_detailed.link_ticket_booking from 1 source(s)
[0m13:24:12.459996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_booking"
[0m13:24:12.460376 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_booking
[0m13:24:12.463257 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.link_ticket_booking"
[0m13:24:12.463663 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m13:24:12.463845 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: BEGIN
[0m13:24:12.463997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.467844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.468097 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m13:24:12.468281 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.link_ticket_booking"} */

      
  
    

  create  table "postgres"."dwh_detailed"."link_ticket_booking"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_TICKET_BOOKING_PK, rr.ticket_no, rr.book_ref, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_TICKET_BOOKING_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed"."stg_tickets" AS rr
    WHERE rr.LINK_TICKET_BOOKING_PK IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_TICKET_BOOKING_PK, a.ticket_no, a.book_ref, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.495388 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m13:24:12.496528 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m13:24:12.496800 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.link_ticket_booking"
[0m13:24:12.496986 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: COMMIT
[0m13:24:12.499809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.500361 [debug] [Thread-1 (]: On model.dbtvault.link_ticket_booking: Close
[0m13:24:12.500908 [info ] [Thread-1 (]: 35 of 36 OK created sql incremental model dwh_detailed.link_ticket_booking ..... [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.501329 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_booking
[0m13:24:12.501539 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_data
[0m13:24:12.501841 [info ] [Thread-1 (]: 36 of 36 START sql incremental model dwh_detailed.sat_ticket_data .............. [RUN]
[0m13:24:12.502131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_booking, now model.dbtvault.sat_ticket_data)
[0m13:24:12.504213 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_data
[0m13:24:12.510807 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_data"
[0m13:24:12.511164 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_data
[0m13:24:12.514524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtvault.sat_ticket_data"
[0m13:24:12.514854 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m13:24:12.515029 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: BEGIN
[0m13:24:12.515175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:12.519040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:24:12.519306 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m13:24:12.519487 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.sat_ticket_data"} */

      
  
    

  create  table "postgres"."dwh_detailed"."sat_ticket_data"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.TICKET_PK, a.TICKETHASHDIFF, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed"."stg_tickets" AS a
    WHERE a.TICKET_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.TICKET_PK, stage.TICKETHASHDIFF, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m13:24:12.546373 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m13:24:12.547584 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: COMMIT
[0m13:24:12.547832 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.sat_ticket_data"
[0m13:24:12.548001 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: COMMIT
[0m13:24:12.550759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:24:12.551276 [debug] [Thread-1 (]: On model.dbtvault.sat_ticket_data: Close
[0m13:24:12.551840 [info ] [Thread-1 (]: 36 of 36 OK created sql incremental model dwh_detailed.sat_ticket_data ......... [[32mSELECT 1[0m in 0.05s]
[0m13:24:12.552179 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_data
[0m13:24:12.553989 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:12.554224 [debug] [MainThread]: On master: BEGIN
[0m13:24:12.554368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:12.557829 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:24:12.558066 [debug] [MainThread]: On master: COMMIT
[0m13:24:12.558219 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:12.558350 [debug] [MainThread]: On master: COMMIT
[0m13:24:12.558736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:12.558961 [debug] [MainThread]: On master: Close
[0m13:24:12.559230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:12.559381 [debug] [MainThread]: Connection 'model.dbtvault.sat_ticket_data' was properly closed.
[0m13:24:12.559663 [info ] [MainThread]: 
[0m13:24:12.559870 [info ] [MainThread]: Finished running 20 incremental models, 16 view models in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m13:24:12.562482 [debug] [MainThread]: Command end result
[0m13:24:12.584379 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m13:24:12.585478 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m13:24:12.589768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/user/dwh/dbt/target/run_results.json
[0m13:24:12.589976 [info ] [MainThread]: 
[0m13:24:12.590196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:12.590382 [info ] [MainThread]: 
[0m13:24:12.590561 [info ] [MainThread]: Done. PASS=36 WARN=0 ERROR=0 SKIP=0 TOTAL=36
[0m13:24:12.591874 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6538482, "process_in_blocks": "52608", "process_kernel_time": 0.089411, "process_mem_max_rss": "116744", "process_out_blocks": "5224", "process_user_time": 2.006787}
[0m13:24:12.592244 [debug] [MainThread]: Command `dbt run` succeeded at 13:24:12.592178 after 2.65 seconds
[0m13:24:12.592470 [debug] [MainThread]: Flushing usage events


============================== 22:17:13.996212 | 22f04c2b-d566-4dcf-beda-1055538b6fa7 ==============================
[0m22:17:13.996212 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:17:13.998950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'log_path': '/home/user/dwh/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m22:17:13.999267 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:17:14.162333 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:17:14.224517 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m22:17:14.224938 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:17:15.627487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m22:17:15.650191 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m22:17:15.651945 [info ] [MainThread]: 
[0m22:17:15.652199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:17:15.652360 [info ] [MainThread]: 
[0m22:17:15.652652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:15.656355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed'
[0m22:17:15.705418 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m22:17:15.705664 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m22:17:15.705807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:17.748193 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "greenplum_dwh" to address: Name or service not known

[0m22:17:19.778488 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m22:17:19.779001 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:17:19.779360 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m22:17:19.779592 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:17:19.779840 [debug] [ThreadPool]: On list_postgres_dwh_detailed: No close available on handle
[0m22:17:19.780729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:19.781057 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed' was properly closed.
[0m22:17:19.781357 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "greenplum_dwh" to address: Name or service not known
  
[0m22:17:19.783498 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 5.8170247, "process_in_blocks": "16424", "process_kernel_time": 0.100183, "process_mem_max_rss": "115708", "process_out_blocks": "2168", "process_user_time": 2.153941}
[0m22:17:19.783815 [debug] [MainThread]: Command `dbt docs generate` failed at 22:17:19.783750 after 5.82 seconds
[0m22:17:19.783999 [debug] [MainThread]: Flushing usage events


============================== 18:03:14.366810 | 8b94401b-b043-4118-bd55-10d2ef1601b9 ==============================
[0m18:03:14.366810 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:03:14.369911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/dwh/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/user/dwh/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'False'}
[0m18:03:14.370249 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m18:03:14.541558 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:03:14.586223 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:03:14.642430 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:03:16.187541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtvault.raw_vault.t_links
[0m18:03:16.211367 [info ] [MainThread]: Found 36 models, 8 sources, 789 macros
[0m18:03:16.213131 [info ] [MainThread]: 
[0m18:03:16.213405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:16.213575 [info ] [MainThread]: 
[0m18:03:16.213884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:03:16.217421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed'
[0m18:03:16.232765 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m18:03:16.233010 [debug] [ThreadPool]: On list_postgres_dwh_detailed: BEGIN
[0m18:03:16.233157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:16.237830 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:03:16.238118 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed"
[0m18:03:16.238288 [debug] [ThreadPool]: On list_postgres_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed'
  
[0m18:03:16.243286 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.005 seconds
[0m18:03:16.244345 [debug] [ThreadPool]: On list_postgres_dwh_detailed: ROLLBACK
[0m18:03:16.244935 [debug] [ThreadPool]: On list_postgres_dwh_detailed: Close
[0m18:03:16.251358 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:16.251562 [debug] [MainThread]: On master: BEGIN
[0m18:03:16.251705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:16.255528 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.255728 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:16.255914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:03:16.263418 [debug] [MainThread]: SQL status: SELECT 62 in 0.007 seconds
[0m18:03:16.265017 [debug] [MainThread]: On master: ROLLBACK
[0m18:03:16.265539 [debug] [MainThread]: On master: Close
[0m18:03:16.267450 [debug] [Thread-1 (]: Began running node model.dbtvault.aircrafts
[0m18:03:16.267742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed, now model.dbtvault.aircrafts)
[0m18:03:16.268003 [debug] [Thread-1 (]: Began compiling node model.dbtvault.aircrafts
[0m18:03:16.272857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.aircrafts"
[0m18:03:16.273428 [debug] [Thread-1 (]: Began executing node model.dbtvault.aircrafts
[0m18:03:16.273901 [debug] [Thread-1 (]: Finished running node model.dbtvault.aircrafts
[0m18:03:16.274122 [debug] [Thread-1 (]: Began running node model.dbtvault.airports
[0m18:03:16.274474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.aircrafts, now model.dbtvault.airports)
[0m18:03:16.274713 [debug] [Thread-1 (]: Began compiling node model.dbtvault.airports
[0m18:03:16.276542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.airports"
[0m18:03:16.276964 [debug] [Thread-1 (]: Began executing node model.dbtvault.airports
[0m18:03:16.277325 [debug] [Thread-1 (]: Finished running node model.dbtvault.airports
[0m18:03:16.277544 [debug] [Thread-1 (]: Began running node model.dbtvault.boarding_passes
[0m18:03:16.277769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.airports, now model.dbtvault.boarding_passes)
[0m18:03:16.277991 [debug] [Thread-1 (]: Began compiling node model.dbtvault.boarding_passes
[0m18:03:16.279733 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.boarding_passes"
[0m18:03:16.280218 [debug] [Thread-1 (]: Began executing node model.dbtvault.boarding_passes
[0m18:03:16.280582 [debug] [Thread-1 (]: Finished running node model.dbtvault.boarding_passes
[0m18:03:16.280788 [debug] [Thread-1 (]: Began running node model.dbtvault.bookings
[0m18:03:16.281039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.boarding_passes, now model.dbtvault.bookings)
[0m18:03:16.281262 [debug] [Thread-1 (]: Began compiling node model.dbtvault.bookings
[0m18:03:16.283363 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.bookings"
[0m18:03:16.283753 [debug] [Thread-1 (]: Began executing node model.dbtvault.bookings
[0m18:03:16.284168 [debug] [Thread-1 (]: Finished running node model.dbtvault.bookings
[0m18:03:16.284378 [debug] [Thread-1 (]: Began running node model.dbtvault.flights
[0m18:03:16.284622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.bookings, now model.dbtvault.flights)
[0m18:03:16.284837 [debug] [Thread-1 (]: Began compiling node model.dbtvault.flights
[0m18:03:16.286521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.flights"
[0m18:03:16.286988 [debug] [Thread-1 (]: Began executing node model.dbtvault.flights
[0m18:03:16.287361 [debug] [Thread-1 (]: Finished running node model.dbtvault.flights
[0m18:03:16.287576 [debug] [Thread-1 (]: Began running node model.dbtvault.seats
[0m18:03:16.287834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.flights, now model.dbtvault.seats)
[0m18:03:16.288057 [debug] [Thread-1 (]: Began compiling node model.dbtvault.seats
[0m18:03:16.289687 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.seats"
[0m18:03:16.290040 [debug] [Thread-1 (]: Began executing node model.dbtvault.seats
[0m18:03:16.290589 [debug] [Thread-1 (]: Finished running node model.dbtvault.seats
[0m18:03:16.290815 [debug] [Thread-1 (]: Began running node model.dbtvault.ticket_flights
[0m18:03:16.291047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.seats, now model.dbtvault.ticket_flights)
[0m18:03:16.291303 [debug] [Thread-1 (]: Began compiling node model.dbtvault.ticket_flights
[0m18:03:16.293005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.ticket_flights"
[0m18:03:16.293461 [debug] [Thread-1 (]: Began executing node model.dbtvault.ticket_flights
[0m18:03:16.293850 [debug] [Thread-1 (]: Finished running node model.dbtvault.ticket_flights
[0m18:03:16.294055 [debug] [Thread-1 (]: Began running node model.dbtvault.tickets
[0m18:03:16.294339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.ticket_flights, now model.dbtvault.tickets)
[0m18:03:16.294550 [debug] [Thread-1 (]: Began compiling node model.dbtvault.tickets
[0m18:03:16.296756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.tickets"
[0m18:03:16.297330 [debug] [Thread-1 (]: Began executing node model.dbtvault.tickets
[0m18:03:16.297725 [debug] [Thread-1 (]: Finished running node model.dbtvault.tickets
[0m18:03:16.297925 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_aircrafts
[0m18:03:16.298148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.tickets, now model.dbtvault.stg_aircrafts)
[0m18:03:16.298343 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_aircrafts
[0m18:03:16.309082 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m18:03:16.309596 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: BEGIN
[0m18:03:16.309876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.314198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.314449 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m18:03:16.314629 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.325869 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m18:03:16.330517 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_aircrafts"
[0m18:03:16.330758 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'aircrafts'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.336814 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m18:03:16.339866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_aircrafts"
[0m18:03:16.340347 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_aircrafts
[0m18:03:16.340589 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: ROLLBACK
[0m18:03:16.341141 [debug] [Thread-1 (]: On model.dbtvault.stg_aircrafts: Close
[0m18:03:16.341620 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_aircrafts
[0m18:03:16.341849 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_airports
[0m18:03:16.342196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_aircrafts, now model.dbtvault.stg_airports)
[0m18:03:16.342555 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_airports
[0m18:03:16.347625 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m18:03:16.347870 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: BEGIN
[0m18:03:16.348133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.352070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.352309 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m18:03:16.352481 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.363781 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.011 seconds
[0m18:03:16.367223 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_airports"
[0m18:03:16.367456 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'airports'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.373655 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:03:16.377780 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_airports"
[0m18:03:16.378152 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_airports
[0m18:03:16.378362 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: ROLLBACK
[0m18:03:16.379348 [debug] [Thread-1 (]: On model.dbtvault.stg_airports: Close
[0m18:03:16.379846 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_airports
[0m18:03:16.380076 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_boarding_passes
[0m18:03:16.380304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_airports, now model.dbtvault.stg_boarding_passes)
[0m18:03:16.380786 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_boarding_passes
[0m18:03:16.385912 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m18:03:16.386170 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: BEGIN
[0m18:03:16.386343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.390409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.390648 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m18:03:16.390827 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.402246 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m18:03:16.405779 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_boarding_passes"
[0m18:03:16.406027 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'boarding_passes'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.412381 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m18:03:16.416129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_boarding_passes"
[0m18:03:16.416526 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_boarding_passes
[0m18:03:16.416765 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: ROLLBACK
[0m18:03:16.417370 [debug] [Thread-1 (]: On model.dbtvault.stg_boarding_passes: Close
[0m18:03:16.417969 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_boarding_passes
[0m18:03:16.418214 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_bookings
[0m18:03:16.418618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_boarding_passes, now model.dbtvault.stg_bookings)
[0m18:03:16.418972 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_bookings
[0m18:03:16.424108 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m18:03:16.424339 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: BEGIN
[0m18:03:16.424510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.428362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.428591 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m18:03:16.428763 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.439964 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m18:03:16.443315 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_bookings"
[0m18:03:16.443567 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'bookings'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.449898 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m18:03:16.452997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_bookings"
[0m18:03:16.453316 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_bookings
[0m18:03:16.453520 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: ROLLBACK
[0m18:03:16.454061 [debug] [Thread-1 (]: On model.dbtvault.stg_bookings: Close
[0m18:03:16.454518 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_bookings
[0m18:03:16.454744 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_flights
[0m18:03:16.454992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_bookings, now model.dbtvault.stg_flights)
[0m18:03:16.455191 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_flights
[0m18:03:16.460346 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m18:03:16.460713 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: BEGIN
[0m18:03:16.460925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.464863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.465088 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m18:03:16.465257 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.476554 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m18:03:16.480284 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_flights"
[0m18:03:16.480515 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.486733 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:03:16.495935 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_flights"
[0m18:03:16.496262 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_flights
[0m18:03:16.496469 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: ROLLBACK
[0m18:03:16.497082 [debug] [Thread-1 (]: On model.dbtvault.stg_flights: Close
[0m18:03:16.497618 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_flights
[0m18:03:16.497883 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_seats
[0m18:03:16.498409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_flights, now model.dbtvault.stg_seats)
[0m18:03:16.498623 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_seats
[0m18:03:16.503197 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m18:03:16.503468 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: BEGIN
[0m18:03:16.503646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.507522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.507789 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m18:03:16.508008 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.519131 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.011 seconds
[0m18:03:16.522488 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_seats"
[0m18:03:16.522722 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'seats'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.528986 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m18:03:16.534275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_seats"
[0m18:03:16.534692 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_seats
[0m18:03:16.534908 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: ROLLBACK
[0m18:03:16.535492 [debug] [Thread-1 (]: On model.dbtvault.stg_seats: Close
[0m18:03:16.535984 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_seats
[0m18:03:16.536206 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_ticket_flights
[0m18:03:16.536559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_seats, now model.dbtvault.stg_ticket_flights)
[0m18:03:16.536952 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_ticket_flights
[0m18:03:16.541468 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m18:03:16.541691 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: BEGIN
[0m18:03:16.541856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.545525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.545759 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m18:03:16.545938 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.557224 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m18:03:16.560769 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_ticket_flights"
[0m18:03:16.560995 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'ticket_flights'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.567267 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m18:03:16.572199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_ticket_flights"
[0m18:03:16.572510 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_ticket_flights
[0m18:03:16.572708 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: ROLLBACK
[0m18:03:16.573354 [debug] [Thread-1 (]: On model.dbtvault.stg_ticket_flights: Close
[0m18:03:16.573816 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_ticket_flights
[0m18:03:16.574052 [debug] [Thread-1 (]: Began running node model.dbtvault.stg_tickets
[0m18:03:16.574299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_ticket_flights, now model.dbtvault.stg_tickets)
[0m18:03:16.574695 [debug] [Thread-1 (]: Began compiling node model.dbtvault.stg_tickets
[0m18:03:16.579336 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m18:03:16.579706 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: BEGIN
[0m18:03:16.579907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:16.584132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m18:03:16.584384 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m18:03:16.584569 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.595940 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m18:03:16.599423 [debug] [Thread-1 (]: Using postgres connection "model.dbtvault.stg_tickets"
[0m18:03:16.599654 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "node_id": "model.dbtvault.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'tickets'
        
        and table_schema = 'dwh_detailed'
        
      order by ordinal_position

  
[0m18:03:16.605871 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m18:03:16.610370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.stg_tickets"
[0m18:03:16.610690 [debug] [Thread-1 (]: Began executing node model.dbtvault.stg_tickets
[0m18:03:16.610896 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: ROLLBACK
[0m18:03:16.611551 [debug] [Thread-1 (]: On model.dbtvault.stg_tickets: Close
[0m18:03:16.612088 [debug] [Thread-1 (]: Finished running node model.dbtvault.stg_tickets
[0m18:03:16.612336 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_aircrafts
[0m18:03:16.612564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.stg_tickets, now model.dbtvault.hub_aircrafts)
[0m18:03:16.612770 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_aircrafts
[0m18:03:16.620527 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.hub_aircrafts from 1 source(s)
[0m18:03:16.623975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_aircrafts"
[0m18:03:16.624430 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_aircrafts
[0m18:03:16.624836 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_aircrafts
[0m18:03:16.625052 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_aircrafts_detail
[0m18:03:16.625334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_aircrafts, now model.dbtvault.sat_aircrafts_detail)
[0m18:03:16.625514 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_aircrafts_detail
[0m18:03:16.632275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_aircrafts_detail"
[0m18:03:16.632746 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_aircrafts_detail
[0m18:03:16.633135 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_aircrafts_detail
[0m18:03:16.633359 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_airports
[0m18:03:16.633640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_aircrafts_detail, now model.dbtvault.hub_airports)
[0m18:03:16.633818 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_airports
[0m18:03:16.636879 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.hub_airports from 1 source(s)
[0m18:03:16.673983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_airports"
[0m18:03:16.674400 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_airports
[0m18:03:16.674791 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_airports
[0m18:03:16.675021 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_airports_detail
[0m18:03:16.675256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_airports, now model.dbtvault.sat_airports_detail)
[0m18:03:16.675509 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_airports_detail
[0m18:03:16.682796 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_airports_detail"
[0m18:03:16.683152 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_airports_detail
[0m18:03:16.683532 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_airports_detail
[0m18:03:16.683751 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m18:03:16.684009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_airports_detail, now model.dbtvault.sat_ticket_flights_boarding_passes)
[0m18:03:16.684183 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_boarding_passes
[0m18:03:16.691083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_boarding_passes"
[0m18:03:16.691360 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_boarding_passes
[0m18:03:16.691701 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_boarding_passes
[0m18:03:16.691930 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_bookings
[0m18:03:16.692172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_boarding_passes, now model.dbtvault.hub_bookings)
[0m18:03:16.692499 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_bookings
[0m18:03:16.695097 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.hub_bookings from 1 source(s)
[0m18:03:16.697277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_bookings"
[0m18:03:16.697548 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_bookings
[0m18:03:16.697961 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_bookings
[0m18:03:16.698178 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_bookings_detail
[0m18:03:16.698428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_bookings, now model.dbtvault.sat_bookings_detail)
[0m18:03:16.698626 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_bookings_detail
[0m18:03:16.705190 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_bookings_detail"
[0m18:03:16.705476 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_bookings_detail
[0m18:03:16.705856 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_bookings_detail
[0m18:03:16.706066 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_flights
[0m18:03:16.706296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_bookings_detail, now model.dbtvault.hub_flights)
[0m18:03:16.706611 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_flights
[0m18:03:16.709599 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.hub_flights from 1 source(s)
[0m18:03:16.711805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_flights"
[0m18:03:16.712071 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_flights
[0m18:03:16.712438 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_flights
[0m18:03:16.712646 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flights_aircrafts
[0m18:03:16.712872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_flights, now model.dbtvault.link_flights_aircrafts)
[0m18:03:16.713056 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flights_aircrafts
[0m18:03:16.715838 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.link_flights_aircrafts from 1 source(s)
[0m18:03:16.718343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flights_aircrafts"
[0m18:03:16.718722 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flights_aircrafts
[0m18:03:16.719117 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flights_aircrafts
[0m18:03:16.719326 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flights_arrival_airport
[0m18:03:16.719557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flights_aircrafts, now model.dbtvault.link_flights_arrival_airport)
[0m18:03:16.719774 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flights_arrival_airport
[0m18:03:16.722478 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.link_flights_arrival_airport from 1 source(s)
[0m18:03:16.724985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flights_arrival_airport"
[0m18:03:16.725283 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flights_arrival_airport
[0m18:03:16.725648 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flights_arrival_airport
[0m18:03:16.725864 [debug] [Thread-1 (]: Began running node model.dbtvault.link_flights_departure_airport
[0m18:03:16.726140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flights_arrival_airport, now model.dbtvault.link_flights_departure_airport)
[0m18:03:16.726335 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_flights_departure_airport
[0m18:03:16.729398 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.link_flights_departure_airport from 1 source(s)
[0m18:03:16.731719 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_flights_departure_airport"
[0m18:03:16.732013 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_flights_departure_airport
[0m18:03:16.732359 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_flights_departure_airport
[0m18:03:16.732564 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_flights_detail
[0m18:03:16.732796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_flights_departure_airport, now model.dbtvault.sat_flights_detail)
[0m18:03:16.733000 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_flights_detail
[0m18:03:16.740484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_flights_detail"
[0m18:03:16.740822 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_flights_detail
[0m18:03:16.741190 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_flights_detail
[0m18:03:16.741400 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_seats
[0m18:03:16.741702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_flights_detail, now model.dbtvault.hub_seats)
[0m18:03:16.741876 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_seats
[0m18:03:16.744518 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.hub_seats from 1 source(s)
[0m18:03:16.746869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_seats"
[0m18:03:16.747178 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_seats
[0m18:03:16.747536 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_seats
[0m18:03:16.747776 [debug] [Thread-1 (]: Began running node model.dbtvault.link_seats_aircrafts
[0m18:03:16.748194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_seats, now model.dbtvault.link_seats_aircrafts)
[0m18:03:16.748437 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_seats_aircrafts
[0m18:03:16.751519 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.link_seats_aircrafts from 1 source(s)
[0m18:03:16.753885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_seats_aircrafts"
[0m18:03:16.754218 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_seats_aircrafts
[0m18:03:16.754608 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_seats_aircrafts
[0m18:03:16.754830 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_seats_detail
[0m18:03:16.755055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_seats_aircrafts, now model.dbtvault.sat_seats_detail)
[0m18:03:16.755262 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_seats_detail
[0m18:03:16.761784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_seats_detail"
[0m18:03:16.762109 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_seats_detail
[0m18:03:16.762464 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_seats_detail
[0m18:03:16.762674 [debug] [Thread-1 (]: Began running node model.dbtvault.link_ticket_flights
[0m18:03:16.762903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_seats_detail, now model.dbtvault.link_ticket_flights)
[0m18:03:16.763145 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_ticket_flights
[0m18:03:16.765787 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.link_ticket_flights from 1 source(s)
[0m18:03:16.768626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_ticket_flights"
[0m18:03:16.768946 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_ticket_flights
[0m18:03:16.769307 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_ticket_flights
[0m18:03:16.769525 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_ticket_flights_detail
[0m18:03:16.769779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_ticket_flights, now model.dbtvault.sat_ticket_flights_detail)
[0m18:03:16.769986 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_ticket_flights_detail
[0m18:03:16.776685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_ticket_flights_detail"
[0m18:03:16.777038 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_ticket_flights_detail
[0m18:03:16.777417 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_ticket_flights_detail
[0m18:03:16.777633 [debug] [Thread-1 (]: Began running node model.dbtvault.hub_tickets
[0m18:03:16.777863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.sat_ticket_flights_detail, now model.dbtvault.hub_tickets)
[0m18:03:16.778089 [debug] [Thread-1 (]: Began compiling node model.dbtvault.hub_tickets
[0m18:03:16.780635 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.hub_tickets from 1 source(s)
[0m18:03:16.782947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.hub_tickets"
[0m18:03:16.783246 [debug] [Thread-1 (]: Began executing node model.dbtvault.hub_tickets
[0m18:03:16.783627 [debug] [Thread-1 (]: Finished running node model.dbtvault.hub_tickets
[0m18:03:16.783844 [debug] [Thread-1 (]: Began running node model.dbtvault.link_tickets_bookings
[0m18:03:16.784264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.hub_tickets, now model.dbtvault.link_tickets_bookings)
[0m18:03:16.784496 [debug] [Thread-1 (]: Began compiling node model.dbtvault.link_tickets_bookings
[0m18:03:16.787649 [info ] [Thread-1 (]: 18:03:16 + Loading postgres.dwh_detailed.link_tickets_bookings from 1 source(s)
[0m18:03:16.789951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.link_tickets_bookings"
[0m18:03:16.790253 [debug] [Thread-1 (]: Began executing node model.dbtvault.link_tickets_bookings
[0m18:03:16.790606 [debug] [Thread-1 (]: Finished running node model.dbtvault.link_tickets_bookings
[0m18:03:16.790819 [debug] [Thread-1 (]: Began running node model.dbtvault.sat_tickets_detail
[0m18:03:16.791051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtvault.link_tickets_bookings, now model.dbtvault.sat_tickets_detail)
[0m18:03:16.791450 [debug] [Thread-1 (]: Began compiling node model.dbtvault.sat_tickets_detail
[0m18:03:16.798601 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtvault.sat_tickets_detail"
[0m18:03:16.799014 [debug] [Thread-1 (]: Began executing node model.dbtvault.sat_tickets_detail
[0m18:03:16.799411 [debug] [Thread-1 (]: Finished running node model.dbtvault.sat_tickets_detail
[0m18:03:16.800112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:16.800294 [debug] [MainThread]: Connection 'model.dbtvault.sat_tickets_detail' was properly closed.
[0m18:03:16.802675 [debug] [MainThread]: Command end result
[0m18:03:16.855862 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m18:03:16.858949 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m18:03:16.863656 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/user/dwh/dbt/target/run_results.json
[0m18:03:16.867807 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:03:16.868020 [info ] [MainThread]: Building catalog
[0m18:03:16.872412 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m18:03:16.877050 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m18:03:16.877275 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m18:03:16.877423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:16.882358 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:03:16.882605 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m18:03:16.882892 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "dbtvault", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_ticket_flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_ticket_flights_detail')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('aircrafts')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('hub_seats')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('link_flights_departure_airport')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('bookings')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('hub_bookings')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_seats')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_aircrafts')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('link_flights_aircrafts')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('hub_aircrafts')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('hub_tickets')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_ticket_flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('ticket_flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_bookings')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_aircrafts')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('hub_airports')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('airports')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('seats')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_flights_detail')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_aircrafts_detail')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('hub_flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('link_ticket_flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('tickets')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_ticket_flights_boarding_passes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_flights')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('link_flights_arrival_airport')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_boarding_passes')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_boarding_passes')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_seats_detail')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('link_seats_aircrafts')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_tickets')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('boarding_passes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_airports')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_tickets_detail')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_seats')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_tickets')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_airports_detail')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('postgres_public_bookings')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('sat_bookings_detail')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('link_tickets_bookings')) or (upper(sch.nspname) = upper('dwh_detailed') and
           upper(tbl.relname) = upper('stg_airports')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:03:16.893720 [debug] [ThreadPool]: SQL status: SELECT 197 in 0.010 seconds
[0m18:03:16.899775 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m18:03:16.900409 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m18:03:16.912019 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/user/dwh/dbt/target/catalog.json
[0m18:03:16.933710 [debug] [MainThread]: Wrote artifact WritableManifest to /home/user/dwh/dbt/target/manifest.json
[0m18:03:16.934721 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/user/dwh/dbt/target/semantic_manifest.json
[0m18:03:16.934928 [info ] [MainThread]: Catalog written to /home/user/dwh/dbt/target/catalog.json
[0m18:03:16.936994 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.6031294, "process_in_blocks": "89520", "process_kernel_time": 0.08384, "process_mem_max_rss": "122220", "process_out_blocks": "10304", "process_user_time": 2.766748}
[0m18:03:16.937297 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:03:16.937234 after 2.60 seconds
[0m18:03:16.937486 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:03:16.937625 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m18:03:16.937764 [debug] [MainThread]: Flushing usage events
