{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2025-01-19T15:03:16.800418Z", "invocation_id": "8b94401b-b043-4118-bd55-10d2ef1601b9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.268135Z", "completed_at": "2025-01-19T15:03:16.273346Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.273648Z", "completed_at": "2025-01-19T15:03:16.273658Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006115436553955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.aircrafts", "compiled": true, "compiled_code": "SELECT aircraft_code, model::jsonb as model, range\nFROM \"postgres\".\"public\".\"postgres_public_aircrafts\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"aircrafts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.274853Z", "completed_at": "2025-01-19T15:03:16.276890Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.277094Z", "completed_at": "2025-01-19T15:03:16.277100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002803802490234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.airports", "compiled": true, "compiled_code": "SELECT * FROM \"postgres\".\"public\".\"postgres_public_airports\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"airports\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.278126Z", "completed_at": "2025-01-19T15:03:16.280141Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.280355Z", "completed_at": "2025-01-19T15:03:16.280361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002746105194091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.boarding_passes", "compiled": true, "compiled_code": "SELECT * FROM \"postgres\".\"public\".\"postgres_public_boarding_passes\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"boarding_passes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.281405Z", "completed_at": "2025-01-19T15:03:16.283668Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.283907Z", "completed_at": "2025-01-19T15:03:16.283913Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030565261840820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.bookings", "compiled": true, "compiled_code": "SELECT * FROM \"postgres\".\"public\".\"postgres_public_bookings\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"bookings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.284970Z", "completed_at": "2025-01-19T15:03:16.286917Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.287125Z", "completed_at": "2025-01-19T15:03:16.287130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002660036087036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.flights", "compiled": true, "compiled_code": "SELECT * FROM \"postgres\".\"public\".\"postgres_public_flights\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"flights\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.288184Z", "completed_at": "2025-01-19T15:03:16.289968Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.290267Z", "completed_at": "2025-01-19T15:03:16.290274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026466846466064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.seats", "compiled": true, "compiled_code": "SELECT * FROM \"postgres\".\"public\".\"postgres_public_seats\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"seats\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.291442Z", "completed_at": "2025-01-19T15:03:16.293381Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.293604Z", "completed_at": "2025-01-19T15:03:16.293609Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027222633361816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.ticket_flights", "compiled": true, "compiled_code": "SELECT * FROM \"postgres\".\"public\".\"postgres_public_ticket_flights\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"ticket_flights\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.294682Z", "completed_at": "2025-01-19T15:03:16.297238Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.297474Z", "completed_at": "2025-01-19T15:03:16.297479Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003302335739135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.tickets", "compiled": true, "compiled_code": "SELECT ticket_no, book_ref, passenger_id, passenger_name, contact_data::jsonb as contact_data\nFROM \"postgres\".\"public\".\"postgres_public_tickets\"", "relation_name": "\"postgres\".\"dwh_detailed\".\"tickets\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.298470Z", "completed_at": "2025-01-19T15:03:16.340248Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.340509Z", "completed_at": "2025-01-19T15:03:16.340519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04337716102600098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_aircrafts", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    aircraft_code,\n    model,\n    range\n\n    FROM \"postgres\".\"dwh_detailed\".\"aircrafts\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    aircraft_code,\n    model,\n    range,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    aircraft_code,\n    model,\n    range,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS HUB_AIRCRAFTS_KEY,\n\n    DECODE(MD5(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')\n    )), 'hex') AS HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    aircraft_code,\n    model,\n    range,\n    RECORD_SOURCE,\n    HUB_AIRCRAFTS_KEY,\n    HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_aircrafts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.342703Z", "completed_at": "2025-01-19T15:03:16.378072Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.378284Z", "completed_at": "2025-01-19T15:03:16.378293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03756380081176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_airports", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    airport_code,\n    airport_name,\n    city,\n    coordinates_lon,\n    coordinates_lat,\n    timezone\n\n    FROM \"postgres\".\"dwh_detailed\".\"airports\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    airport_code,\n    airport_name,\n    city,\n    coordinates_lon,\n    coordinates_lat,\n    timezone,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    airport_code,\n    airport_name,\n    city,\n    coordinates_lon,\n    coordinates_lat,\n    timezone,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS HUB_AIRPORTS_KEY,\n\n    DECODE(MD5(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')\n    )), 'hex') AS HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    airport_code,\n    airport_name,\n    city,\n    coordinates_lon,\n    coordinates_lat,\n    timezone,\n    RECORD_SOURCE,\n    HUB_AIRPORTS_KEY,\n    HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_airports\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.381005Z", "completed_at": "2025-01-19T15:03:16.416424Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.416675Z", "completed_at": "2025-01-19T15:03:16.416690Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03753495216369629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_boarding_passes", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    boarding_no,\n    seat_no\n\n    FROM \"postgres\".\"dwh_detailed\".\"boarding_passes\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    boarding_no,\n    seat_no,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    boarding_no,\n    seat_no,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_KEY,\n\n    DECODE(MD5(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')\n    )), 'hex') AS HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    boarding_no,\n    seat_no,\n    RECORD_SOURCE,\n    LINK_TICKET_FLIGHTS_KEY,\n    HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_boarding_passes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.419105Z", "completed_at": "2025-01-19T15:03:16.453239Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.453443Z", "completed_at": "2025-01-19T15:03:16.453453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03585028648376465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_bookings", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    book_ref,\n    book_date,\n    total_amount\n\n    FROM \"postgres\".\"dwh_detailed\".\"bookings\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    book_ref,\n    book_date,\n    total_amount,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    book_ref,\n    book_date,\n    total_amount,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS HUB_BOOKINGS_KEY,\n\n    DECODE(MD5(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')\n    )), 'hex') AS HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    book_ref,\n    book_date,\n    total_amount,\n    RECORD_SOURCE,\n    HUB_BOOKINGS_KEY,\n    HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_bookings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.455313Z", "completed_at": "2025-01-19T15:03:16.496186Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.496395Z", "completed_at": "2025-01-19T15:03:16.496403Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04252886772155762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_flights", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    flight_id,\n    flight_no,\n    scheduled_departure,\n    scheduled_arrival,\n    departure_airport,\n    arrival_airport,\n    status,\n    aircraft_code,\n    actual_departure,\n    actual_arrival\n\n    FROM \"postgres\".\"dwh_detailed\".\"flights\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    flight_id,\n    flight_no,\n    scheduled_departure,\n    scheduled_arrival,\n    departure_airport,\n    arrival_airport,\n    status,\n    aircraft_code,\n    actual_departure,\n    actual_arrival,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    flight_id,\n    flight_no,\n    scheduled_departure,\n    scheduled_arrival,\n    departure_airport,\n    arrival_airport,\n    status,\n    aircraft_code,\n    actual_departure,\n    actual_arrival,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS HUB_FLIGHTS_KEY,\n\n    DECODE(MD5(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')\n    )), 'hex') AS HASHDIFF,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), '')), 'hex') AS ARRIVAL_AIRPORT_KEY,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), '')), 'hex') AS DEPARTURE_AIRPORT_KEY,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS HUB_AIRCRAFTS_KEY,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS LINK_FLIGHTS_AIRCRAFTS_KEY,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    flight_id,\n    flight_no,\n    scheduled_departure,\n    scheduled_arrival,\n    departure_airport,\n    arrival_airport,\n    status,\n    aircraft_code,\n    actual_departure,\n    actual_arrival,\n    RECORD_SOURCE,\n    HUB_FLIGHTS_KEY,\n    HASHDIFF,\n    ARRIVAL_AIRPORT_KEY,\n    DEPARTURE_AIRPORT_KEY,\n    HUB_AIRCRAFTS_KEY,\n    LINK_FLIGHTS_AIRCRAFTS_KEY,\n    LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY,\n    LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_flights\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.498765Z", "completed_at": "2025-01-19T15:03:16.534607Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.534829Z", "completed_at": "2025-01-19T15:03:16.534838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037500858306884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_seats", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    aircraft_code,\n    seat_no,\n    fare_conditions\n\n    FROM \"postgres\".\"dwh_detailed\".\"seats\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    aircraft_code,\n    seat_no,\n    fare_conditions,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    aircraft_code,\n    seat_no,\n    fare_conditions,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS HUB_SEATS_KEY,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS LINK_SEATS_AIRCRAFTS_KEY,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS HUB_AIRCRAFTS_KEY,\n\n    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')), 'hex') AS HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    aircraft_code,\n    seat_no,\n    fare_conditions,\n    RECORD_SOURCE,\n    HUB_SEATS_KEY,\n    LINK_SEATS_AIRCRAFTS_KEY,\n    HUB_AIRCRAFTS_KEY,\n    HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_seats\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.537088Z", "completed_at": "2025-01-19T15:03:16.572435Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.572635Z", "completed_at": "2025-01-19T15:03:16.572644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03718137741088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_ticket_flights", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    fare_conditions,\n    amount\n\n    FROM \"postgres\".\"dwh_detailed\".\"ticket_flights\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    fare_conditions,\n    amount,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    fare_conditions,\n    amount,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS HUB_TICKETS_KEY,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS HUB_FLIGHTS_KEY,\n\n    DECODE(MD5(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^')\n    )), 'hex') AS HASHDIFF,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS LINK_TICKET_FLIGHTS_KEY\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    ticket_no,\n    flight_id,\n    fare_conditions,\n    amount,\n    RECORD_SOURCE,\n    HUB_TICKETS_KEY,\n    HUB_FLIGHTS_KEY,\n    HASHDIFF,\n    LINK_TICKET_FLIGHTS_KEY\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_ticket_flights\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.574840Z", "completed_at": "2025-01-19T15:03:16.610615Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.610820Z", "completed_at": "2025-01-19T15:03:16.610829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03770303726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.stg_tickets", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\nWITH staging AS (\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    ticket_no,\n    book_ref,\n    passenger_id,\n    passenger_name,\n    contact_data\n\n    FROM \"postgres\".\"dwh_detailed\".\"tickets\"\n),\n\nderived_columns AS (\n\n    SELECT\n\n    ticket_no,\n    book_ref,\n    passenger_id,\n    passenger_name,\n    contact_data,\n    'POSTGRES_MASTER'::TEXT AS RECORD_SOURCE\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    ticket_no,\n    book_ref,\n    passenger_id,\n    passenger_name,\n    contact_data,\n    RECORD_SOURCE,\n\n    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS HUB_TICKETS_KEY,\n\n    DECODE(MD5(NULLIF(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^')\n    ), '^^||^^')), 'hex') AS LINK_TICKETS_BOOKINGS_KEY,\n\n    DECODE(MD5(CONCAT(\n        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',\n        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^')\n    )), 'hex') AS HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    ticket_no,\n    book_ref,\n    passenger_id,\n    passenger_name,\n    contact_data,\n    RECORD_SOURCE,\n    HUB_TICKETS_KEY,\n    LINK_TICKETS_BOOKINGS_KEY,\n    HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select\n)\n\nSELECT *, \n       ('1992-01-01')::TIMESTAMP AS LOAD_DTS,\n       ('1992-01-01')::TIMESTAMP AS EFFECTIVE_FROM\nFROM staging", "relation_name": "\"postgres\".\"dwh_detailed\".\"stg_tickets\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.613056Z", "completed_at": "2025-01-19T15:03:16.624350Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.624575Z", "completed_at": "2025-01-19T15:03:16.624582Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012204170227050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.hub_aircrafts", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT DISTINCT ON (rr.HUB_AIRCRAFTS_KEY) rr.HUB_AIRCRAFTS_KEY, rr.aircraft_code, rr.LOAD_DTS, rr.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_aircrafts\" AS rr\n    WHERE rr.HUB_AIRCRAFTS_KEY IS NOT NULL\n    ORDER BY rr.HUB_AIRCRAFTS_KEY, rr.LOAD_DTS\n),\n\nrecords_to_insert AS (\n    SELECT a.HUB_AIRCRAFTS_KEY, a.aircraft_code, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"hub_aircrafts\" AS d\n    ON a.HUB_AIRCRAFTS_KEY = d.HUB_AIRCRAFTS_KEY\n    WHERE d.HUB_AIRCRAFTS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"hub_aircrafts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.625619Z", "completed_at": "2025-01-19T15:03:16.632661Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.632895Z", "completed_at": "2025-01-19T15:03:16.632903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007735252380371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_aircrafts_detail", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.HUB_AIRCRAFTS_KEY, a.HASHDIFF, a.model, a.range, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_aircrafts\" AS a\n    WHERE a.HUB_AIRCRAFTS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.HUB_AIRCRAFTS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.HUB_AIRCRAFTS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.HUB_AIRCRAFTS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_aircrafts_detail\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.HUB_AIRCRAFTS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.HUB_AIRCRAFTS_KEY = source_records.HUB_AIRCRAFTS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.HUB_AIRCRAFTS_KEY, stage.HASHDIFF, stage.model, stage.range, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.HUB_AIRCRAFTS_KEY = stage.HUB_AIRCRAFTS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_aircrafts_detail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.633922Z", "completed_at": "2025-01-19T15:03:16.674320Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.674543Z", "completed_at": "2025-01-19T15:03:16.674550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.041089534759521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.hub_airports", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT DISTINCT ON (rr.HUB_AIRPORTS_KEY) rr.HUB_AIRPORTS_KEY, rr.airport_code, rr.LOAD_DTS, rr.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_airports\" AS rr\n    WHERE rr.HUB_AIRPORTS_KEY IS NOT NULL\n    ORDER BY rr.HUB_AIRPORTS_KEY, rr.LOAD_DTS\n),\n\nrecords_to_insert AS (\n    SELECT a.HUB_AIRPORTS_KEY, a.airport_code, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"hub_airports\" AS d\n    ON a.HUB_AIRPORTS_KEY = d.HUB_AIRPORTS_KEY\n    WHERE d.HUB_AIRPORTS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"hub_airports\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.675616Z", "completed_at": "2025-01-19T15:03:16.683084Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.683276Z", "completed_at": "2025-01-19T15:03:16.683282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008208036422729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_airports_detail", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.HUB_AIRPORTS_KEY, a.HASHDIFF, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_airports\" AS a\n    WHERE a.HUB_AIRPORTS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.HUB_AIRPORTS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.HUB_AIRPORTS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.HUB_AIRPORTS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_airports_detail\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.HUB_AIRPORTS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.HUB_AIRPORTS_KEY = source_records.HUB_AIRPORTS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.HUB_AIRPORTS_KEY, stage.HASHDIFF, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.HUB_AIRPORTS_KEY = stage.HUB_AIRPORTS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_airports_detail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.684290Z", "completed_at": "2025-01-19T15:03:16.691292Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.691487Z", "completed_at": "2025-01-19T15:03:16.691492Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007638692855834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_ticket_flights_boarding_passes", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.LINK_TICKET_FLIGHTS_KEY, a.HASHDIFF, a.boarding_no, a.seat_no, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_boarding_passes\" AS a\n    WHERE a.LINK_TICKET_FLIGHTS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.LINK_TICKET_FLIGHTS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.LINK_TICKET_FLIGHTS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.LINK_TICKET_FLIGHTS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_ticket_flights_boarding_passes\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.LINK_TICKET_FLIGHTS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.LINK_TICKET_FLIGHTS_KEY = source_records.LINK_TICKET_FLIGHTS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_KEY, stage.HASHDIFF, stage.boarding_no, stage.seat_no, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.LINK_TICKET_FLIGHTS_KEY = stage.LINK_TICKET_FLIGHTS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_ticket_flights_boarding_passes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.692666Z", "completed_at": "2025-01-19T15:03:16.697482Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.697698Z", "completed_at": "2025-01-19T15:03:16.697704Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00568389892578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.hub_bookings", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT DISTINCT ON (rr.HUB_BOOKINGS_KEY) rr.HUB_BOOKINGS_KEY, rr.book_ref, rr.LOAD_DTS, rr.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_bookings\" AS rr\n    WHERE rr.HUB_BOOKINGS_KEY IS NOT NULL\n    ORDER BY rr.HUB_BOOKINGS_KEY, rr.LOAD_DTS\n),\n\nrecords_to_insert AS (\n    SELECT a.HUB_BOOKINGS_KEY, a.book_ref, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"hub_bookings\" AS d\n    ON a.HUB_BOOKINGS_KEY = d.HUB_BOOKINGS_KEY\n    WHERE d.HUB_BOOKINGS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"hub_bookings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.698761Z", "completed_at": "2025-01-19T15:03:16.705404Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.705600Z", "completed_at": "2025-01-19T15:03:16.705606Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007332801818847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_bookings_detail", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.HUB_BOOKINGS_KEY, a.HASHDIFF, a.book_date, a.total_amount, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_bookings\" AS a\n    WHERE a.HUB_BOOKINGS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.HUB_BOOKINGS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.HUB_BOOKINGS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.HUB_BOOKINGS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_bookings_detail\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.HUB_BOOKINGS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.HUB_BOOKINGS_KEY = source_records.HUB_BOOKINGS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.HUB_BOOKINGS_KEY, stage.HASHDIFF, stage.book_date, stage.total_amount, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.HUB_BOOKINGS_KEY = stage.HUB_BOOKINGS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_bookings_detail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.706736Z", "completed_at": "2025-01-19T15:03:16.712008Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.712196Z", "completed_at": "2025-01-19T15:03:16.712201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006074428558349609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.hub_flights", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT DISTINCT ON (rr.HUB_FLIGHTS_KEY) rr.HUB_FLIGHTS_KEY, rr.flight_id, rr.LOAD_DTS, rr.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_flights\" AS rr\n    WHERE rr.HUB_FLIGHTS_KEY IS NOT NULL\n    ORDER BY rr.HUB_FLIGHTS_KEY, rr.LOAD_DTS\n),\n\nrecords_to_insert AS (\n    SELECT a.HUB_FLIGHTS_KEY, a.flight_id, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"hub_flights\" AS d\n    ON a.HUB_FLIGHTS_KEY = d.HUB_FLIGHTS_KEY\n    WHERE d.HUB_FLIGHTS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"hub_flights\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.713190Z", "completed_at": "2025-01-19T15:03:16.718649Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.718886Z", "completed_at": "2025-01-19T15:03:16.718893Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0061724185943603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.link_flights_aircrafts", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n  SELECT * FROM (\n    SELECT rr.LINK_FLIGHTS_AIRCRAFTS_KEY, rr.HUB_FLIGHTS_KEY, rr.HUB_AIRCRAFTS_KEY, rr.LOAD_DTS, rr.RECORD_SOURCE,\n           ROW_NUMBER() OVER(\n               PARTITION BY rr.LINK_FLIGHTS_AIRCRAFTS_KEY\n               ORDER BY rr.LOAD_DTS\n           ) AS row_number\n    FROM \"postgres\".\"dwh_detailed\".\"stg_flights\" AS rr\n    WHERE rr.LINK_FLIGHTS_AIRCRAFTS_KEY IS NOT NULL\n    AND rr.HUB_FLIGHTS_KEY IS NOT NULL\n    AND rr.HUB_AIRCRAFTS_KEY IS NOT NULL\n  ) as l\n  WHERE row_number = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_FLIGHTS_AIRCRAFTS_KEY, a.HUB_FLIGHTS_KEY, a.HUB_AIRCRAFTS_KEY, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"link_flights_aircrafts\" AS d\n    ON a.LINK_FLIGHTS_AIRCRAFTS_KEY = d.LINK_FLIGHTS_AIRCRAFTS_KEY\n    WHERE d.LINK_FLIGHTS_AIRCRAFTS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"link_flights_aircrafts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.719950Z", "completed_at": "2025-01-19T15:03:16.725198Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.725418Z", "completed_at": "2025-01-19T15:03:16.725424Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006025791168212891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.link_flights_arrival_airport", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n  SELECT * FROM (\n    SELECT rr.LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY, rr.HUB_FLIGHTS_KEY, rr.ARRIVAL_AIRPORT_KEY, rr.LOAD_DTS, rr.RECORD_SOURCE,\n           ROW_NUMBER() OVER(\n               PARTITION BY rr.LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY\n               ORDER BY rr.LOAD_DTS\n           ) AS row_number\n    FROM \"postgres\".\"dwh_detailed\".\"stg_flights\" AS rr\n    WHERE rr.LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY IS NOT NULL\n    AND rr.HUB_FLIGHTS_KEY IS NOT NULL\n    AND rr.ARRIVAL_AIRPORT_KEY IS NOT NULL\n  ) as l\n  WHERE row_number = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY, a.HUB_FLIGHTS_KEY, a.ARRIVAL_AIRPORT_KEY, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"link_flights_arrival_airport\" AS d\n    ON a.LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY = d.LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY\n    WHERE d.LINK_FLIGHTS_ARRIVAL_AIRPORT_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"link_flights_arrival_airport\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.726449Z", "completed_at": "2025-01-19T15:03:16.731945Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.732137Z", "completed_at": "2025-01-19T15:03:16.732143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0061571598052978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.link_flights_departure_airport", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n  SELECT * FROM (\n    SELECT rr.LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY, rr.HUB_FLIGHTS_KEY, rr.DEPARTURE_AIRPORT_KEY, rr.LOAD_DTS, rr.RECORD_SOURCE,\n           ROW_NUMBER() OVER(\n               PARTITION BY rr.LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY\n               ORDER BY rr.LOAD_DTS\n           ) AS row_number\n    FROM \"postgres\".\"dwh_detailed\".\"stg_flights\" AS rr\n    WHERE rr.LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY IS NOT NULL\n    AND rr.HUB_FLIGHTS_KEY IS NOT NULL\n    AND rr.DEPARTURE_AIRPORT_KEY IS NOT NULL\n  ) as l\n  WHERE row_number = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY, a.HUB_FLIGHTS_KEY, a.DEPARTURE_AIRPORT_KEY, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"link_flights_departure_airport\" AS d\n    ON a.LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY = d.LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY\n    WHERE d.LINK_FLIGHTS_DEPARTURE_AIRPORT_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"link_flights_departure_airport\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.733135Z", "completed_at": "2025-01-19T15:03:16.740747Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.740953Z", "completed_at": "2025-01-19T15:03:16.740959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008333206176757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_flights_detail", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.HUB_FLIGHTS_KEY, a.HASHDIFF, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.status, a.actual_departure, a.actual_arrival, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_flights\" AS a\n    WHERE a.HUB_FLIGHTS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.HUB_FLIGHTS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.HUB_FLIGHTS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.HUB_FLIGHTS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_flights_detail\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.HUB_FLIGHTS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.HUB_FLIGHTS_KEY = source_records.HUB_FLIGHTS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.HUB_FLIGHTS_KEY, stage.HASHDIFF, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.status, stage.actual_departure, stage.actual_arrival, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.HUB_FLIGHTS_KEY = stage.HUB_FLIGHTS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_flights_detail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.741980Z", "completed_at": "2025-01-19T15:03:16.747107Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.747306Z", "completed_at": "2025-01-19T15:03:16.747311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00577092170715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.hub_seats", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT DISTINCT ON (rr.HUB_SEATS_KEY) rr.HUB_SEATS_KEY, rr.aircraft_code, rr.seat_no, rr.LOAD_DTS, rr.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_seats\" AS rr\n    WHERE rr.HUB_SEATS_KEY IS NOT NULL\n    ORDER BY rr.HUB_SEATS_KEY, rr.LOAD_DTS\n),\n\nrecords_to_insert AS (\n    SELECT a.HUB_SEATS_KEY, a.aircraft_code, a.seat_no, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"hub_seats\" AS d\n    ON a.HUB_SEATS_KEY = d.HUB_SEATS_KEY\n    WHERE d.HUB_SEATS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"hub_seats\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.748561Z", "completed_at": "2025-01-19T15:03:16.754145Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.754351Z", "completed_at": "2025-01-19T15:03:16.754356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006373405456542969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.link_seats_aircrafts", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n  SELECT * FROM (\n    SELECT rr.LINK_SEATS_AIRCRAFTS_KEY, rr.HUB_AIRCRAFTS_KEY, rr.HUB_SEATS_KEY, rr.LOAD_DTS, rr.RECORD_SOURCE,\n           ROW_NUMBER() OVER(\n               PARTITION BY rr.LINK_SEATS_AIRCRAFTS_KEY\n               ORDER BY rr.LOAD_DTS\n           ) AS row_number\n    FROM \"postgres\".\"dwh_detailed\".\"stg_seats\" AS rr\n    WHERE rr.LINK_SEATS_AIRCRAFTS_KEY IS NOT NULL\n    AND rr.HUB_AIRCRAFTS_KEY IS NOT NULL\n    AND rr.HUB_SEATS_KEY IS NOT NULL\n  ) as l\n  WHERE row_number = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_SEATS_AIRCRAFTS_KEY, a.HUB_AIRCRAFTS_KEY, a.HUB_SEATS_KEY, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"link_seats_aircrafts\" AS d\n    ON a.LINK_SEATS_AIRCRAFTS_KEY = d.LINK_SEATS_AIRCRAFTS_KEY\n    WHERE d.LINK_SEATS_AIRCRAFTS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"link_seats_aircrafts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.755394Z", "completed_at": "2025-01-19T15:03:16.762037Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.762238Z", "completed_at": "2025-01-19T15:03:16.762244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007356166839599609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_seats_detail", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.HUB_SEATS_KEY, a.HASHDIFF, a.fare_conditions, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_seats\" AS a\n    WHERE a.HUB_SEATS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.HUB_SEATS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.HUB_SEATS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.HUB_SEATS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_seats_detail\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.HUB_SEATS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.HUB_SEATS_KEY = source_records.HUB_SEATS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.HUB_SEATS_KEY, stage.HASHDIFF, stage.fare_conditions, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.HUB_SEATS_KEY = stage.HUB_SEATS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_seats_detail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.763257Z", "completed_at": "2025-01-19T15:03:16.768874Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.769079Z", "completed_at": "2025-01-19T15:03:16.769084Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006337165832519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.link_ticket_flights", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n  SELECT * FROM (\n    SELECT rr.LINK_TICKET_FLIGHTS_KEY, rr.HUB_TICKETS_KEY, rr.HUB_FLIGHTS_KEY, rr.LOAD_DTS, rr.RECORD_SOURCE,\n           ROW_NUMBER() OVER(\n               PARTITION BY rr.LINK_TICKET_FLIGHTS_KEY\n               ORDER BY rr.LOAD_DTS\n           ) AS row_number\n    FROM \"postgres\".\"dwh_detailed\".\"stg_ticket_flights\" AS rr\n    WHERE rr.LINK_TICKET_FLIGHTS_KEY IS NOT NULL\n    AND rr.HUB_TICKETS_KEY IS NOT NULL\n    AND rr.HUB_FLIGHTS_KEY IS NOT NULL\n  ) as l\n  WHERE row_number = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_TICKET_FLIGHTS_KEY, a.HUB_TICKETS_KEY, a.HUB_FLIGHTS_KEY, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"link_ticket_flights\" AS d\n    ON a.LINK_TICKET_FLIGHTS_KEY = d.LINK_TICKET_FLIGHTS_KEY\n    WHERE d.LINK_TICKET_FLIGHTS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"link_ticket_flights\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.770119Z", "completed_at": "2025-01-19T15:03:16.776961Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.777189Z", "completed_at": "2025-01-19T15:03:16.777195Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007570981979370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_ticket_flights_detail", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.LINK_TICKET_FLIGHTS_KEY, a.HASHDIFF, a.fare_conditions, a.amount, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_ticket_flights\" AS a\n    WHERE a.LINK_TICKET_FLIGHTS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.LINK_TICKET_FLIGHTS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.LINK_TICKET_FLIGHTS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.LINK_TICKET_FLIGHTS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_ticket_flights_detail\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.LINK_TICKET_FLIGHTS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.LINK_TICKET_FLIGHTS_KEY = source_records.LINK_TICKET_FLIGHTS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.LINK_TICKET_FLIGHTS_KEY, stage.HASHDIFF, stage.fare_conditions, stage.amount, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.LINK_TICKET_FLIGHTS_KEY = stage.LINK_TICKET_FLIGHTS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_ticket_flights_detail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.778214Z", "completed_at": "2025-01-19T15:03:16.783169Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.783374Z", "completed_at": "2025-01-19T15:03:16.783380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005676746368408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.hub_tickets", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT DISTINCT ON (rr.HUB_TICKETS_KEY) rr.HUB_TICKETS_KEY, rr.ticket_no, rr.LOAD_DTS, rr.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_tickets\" AS rr\n    WHERE rr.HUB_TICKETS_KEY IS NOT NULL\n    ORDER BY rr.HUB_TICKETS_KEY, rr.LOAD_DTS\n),\n\nrecords_to_insert AS (\n    SELECT a.HUB_TICKETS_KEY, a.ticket_no, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"hub_tickets\" AS d\n    ON a.HUB_TICKETS_KEY = d.HUB_TICKETS_KEY\n    WHERE d.HUB_TICKETS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"hub_tickets\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.784618Z", "completed_at": "2025-01-19T15:03:16.790186Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.790380Z", "completed_at": "2025-01-19T15:03:16.790387Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006312847137451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.link_tickets_bookings", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n  SELECT * FROM (\n    SELECT rr.LINK_TICKETS_BOOKINGS_KEY, rr.ticket_no, rr.book_ref, rr.LOAD_DTS, rr.RECORD_SOURCE,\n           ROW_NUMBER() OVER(\n               PARTITION BY rr.LINK_TICKETS_BOOKINGS_KEY\n               ORDER BY rr.LOAD_DTS\n           ) AS row_number\n    FROM \"postgres\".\"dwh_detailed\".\"stg_tickets\" AS rr\n    WHERE rr.LINK_TICKETS_BOOKINGS_KEY IS NOT NULL\n    AND rr.ticket_no IS NOT NULL\n    AND rr.book_ref IS NOT NULL\n  ) as l\n  WHERE row_number = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_TICKETS_BOOKINGS_KEY, a.ticket_no, a.book_ref, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN \"postgres\".\"dwh_detailed\".\"link_tickets_bookings\" AS d\n    ON a.LINK_TICKETS_BOOKINGS_KEY = d.LINK_TICKETS_BOOKINGS_KEY\n    WHERE d.LINK_TICKETS_BOOKINGS_KEY IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"link_tickets_bookings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-19T15:03:16.791701Z", "completed_at": "2025-01-19T15:03:16.798930Z"}, {"name": "execute", "started_at": "2025-01-19T15:03:16.799164Z", "completed_at": "2025-01-19T15:03:16.799171Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008285999298095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtvault.sat_tickets_detail", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    WITH source_data AS (\n    SELECT a.HUB_TICKETS_KEY, a.HASHDIFF, a.passenger_id, a.passenger_name, a.contact_data, a.LOAD_DTS, a.RECORD_SOURCE\n    FROM \"postgres\".\"dwh_detailed\".\"stg_tickets\" AS a\n    WHERE a.HUB_TICKETS_KEY IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT a.HUB_TICKETS_KEY, a.HASHDIFF, a.LOAD_DTS\n    FROM (\n        SELECT current_records.HUB_TICKETS_KEY, current_records.HASHDIFF, current_records.LOAD_DTS,\n            RANK() OVER (\n                PARTITION BY current_records.HUB_TICKETS_KEY\n                ORDER BY current_records.LOAD_DTS DESC\n            ) AS rank\n        FROM \"postgres\".\"dwh_detailed\".\"sat_tickets_detail\" AS current_records\n            JOIN (\n                SELECT DISTINCT source_data.HUB_TICKETS_KEY\n                FROM source_data\n            ) AS source_records\n                ON current_records.HUB_TICKETS_KEY = source_records.HUB_TICKETS_KEY\n    ) AS a\n    WHERE a.rank = 1\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT stage.HUB_TICKETS_KEY, stage.HASHDIFF, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.LOAD_DTS, stage.RECORD_SOURCE\n    FROM source_data AS stage\n    LEFT JOIN latest_records\n    ON latest_records.HUB_TICKETS_KEY = stage.HUB_TICKETS_KEY\n        AND latest_records.HASHDIFF = stage.HASHDIFF\n    WHERE latest_records.HASHDIFF IS NULL\n\n)\n\nSELECT * FROM records_to_insert", "relation_name": "\"postgres\".\"dwh_detailed\".\"sat_tickets_detail\"", "batch_results": null}], "elapsed_time": 0.586688756942749, "args": {"static_parser": true, "print": true, "cache_selected_only": false, "defer": false, "log_path": "/home/user/dwh/dbt/logs", "macro_debugging": false, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "partial_parse": true, "state_modified_compare_vars": false, "log_format_file": "debug", "version_check": true, "strict_mode": false, "log_level": "info", "log_level_file": "debug", "quiet": false, "compile": true, "send_anonymous_usage_stats": false, "require_resource_names_without_spaces": false, "project_dir": "/home/user/dwh/dbt", "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "use_colors": true, "profiles_dir": "/home/user/dwh/dbt", "introspect": true, "invocation_command": "dbt docs generate", "require_nested_cumulative_type_params": false, "static": false, "exclude": [], "printer_width": 80, "state_modified_compare_more_unrendered_values": false, "which": "generate", "empty_catalog": false, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors_file": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "vars": {}, "select": [], "log_file_max_bytes": 10485760, "populate_cache": true}}